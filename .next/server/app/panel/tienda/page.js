(()=>{var e={};e.id=6993,e.ids=[6993],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},31988:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),s(32356),s(24198),s(12874);var t=s(27105),r=s(15265),i=s(90157),l=s.n(i),n=s(44665),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(a,o);let c=["",{children:["panel",{children:["tienda",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,32356)),"/Users/axelhernandez/Sorteos/frontend/src/app/panel/tienda/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,24198)),"/Users/axelhernandez/Sorteos/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,12874,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/axelhernandez/Sorteos/frontend/src/app/panel/tienda/page.tsx"],u="/panel/tienda/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/panel/tienda/page",pathname:"/panel/tienda",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},72493:(e,a,s)=>{Promise.resolve().then(s.bind(s,65184))},65184:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>f});var t=s(19899),r=s(5507),i=s(38442),l=s(1260),n=s(28848),o=s(26028),c=s(84499),d=s(12576),u=s(10195),p=s.n(u),m=s(84837);function h({shop:e,onUpdate:a}){let[s,i]=(0,r.useState)(!1),[l,o]=(0,r.useState)(e),[c,u]=(0,r.useState)(!1),[h,x]=(0,r.useState)(null),f=e=>{let{name:a,value:s}=e.target;o(e=>({...e,[a]:s}))},g=async s=>{s.preventDefault(),u(!0),x(null);try{let s=await n.m.updateShop(e.id,{name:l.name,description:l.description,logo:l.logo,publicEmail:l.publicEmail,phone:l.phone,socialMedia:l.socialMedia});x({type:"success",text:"Tienda actualizada correctamente"}),a(s),i(!1)}catch(e){x({type:"error",text:e.response?.data?.message||"Error al actualizar la tienda"})}finally{u(!1)}},v=()=>{switch(e.status){case d.R.PENDING:return"Tu tienda est\xe1 en revisi\xf3n. Nos pondremos en contacto pronto.";case d.R.BLOCKED:return"Tu tienda ha sido bloqueada. No puedes crear nuevos sorteos.";case d.R.VERIFIED:return"Tu tienda est\xe1 verificada y activa.";default:return""}};return(0,t.jsxs)("div",{className:p().raffleDetail,children:[(0,t.jsxs)("div",{className:p().raffleDetailHeader,children:[t.jsx("h1",{className:p().raffleDetailTitle,children:"Mi tienda"}),t.jsx(m.O,{status:e.status})]}),v()&&t.jsx("div",{className:`${p().alert} ${e.status===d.R.BLOCKED?p().alertError:p().alertInfo}`,children:v()}),h&&t.jsx("div",{className:`${p().alert} ${"success"===h.type?p().alertSuccess:p().alertError}`,children:h.text}),s?(0,t.jsxs)("form",{onSubmit:g,className:p().profileForm,children:[(0,t.jsxs)("div",{className:p().formGroup,children:[t.jsx("label",{className:p().formLabel,children:"Nombre de la tienda"}),t.jsx("input",{type:"text",name:"name",value:l.name,onChange:f,className:p().formInput,required:!0})]}),(0,t.jsxs)("div",{className:p().formGroup,children:[t.jsx("label",{className:p().formLabel,children:"Descripci\xf3n"}),t.jsx("textarea",{name:"description",value:l.description||"",onChange:f,className:p().formTextarea})]}),(0,t.jsxs)("div",{className:p().formGroup,children:[t.jsx("label",{className:p().formLabel,children:"Logo (URL)"}),t.jsx("input",{type:"url",name:"logo",value:l.logo||"",onChange:f,className:p().formInput})]}),(0,t.jsxs)("div",{className:p().formGroup,children:[t.jsx("label",{className:p().formLabel,children:"Email p\xfablico"}),t.jsx("input",{type:"email",name:"publicEmail",value:l.publicEmail||"",onChange:f,className:p().formInput})]}),(0,t.jsxs)("div",{className:p().formGroup,children:[t.jsx("label",{className:p().formLabel,children:"Tel\xe9fono"}),t.jsx("input",{type:"tel",name:"phone",value:l.phone||"",onChange:f,className:p().formInput})]}),(0,t.jsxs)("div",{className:p().formGroup,children:[t.jsx("label",{className:p().formLabel,children:"Redes sociales"}),t.jsx("input",{type:"text",name:"socialMedia",value:l.socialMedia||"",onChange:f,className:p().formInput,placeholder:"@usuario o enlace"})]}),(0,t.jsxs)("div",{className:p().buttonGroup,children:[t.jsx("button",{type:"submit",className:p().primaryButton,disabled:c,children:c?"Guardando...":"Guardar cambios"}),t.jsx("button",{type:"button",className:p().secondaryButton,onClick:()=>{i(!1),o(e)},children:"Cancelar"})]})]}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:p().raffleDetailGrid,children:[(0,t.jsxs)("div",{className:p().raffleDetailItem,children:[t.jsx("div",{className:p().raffleDetailItemLabel,children:"Nombre"}),t.jsx("div",{className:p().raffleDetailItemValue,children:e.name})]}),(0,t.jsxs)("div",{className:p().raffleDetailItem,children:[t.jsx("div",{className:p().raffleDetailItemLabel,children:"Email p\xfablico"}),t.jsx("div",{className:p().raffleDetailItemValue,children:e.publicEmail||"No especificado"})]}),(0,t.jsxs)("div",{className:p().raffleDetailItem,children:[t.jsx("div",{className:p().raffleDetailItemLabel,children:"Tel\xe9fono"}),t.jsx("div",{className:p().raffleDetailItemValue,children:e.phone||"No especificado"})]}),(0,t.jsxs)("div",{className:p().raffleDetailItem,children:[t.jsx("div",{className:p().raffleDetailItemLabel,children:"Redes sociales"}),t.jsx("div",{className:p().raffleDetailItemValue,children:e.socialMedia||"No especificado"})]})]}),e.description&&(0,t.jsxs)("div",{className:p().raffleDetailSection,children:[t.jsx("div",{className:p().raffleDetailSectionTitle,children:"Descripci\xf3n"}),t.jsx("p",{children:e.description})]}),e.status!==d.R.BLOCKED&&t.jsx("button",{className:p().primaryButton,onClick:()=>i(!0),children:"✏️ Editar informaci\xf3n"})]})]})}var x=s(2345);function f(){let{user:e,isAuthenticated:a}=(0,i.t)(),[s,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),[f,g]=(0,r.useState)(null),v=async()=>{m(!0),g(null);try{let e=await n.m.getMyShop();d(e)}catch(e){g(e.response?.data?.message||"Error al cargar la tienda")}finally{m(!1)}};return t.jsx(x.i,{requiredRole:l.i.SHOP,children:(0,t.jsxs)("div",{className:p().panelContainer,children:[t.jsx(c.G,{isBlocked:s?.status==="blocked"}),(0,t.jsxs)("main",{className:p().mainContent,children:[u&&t.jsx("div",{className:p().alert,children:"Cargando tienda..."}),f&&(0,t.jsxs)("div",{className:`${p().alert} ${p().alertError}`,children:[f,t.jsx("button",{onClick:v,className:p().primaryButton,style:{marginLeft:"10px"},children:"Reintentar"})]}),s&&(0,t.jsxs)(t.Fragment,{children:[t.jsx(o.N,{shop:s}),t.jsx(h,{shop:s,onUpdate:d})]})]})]})})}},84837:(e,a,s)=>{"use strict";s.d(a,{O:()=>l});var t=s(19899),r=s(10195),i=s.n(r);function l({status:e}){return t.jsx("span",{className:i().statusBadge,style:{backgroundColor:(e=>{switch(e){case"pending":case"pending_approval":return"#FFA500";case"verified":case"active":return"#4CAF50";case"blocked":case"rejected":case"cancelled":return"#F44336";case"draft":return"#9E9E9E";case"sold_out":return"#2196F3";case"finished":return"#673AB7";default:return"#757575"}})(e)},children:{pending:"Pendiente",pending_approval:"Pendiente de aprobaci\xf3n",verified:"Verificada",blocked:"Bloqueada",active:"Activo",draft:"Borrador",sold_out:"Agotado",finished:"Finalizado",cancelled:"Cancelado",rejected:"Rechazado"}[e]||e})}},28848:(e,a,s)=>{"use strict";s.d(a,{m:()=>d});var t=s(10752),r=s(82986),i=s(26379),l=s(12576);let n=e=>e?.toDate?e.toDate():e instanceof Date?e:"string"==typeof e?new Date(e):new Date,o=e=>{let a=e.data();return{id:e.id,userId:a.userId||"",name:a.name||"",description:a.description,logo:a.logo,publicEmail:a.publicEmail,phone:a.phone,socialMedia:a.socialMedia,status:a.status||l.R.PENDING,createdAt:n(a.createdAt),updatedAt:n(a.updatedAt)}},c={async getShopById(e){try{let a=await (0,r.getDoc)((0,r.doc)(i.db,"shops",e));if(!a.exists())throw Error("Shop not found");return o(a)}catch(e){throw console.error("Error fetching shop:",e),e}},async getVerifiedShops(){try{let e=(0,r.collection)(i.db,"shops"),a=(0,r.query)(e,(0,r.where)("status","==",l.R.VERIFIED));return(await (0,r.getDocs)(a)).docs.map(e=>o(e)).sort((e,a)=>e.name.localeCompare(a.name))}catch(e){throw console.error("Error fetching verified shops:",e),e}},async getAllShops(){try{let e=(0,r.collection)(i.db,"shops");return(await (0,r.getDocs)(e)).docs.map(e=>o(e)).sort((e,a)=>e.name.localeCompare(a.name))}catch(e){throw console.error("Error fetching all shops:",e),e}}},d={getShopById:async e=>c.getShopById(e),getAllShops:async()=>c.getAllShops(),getVerifiedShops:async()=>c.getVerifiedShops(),getMyShop:async()=>(await t.x.get("/shops/my-shop/current")).data,updateShop:async(e,a)=>(await t.x.put(`/shops/${e}`,a)).data,getShopStatistics:async e=>(await t.x.get(`/shops/${e}/statistics`)).data}},12576:(e,a,s)=>{"use strict";var t;s.d(a,{R:()=>t}),function(e){e.PENDING="pending",e.VERIFIED="verified",e.BLOCKED="blocked"}(t||(t={}))},32356:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>t});let t=(0,s(2772).createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/app/panel/tienda/page.tsx#default`)}};var a=require("../../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[3591,8559,3352,4175,9388],()=>s(31988));module.exports=t})();