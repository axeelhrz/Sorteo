(()=>{var e={};e.id=1005,e.ids=[1005],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},50374:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>l.a,__next_app__:()=>f,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>o}),s(90211),s(24198),s(12874);var t=s(27105),r=s(15265),i=s(90157),l=s.n(i),n=s(44665),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);s.d(a,c);let o=["",{children:["panel",{children:["sorteos",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,90211)),"/Users/axelhernandez/Sorteos/frontend/src/app/panel/sorteos/[id]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,24198)),"/Users/axelhernandez/Sorteos/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,12874,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/axelhernandez/Sorteos/frontend/src/app/panel/sorteos/[id]/page.tsx"],u="/panel/sorteos/[id]/page",f={require:s,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/panel/sorteos/[id]/page",pathname:"/panel/sorteos/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},20244:(e,a,s)=>{Promise.resolve().then(s.bind(s,40620))},40620:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>j});var t=s(19899),r=s(5507),i=s(38442),l=s(1260),n=s(28848),c=s(26028),o=s(84499),d=s(76153),u=s(65373),f=s(31),p=s(10195),m=s.n(p),h=s(84837);function x({raffleId:e}){let a=(0,d.useRouter)(),[s,i]=(0,r.useState)(null),[l,n]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null),[p,x]=(0,r.useState)(!1),v=async()=>{n(!0),o(null);try{let a=await f.raffleService.getRaffleById(e);i(a)}catch(e){o(e.response?.data?.message||"Error al cargar el sorteo")}finally{n(!1)}},j=async()=>{if(s){x(!0);try{let e=await f.raffleService.submitForApproval(s.id);i(e)}catch(e){alert(e.response?.data?.message||"Error al enviar para aprobaci\xf3n")}finally{x(!1)}}},N=async()=>{if(s&&confirm("\xbfEst\xe1s seguro de que deseas cancelar este sorteo?")){x(!0);try{let e=await f.raffleService.cancelRaffle(s.id);i(e)}catch(e){alert(e.response?.data?.message||"Error al cancelar el sorteo")}finally{x(!1)}}};if(l)return t.jsx("div",{className:m().alert,children:"Cargando sorteo..."});if(c)return(0,t.jsxs)("div",{className:m().alert+" "+m().alertError,children:[c,t.jsx("button",{onClick:v,className:m().primaryButton,style:{marginLeft:"10px"},children:"Reintentar"})]});if(!s)return t.jsx("div",{className:m().alert+" "+m().alertError,children:"Sorteo no encontrado"});let g=s.soldTickets/s.totalTickets*100;return(0,t.jsxs)("div",{className:m().raffleDetail,children:[(0,t.jsxs)("div",{className:m().raffleDetailHeader,children:[(0,t.jsxs)("div",{children:[t.jsx("h1",{className:m().raffleDetailTitle,children:s.product?.name||"Sorteo"}),(0,t.jsxs)("p",{style:{margin:"5px 0 0 0",color:"#7f8c8d"},children:["ID: ",s.id]})]}),t.jsx(h.O,{status:s.status})]}),(0,t.jsxs)("div",{className:m().raffleDetailSection,children:[t.jsx("div",{className:m().raffleDetailSectionTitle,children:"Informaci\xf3n del producto"}),(0,t.jsxs)("div",{className:m().raffleDetailGrid,children:[(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Nombre"}),t.jsx("div",{className:m().raffleDetailItemValue,children:s.product?.name})]}),(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Valor"}),(0,t.jsxs)("div",{className:m().raffleDetailItemValue,children:["S/. ",Number(s.productValue).toFixed(2)]})]}),(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Altura"}),(0,t.jsxs)("div",{className:m().raffleDetailItemValue,children:[Number(s.product?.height).toFixed(1)," cm"]})]}),(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Ancho"}),(0,t.jsxs)("div",{className:m().raffleDetailItemValue,children:[Number(s.product?.width).toFixed(1)," cm"]})]}),(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Profundidad"}),(0,t.jsxs)("div",{className:m().raffleDetailItemValue,children:[Number(s.product?.depth).toFixed(1)," cm"]})]}),(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Requiere dep\xf3sito"}),t.jsx("div",{className:m().raffleDetailItemValue,children:s.requiresDeposit?"S\xed":"No"})]})]})]}),(0,t.jsxs)("div",{className:m().raffleDetailSection,children:[t.jsx("div",{className:m().raffleDetailSectionTitle,children:"Progreso de tickets"}),(0,t.jsxs)("div",{className:m().ticketProgress,children:[(0,t.jsxs)("div",{className:m().ticketProgressLabel,children:[(0,t.jsxs)("span",{children:[s.soldTickets," / ",s.totalTickets," tickets vendidos"]}),(0,t.jsxs)("span",{className:m().ticketProgressPercentage,children:[Math.round(g),"%"]})]}),t.jsx("div",{className:m().progressBar,children:t.jsx("div",{className:m().progressBarFill,style:{width:`${g}%`}})})]})]}),(0,t.jsxs)("div",{className:m().raffleDetailSection,children:[t.jsx("div",{className:m().raffleDetailSectionTitle,children:"Informaci\xf3n del sorteo"}),(0,t.jsxs)("div",{className:m().raffleDetailGrid,children:[(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Estado"}),t.jsx("div",{className:m().raffleDetailItemValue,children:t.jsx(h.O,{status:s.status})})]}),(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Creado"}),t.jsx("div",{className:m().raffleDetailItemValue,children:new Date(s.createdAt).toLocaleDateString()})]}),s.activatedAt&&(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Activado"}),t.jsx("div",{className:m().raffleDetailItemValue,children:new Date(s.activatedAt).toLocaleDateString()})]}),s.raffleExecutedAt&&(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[t.jsx("div",{className:m().raffleDetailItemLabel,children:"Finalizado"}),t.jsx("div",{className:m().raffleDetailItemValue,children:new Date(s.raffleExecutedAt).toLocaleDateString()})]})]})]}),s.specialConditions&&(0,t.jsxs)("div",{className:m().raffleDetailSection,children:[t.jsx("div",{className:m().raffleDetailSectionTitle,children:"Condiciones especiales"}),t.jsx("p",{children:s.specialConditions})]}),s.status===u.r.FINISHED&&s.winnerTicketId&&t.jsx("div",{className:m().raffleDetailSection,children:(0,t.jsxs)("div",{className:m().alert+" "+m().alertSuccess,children:["âœ“ Sorteo finalizado. Ticket ganador: ",s.winnerTicketId]})}),(0,t.jsxs)("div",{className:m().buttonGroup,children:[s.status===u.r.DRAFT&&t.jsx("button",{onClick:j,className:m().primaryButton,disabled:p,children:p?"Enviando...":"Enviar para aprobaci\xf3n"}),(s.status===u.r.DRAFT||s.status===u.r.PENDING_APPROVAL)&&t.jsx("button",{onClick:N,className:m().dangerButton,disabled:p,children:p?"Cancelando...":"Cancelar sorteo"}),t.jsx("button",{onClick:()=>a.back(),className:m().secondaryButton,children:"Volver"})]})]})}var v=s(2345);function j({params:e}){let{user:a,isAuthenticated:s}=(0,i.t)(),[d,u]=(0,r.useState)(null),[f,p]=(0,r.useState)(!0),[h,j]=(0,r.useState)(null),N=async()=>{p(!0),j(null);try{let e=await n.m.getMyShop();u(e)}catch(e){j(e.response?.data?.message||"Error al cargar la tienda")}finally{p(!1)}};return t.jsx(v.i,{requiredRole:l.i.SHOP,children:(0,t.jsxs)("div",{className:m().panelContainer,children:[t.jsx(o.G,{isBlocked:d?.status==="blocked"}),(0,t.jsxs)("main",{className:m().mainContent,children:[f&&t.jsx("div",{className:m().alert,children:"Cargando tienda..."}),h&&(0,t.jsxs)("div",{className:`${m().alert} ${m().alertError}`,children:[h,t.jsx("button",{onClick:N,className:m().primaryButton,style:{marginLeft:"10px"},children:"Reintentar"})]}),d&&(0,t.jsxs)(t.Fragment,{children:[t.jsx(c.N,{shop:d}),t.jsx(x,{raffleId:e.id})]})]})]})})}},84837:(e,a,s)=>{"use strict";s.d(a,{O:()=>l});var t=s(19899),r=s(10195),i=s.n(r);function l({status:e}){return t.jsx("span",{className:i().statusBadge,style:{backgroundColor:(e=>{switch(e){case"pending":case"pending_approval":return"#FFA500";case"verified":case"active":return"#4CAF50";case"blocked":case"rejected":case"cancelled":return"#F44336";case"draft":return"#9E9E9E";case"sold_out":return"#2196F3";case"finished":return"#673AB7";default:return"#757575"}})(e)},children:{pending:"Pendiente",pending_approval:"Pendiente de aprobaci\xf3n",verified:"Verificada",blocked:"Bloqueada",active:"Activo",draft:"Borrador",sold_out:"Agotado",finished:"Finalizado",cancelled:"Cancelado",rejected:"Rechazado"}[e]||e})}},28848:(e,a,s)=>{"use strict";s.d(a,{m:()=>d});var t=s(10752),r=s(82986),i=s(26379),l=s(12576);let n=e=>e?.toDate?e.toDate():e instanceof Date?e:"string"==typeof e?new Date(e):new Date,c=e=>{let a=e.data();return{id:e.id,userId:a.userId||"",name:a.name||"",description:a.description,logo:a.logo,publicEmail:a.publicEmail,phone:a.phone,socialMedia:a.socialMedia,status:a.status||l.R.PENDING,createdAt:n(a.createdAt),updatedAt:n(a.updatedAt)}},o={async getShopById(e){try{let a=await (0,r.getDoc)((0,r.doc)(i.db,"shops",e));if(!a.exists())throw Error("Shop not found");return c(a)}catch(e){throw console.error("Error fetching shop:",e),e}},async getVerifiedShops(){try{let e=(0,r.collection)(i.db,"shops"),a=(0,r.query)(e,(0,r.where)("status","==",l.R.VERIFIED));return(await (0,r.getDocs)(a)).docs.map(e=>c(e)).sort((e,a)=>e.name.localeCompare(a.name))}catch(e){throw console.error("Error fetching verified shops:",e),e}},async getAllShops(){try{let e=(0,r.collection)(i.db,"shops");return(await (0,r.getDocs)(e)).docs.map(e=>c(e)).sort((e,a)=>e.name.localeCompare(a.name))}catch(e){throw console.error("Error fetching all shops:",e),e}}},d={getShopById:async e=>o.getShopById(e),getAllShops:async()=>o.getAllShops(),getVerifiedShops:async()=>o.getVerifiedShops(),getMyShop:async()=>(await t.x.get("/shops/my-shop/current")).data,updateShop:async(e,a)=>(await t.x.put(`/shops/${e}`,a)).data,getShopStatistics:async e=>(await t.x.get(`/shops/${e}/statistics`)).data}},12576:(e,a,s)=>{"use strict";var t;s.d(a,{R:()=>t}),function(e){e.PENDING="pending",e.VERIFIED="verified",e.BLOCKED="blocked"}(t||(t={}))},90211:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>t});let t=(0,s(2772).createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/app/panel/sorteos/[id]/page.tsx#default`)}};var a=require("../../../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[3591,8559,3352,4175,9388,31],()=>s(50374));module.exports=t})();