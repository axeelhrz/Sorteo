(()=>{var e={};e.id=307,e.ids=[307],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},11817:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>n.a,__next_app__:()=>_,originalPathname:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>c}),t(53395),t(22399),t(12874);var r=t(27105),s=t(15265),l=t(90157),n=t.n(l),o=t(44665),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);t.d(a,i);let c=["",{children:["panel",{children:["sorteos",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,53395)),"/Users/axelhernandez/Sorteos/frontend/src/app/panel/sorteos/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,22399)),"/Users/axelhernandez/Sorteos/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,12874,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/axelhernandez/Sorteos/frontend/src/app/panel/sorteos/page.tsx"],p="/panel/sorteos/page",_={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/panel/sorteos/page",pathname:"/panel/sorteos",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7236:()=>{},37725:(e,a,t)=>{Promise.resolve().then(t.bind(t,59189))},4104:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,33817,23)),Promise.resolve().then(t.t.bind(t,19323,23)),Promise.resolve().then(t.t.bind(t,52204,23)),Promise.resolve().then(t.t.bind(t,60820,23)),Promise.resolve().then(t.t.bind(t,55915,23)),Promise.resolve().then(t.t.bind(t,81611,23))},59189:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>v});var r=t(19899),s=t(5507),l=t(38442),n=t(1260),o=t(57355),i=t(26028),c=t(84499),d=t(54175),p=t(65373),_=t(18980),u=t(10195),h=t.n(u),f=t(84837),m=t(87963);function x({shopId:e}){let[a,t]=(0,s.useState)([]),[l,n]=(0,s.useState)(!0),[o,i]=(0,s.useState)(null),[c,u]=(0,s.useState)("all"),x=async()=>{n(!0),i(null);try{let a=await _.W.getRafflesByShop(e);t(a)}catch(e){i(e.response?.data?.message||"Error al cargar los sorteos")}finally{n(!1)}},g="all"===c?a:a.filter(e=>e.status===c),v=async e=>{if(confirm("\xbfEst\xe1s seguro de que deseas cancelar este sorteo?"))try{await _.W.cancelRaffle(e),t(a.map(a=>a.id===e?{...a,status:p.r.CANCELLED}:a))}catch(e){alert(e.response?.data?.message||"Error al cancelar el sorteo")}};return l?r.jsx("div",{className:h().alert,children:"Cargando sorteos..."}):o?(0,r.jsxs)("div",{className:h().alert+" "+h().alertError,children:[o,r.jsx("button",{onClick:x,className:h().primaryButton,style:{marginLeft:"10px"},children:"Reintentar"})]}):0===a.length?r.jsx(m.u,{title:"No tienes sorteos a\xfan",description:"Crea tu primer sorteo para comenzar a vender tickets",icon:"\uD83C\uDFB2",action:{label:"Crear sorteo",onClick:()=>window.location.href="/panel/sorteos/crear"}}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:h().raffleDetailSection,children:[r.jsx("label",{className:h().raffleDetailSectionTitle,children:"Filtrar por estado"}),(0,r.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:h().formSelect,style:{maxWidth:"300px"},children:[r.jsx("option",{value:"all",children:"Todos los estados"}),r.jsx("option",{value:p.r.DRAFT,children:"Borrador"}),r.jsx("option",{value:p.r.PENDING_APPROVAL,children:"Pendiente de aprobaci\xf3n"}),r.jsx("option",{value:p.r.ACTIVE,children:"Activo"}),r.jsx("option",{value:p.r.SOLD_OUT,children:"Agotado"}),r.jsx("option",{value:p.r.FINISHED,children:"Finalizado"}),r.jsx("option",{value:p.r.CANCELLED,children:"Cancelado"})]})]}),(0,r.jsxs)("table",{className:h().table,children:[r.jsx("thead",{className:h().tableHeader,children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:h().tableHeaderCell,children:"Producto"}),r.jsx("th",{className:h().tableHeaderCell,children:"Estado"}),r.jsx("th",{className:h().tableHeaderCell,children:"Tickets"}),r.jsx("th",{className:h().tableHeaderCell,children:"Creado"}),r.jsx("th",{className:h().tableHeaderCell,children:"Acciones"})]})}),r.jsx("tbody",{children:g.map(e=>(0,r.jsxs)("tr",{className:h().tableRow,children:[r.jsx("td",{className:h().tableCell,children:e.product?.name||"Producto desconocido"}),r.jsx("td",{className:h().tableCell,children:r.jsx(f.O,{status:e.status})}),(0,r.jsxs)("td",{className:h().tableCell,children:[e.soldTickets," / ",e.totalTickets]}),r.jsx("td",{className:h().tableCell,children:new Date(e.createdAt).toLocaleDateString()}),r.jsx("td",{className:h().tableCell,children:(0,r.jsxs)("div",{className:h().cardActions,children:[r.jsx(d.default,{href:`/panel/sorteos/${e.id}`,className:h().cardActionPrimary,children:"Ver"}),(e.status===p.r.DRAFT||e.status===p.r.PENDING_APPROVAL)&&r.jsx("button",{onClick:()=>v(e.id),className:h().cardActionSecondary,children:"Cancelar"})]})})]},e.id))})]})]})}var g=t(2345);function v(){let{user:e,isAuthenticated:a}=(0,l.t)(),[t,d]=(0,s.useState)(null),[p,_]=(0,s.useState)(!0),[u,f]=(0,s.useState)(null),m=async()=>{_(!0),f(null);try{let e=await o.m.getMyShop();d(e)}catch(e){f(e.response?.data?.message||"Error al cargar la tienda")}finally{_(!1)}};return r.jsx(g.i,{requiredRole:n.i.SHOP,children:(0,r.jsxs)("div",{className:h().panelContainer,children:[r.jsx(c.G,{isBlocked:t?.status==="blocked"}),(0,r.jsxs)("main",{className:h().mainContent,children:[p&&r.jsx("div",{className:h().alert,children:"Cargando tienda..."}),u&&(0,r.jsxs)("div",{className:`${h().alert} ${h().alertError}`,children:[u,r.jsx("button",{onClick:m,className:h().primaryButton,style:{marginLeft:"10px"},children:"Reintentar"})]}),t&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(i.N,{shop:t}),(0,r.jsxs)("div",{className:h().raffleDetail,children:[r.jsx("h1",{className:h().raffleDetailTitle,children:"Mis sorteos"}),r.jsx(x,{shopId:t.id})]})]})]})]})})}},2345:(e,a,t)=>{"use strict";t.d(a,{i:()=>n});var r=t(19899);t(5507);var s=t(76153),l=t(38442);function n({children:e,requiredRole:a}){(0,s.useRouter)();let{user:t,isAuthenticated:n}=(0,l.t)();return n&&t?a&&t.role!==a?r.jsx("div",{children:"No tienes permiso para acceder a esta p\xe1gina"}):r.jsx(r.Fragment,{children:e}):r.jsx("div",{children:"Cargando..."})}},87963:(e,a,t)=>{"use strict";t.d(a,{u:()=>n});var r=t(19899),s=t(10195),l=t.n(s);function n({title:e,description:a,icon:t,action:s}){return(0,r.jsxs)("div",{className:l().emptyState,children:[t&&r.jsx("div",{className:l().emptyStateIcon,children:t}),r.jsx("h3",{className:l().emptyStateTitle,children:e}),r.jsx("p",{className:l().emptyStateDescription,children:a}),s&&r.jsx("button",{className:l().primaryButton,onClick:s.onClick,children:s.label})]})}},26028:(e,a,t)=>{"use strict";t.d(a,{N:()=>n});var r=t(19899),s=t(10195),l=t.n(s);function n({shop:e}){return r.jsx("div",{className:l().shopHeader,children:(0,r.jsxs)("div",{className:l().shopHeaderContent,children:[e.logo&&r.jsx("img",{src:e.logo,alt:e.name,className:l().shopLogo}),(0,r.jsxs)("div",{className:l().shopHeaderInfo,children:[r.jsx("h1",{className:l().shopName,children:e.name}),r.jsx("p",{className:l().shopDescription,children:e.description})]})]})})}},84499:(e,a,t)=>{"use strict";t.d(a,{G:()=>i});var r=t(19899),s=t(54175),l=t(76153),n=t(10195),o=t.n(n);function i({isBlocked:e=!1}){let a=(0,l.usePathname)();return r.jsx("aside",{className:o().sidebar,children:(0,r.jsxs)("nav",{className:o().sidebarNav,children:[r.jsx(s.default,{href:"/panel/tienda",className:`${o().navLink} ${"/panel/tienda"===a?o().active:""}`,children:"\uD83D\uDCCB Mi tienda"}),r.jsx(s.default,{href:"/panel/productos",className:`${o().navLink} ${"/panel/productos"===a?o().active:""}`,children:"\uD83D\uDCE6 Mis productos"}),r.jsx(s.default,{href:"/panel/sorteos",className:`${o().navLink} ${"/panel/sorteos"===a?o().active:""}`,children:"\uD83C\uDFB2 Mis sorteos"}),!e&&r.jsx(s.default,{href:"/panel/sorteos/crear",className:`${o().navLink} ${"/panel/sorteos/crear"===a?o().active:""}`,children:"âž• Crear sorteo"})]})})}},84837:(e,a,t)=>{"use strict";t.d(a,{O:()=>n});var r=t(19899),s=t(10195),l=t.n(s);function n({status:e}){return r.jsx("span",{className:l().statusBadge,style:{backgroundColor:(e=>{switch(e){case"pending":case"pending_approval":return"#FFA500";case"verified":case"active":return"#4CAF50";case"blocked":case"rejected":case"cancelled":return"#F44336";case"draft":return"#9E9E9E";case"sold_out":return"#2196F3";case"finished":return"#673AB7";default:return"#757575"}})(e)},children:{pending:"Pendiente",pending_approval:"Pendiente de aprobaci\xf3n",verified:"Verificada",blocked:"Bloqueada",active:"Activo",draft:"Borrador",sold_out:"Agotado",finished:"Finalizado",cancelled:"Cancelado",rejected:"Rechazado"}[e]||e})}},10752:(e,a,t)=>{"use strict";t.d(a,{x:()=>l});var r=t(20751);class s{client;constructor(){this.client=r.Z.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>{try{let a=localStorage.getItem("token");console.log("API Request - Token from localStorage:",a),a?(e.headers.Authorization=`Bearer ${a}`,console.log("API Request - Authorization header set:",e.headers.Authorization)):console.log("API Request - No token found"),e.data instanceof FormData&&delete e.headers["Content-Type"]}catch(e){console.error("Error reading token from localStorage:",e)}return e}),this.client.interceptors.response.use(e=>e,e=>(e.response?.status===401&&localStorage.removeItem("token"),Promise.reject(e)))}async register(e){return this.client.post("/auth/register",e)}async login(e){return this.client.post("/auth/login",e)}async getProfile(){return this.client.get("/auth/profile")}async logout(){return this.client.post("/auth/logout")}async get(e,a){return this.client.get(e,a)}async post(e,a,t){return this.client.post(e,a,t)}async put(e,a){return this.client.put(e,a)}async delete(e){return this.client.delete(e)}}let l=new s},18980:(e,a,t)=>{"use strict";t.d(a,{W:()=>s});var r=t(10752);let s={getRafflesByShop:async e=>(await r.x.get(`/raffles?shopId=${e}`)).data,getRaffleById:async e=>(await r.x.get(`/raffles/${e}`)).data,createRaffle:async e=>(await r.x.post("/raffles",e)).data,updateRaffle:async(e,a)=>(await r.x.put(`/raffles/${e}`,a)).data,submitForApproval:async e=>(await r.x.put(`/raffles/${e}/submit-approval`,{})).data,cancelRaffle:async e=>(await r.x.put(`/raffles/${e}/cancel`,{})).data,getActiveRaffles:async()=>(await r.x.get("/raffles/active")).data,getAllRaffles:async()=>(await r.x.get("/raffles")).data}},57355:(e,a,t)=>{"use strict";t.d(a,{m:()=>s});var r=t(10752);let s={getMyShop:async()=>(await r.x.get("/shops/my-shop/current")).data,getShopById:async e=>(await r.x.get(`/shops/${e}`)).data,updateShop:async(e,a)=>(await r.x.put(`/shops/${e}`,a)).data,getAllShops:async()=>(await r.x.get("/shops")).data,getVerifiedShops:async()=>(await r.x.get("/shops/verified")).data,getShopStatistics:async e=>(await r.x.get(`/shops/${e}/statistics`)).data}},38442:(e,a,t)=>{"use strict";t.d(a,{t:()=>l});var r=t(24978),s=t(31460);let l=(0,r.Ue)()((0,s.tJ)(e=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,setUser:a=>e({user:a,isAuthenticated:!!a}),setToken:a=>{a?localStorage.setItem("token",a):localStorage.removeItem("token"),e({token:a})},setIsLoading:a=>e({isLoading:a}),setError:a=>e({error:a}),logout:()=>{localStorage.removeItem("token"),e({user:null,token:null,isAuthenticated:!1})}}),{name:"auth-store",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))},1260:(e,a,t)=>{"use strict";var r;t.d(a,{i:()=>r}),function(e){e.ADMIN="admin",e.SHOP="shop",e.USER="user"}(r||(r={}))},65373:(e,a,t)=>{"use strict";var r;t.d(a,{r:()=>r}),function(e){e.DRAFT="draft",e.PENDING_APPROVAL="pending_approval",e.ACTIVE="active",e.PAUSED="paused",e.SOLD_OUT="sold_out",e.FINISHED="finished",e.CANCELLED="cancelled",e.REJECTED="rejected"}(r||(r={}))},10195:e=>{e.exports={panelContainer:"panel_panelContainer__Kt8Ty",sidebar:"panel_sidebar__KeScH",sidebarNav:"panel_sidebarNav__KjeNV",navLink:"panel_navLink__sQoV6",active:"panel_active___ehGn",mainContent:"panel_mainContent__7V2fv",shopHeader:"panel_shopHeader__iRrDp",shopHeaderContent:"panel_shopHeaderContent__wsZnH",shopLogo:"panel_shopLogo__gTusz",shopHeaderInfo:"panel_shopHeaderInfo__IKOo3",shopName:"panel_shopName__lr5MU",shopDescription:"panel_shopDescription__zNvIE",statusBadge:"panel_statusBadge__37f3q",formGroup:"panel_formGroup__0UyVN",formLabel:"panel_formLabel___zOHD",formInput:"panel_formInput__bLzwR",formTextarea:"panel_formTextarea__B2MkI",formSelect:"panel_formSelect__thum_",primaryButton:"panel_primaryButton__ArDHW",secondaryButton:"panel_secondaryButton__KSKVI",dangerButton:"panel_dangerButton__2WLFi",buttonGroup:"panel_buttonGroup__pcyfD",card:"panel_card__ttDyJ",cardHeader:"panel_cardHeader__scyyA",cardTitle:"panel_cardTitle__K6V__",cardActions:"panel_cardActions___eqre",cardAction:"panel_cardAction__xpZWN",cardActionPrimary:"panel_cardActionPrimary__t_VOi",cardActionSecondary:"panel_cardActionSecondary__gcgLm",table:"panel_table__GBWH_",tableHeader:"panel_tableHeader__TN7va",tableHeaderCell:"panel_tableHeaderCell__WZypp",tableRow:"panel_tableRow__oR22e",tableCell:"panel_tableCell__GdQvd",tableCellCenter:"panel_tableCellCenter__Gc4za",tableCellRight:"panel_tableCellRight__jl067",emptyState:"panel_emptyState__1c4lK",emptyStateIcon:"panel_emptyStateIcon__znkGr",emptyStateTitle:"panel_emptyStateTitle__OpZSI",emptyStateDescription:"panel_emptyStateDescription__P3sK_",alert:"panel_alert__dbKCy",alertSuccess:"panel_alertSuccess__T39ZR",alertError:"panel_alertError__9DFT4",alertWarning:"panel_alertWarning__sOPwe",alertInfo:"panel_alertInfo__PLXx9",progressBar:"panel_progressBar__Ik7pm",progressBarFill:"panel_progressBarFill__NCwij",profileForm:"panel_profileForm__VbWs3",profileFormSection:"panel_profileFormSection__t80bQ",profileFormSectionTitle:"panel_profileFormSectionTitle__o8RW2",readOnlyField:"panel_readOnlyField___M4rQ",raffleForm:"panel_raffleForm__s3ll7",raffleFormSection:"panel_raffleFormSection__PUcJc",raffleFormSectionTitle:"panel_raffleFormSectionTitle__1DglO",dimensionsGrid:"panel_dimensionsGrid__7jafN",dimensionInfo:"panel_dimensionInfo__bjc2e",dimensionLabel:"panel_dimensionLabel__FAjKe",dimensionValue:"panel_dimensionValue__Jm7tM",depositWarning:"panel_depositWarning__mU2qE",ticketCalculation:"panel_ticketCalculation___d694",ticketCalculationValue:"panel_ticketCalculationValue__KOcl_",raffleDetail:"panel_raffleDetail__nigCY",raffleDetailHeader:"panel_raffleDetailHeader__xcVaX",raffleDetailTitle:"panel_raffleDetailTitle___LWvI",raffleDetailStatus:"panel_raffleDetailStatus__GBSlq",raffleDetailSection:"panel_raffleDetailSection__Y6dGR",raffleDetailSectionTitle:"panel_raffleDetailSectionTitle__6HXue",raffleDetailGrid:"panel_raffleDetailGrid__U8h9R",raffleDetailItem:"panel_raffleDetailItem__frOK2",raffleDetailItemLabel:"panel_raffleDetailItemLabel__PLUUN",raffleDetailItemValue:"panel_raffleDetailItemValue__mVKfw",ticketProgress:"panel_ticketProgress__9PZKW",ticketProgressLabel:"panel_ticketProgressLabel__fBS77",ticketProgressPercentage:"panel_ticketProgressPercentage__nBOhy",statCard:"panel_statCard__Dx3Sz",statCardIcon:"panel_statCardIcon__zp227",statCardValue:"panel_statCardValue__RWvG6",statCardLabel:"panel_statCardLabel__wRjrF",formHelpText:"panel_formHelpText__IpKar",formInputError:"panel_formInputError__oPd_O"}},22399:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l,metadata:()=>s});var r=t(35023);t(91641);let s={title:"TIKETEA ONLINE",description:"Plataforma de sorteos online - TIKETEA ONLINE"};function l({children:e}){return r.jsx("html",{lang:"es",children:r.jsx("body",{children:e})})}},53395:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>r});let r=(0,t(2772).createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/app/panel/sorteos/page.tsx#default`)},91641:()=>{}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[276,751,1925,4175],()=>t(11817));module.exports=r})();