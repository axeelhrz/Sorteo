(()=>{var e={};e.id=285,e.ids=[285],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},44898:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>l}),r(60429),r(24198),r(12874);var s=r(27105),a=r(15265),o=r(90157),n=r.n(o),c=r(44665),i={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>c[e]);r.d(t,i);let l=["",{children:["checkout",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,60429)),"/Users/axelhernandez/Sorteos/frontend/src/app/checkout/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,24198)),"/Users/axelhernandez/Sorteos/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,12874,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/axelhernandez/Sorteos/frontend/src/app/checkout/page.tsx"],u="/checkout/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/checkout/page",pathname:"/checkout",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},62019:(e,t,r)=>{Promise.resolve().then(r.bind(r,38850))},57800:(e,t,r)=>{Promise.resolve().then(r.bind(r,81364))},4104:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,33817,23)),Promise.resolve().then(r.t.bind(r,19323,23)),Promise.resolve().then(r.t.bind(r,52204,23)),Promise.resolve().then(r.t.bind(r,60820,23)),Promise.resolve().then(r.t.bind(r,55915,23)),Promise.resolve().then(r.t.bind(r,81611,23))},38850:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u,dynamic:()=>l});var s=r(19899),a=r(5507),o=r(76153),n=r(33745),c=r(89053),i=r.n(c);let l="force-dynamic";function d(){let e=(0,o.useSearchParams)(),t=(0,o.useRouter)();e.get("paymentId");let[r,c]=(0,a.useState)(null),[l,d]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),p=async()=>{if(r)try{console.log("Iniciando pago con Stripe..."),setTimeout(async()=>{try{await n.Z.confirmPayment({paymentId:r.id,externalTransactionId:`stripe_${Date.now()}`,paymentMethod:"stripe"}),t.push(`/payment-success?paymentId=${r.id}`)}catch(e){console.error("Error confirming payment:",e),h("Error al confirmar el pago")}},2e3)}catch(e){h("Error al procesar el pago"),console.error(e)}},m=async()=>{if(r)try{console.log("Iniciando pago con Mercado Pago..."),setTimeout(async()=>{try{await n.Z.confirmPayment({paymentId:r.id,externalTransactionId:`mp_${Date.now()}`,paymentMethod:"mercado_pago"}),t.push(`/payment-success?paymentId=${r.id}`)}catch(e){console.error("Error confirming payment:",e),h("Error al confirmar el pago")}},2e3)}catch(e){h("Error al procesar el pago"),console.error(e)}},y=async()=>{if(r)try{await n.Z.failPayment(r.id,"Pago rechazado por el usuario"),t.push(`/payment-failed?paymentId=${r.id}`)}catch(e){console.error("Error failing payment:",e),h("Error al procesar el rechazo del pago")}};return l?s.jsx("div",{className:i().container,children:s.jsx("div",{className:i().loadingSpinner,children:"Cargando..."})}):u||!r?s.jsx("div",{className:i().container,children:(0,s.jsxs)("div",{className:i().errorBox,children:[s.jsx("h1",{children:"Error"}),s.jsx("p",{children:u||"No se pudo cargar el pago"}),s.jsx("button",{onClick:()=>t.back(),children:"Volver"})]})}):s.jsx("div",{className:i().container,children:(0,s.jsxs)("div",{className:i().checkoutCard,children:[s.jsx("h1",{className:i().title,children:"Checkout"}),(0,s.jsxs)("div",{className:i().summarySection,children:[s.jsx("h2",{children:"Resumen de tu compra"}),(0,s.jsxs)("div",{className:i().summaryItem,children:[s.jsx("span",{children:"Cantidad de tickets:"}),s.jsx("span",{className:i().value,children:r.ticketQuantity})]}),(0,s.jsxs)("div",{className:i().summaryItem,children:[s.jsx("span",{children:"Monto total:"}),(0,s.jsxs)("span",{className:i().value,children:["S/. ",Number(r.amount).toFixed(2)]})]}),(0,s.jsxs)("div",{className:i().summaryItem,children:[s.jsx("span",{children:"Moneda:"}),s.jsx("span",{className:i().value,children:r.currency})]})]}),(0,s.jsxs)("div",{className:i().paymentMethods,children:[s.jsx("h2",{children:"Selecciona un m\xe9todo de pago"}),(0,s.jsxs)("div",{className:i().methodCard,children:[(0,s.jsxs)("div",{className:i().methodHeader,children:[s.jsx("h3",{children:"Tarjeta de Cr\xe9dito / D\xe9bito"}),s.jsx("p",{className:i().methodDescription,children:"Paga de forma segura con Stripe"})]}),s.jsx("button",{className:i().payButton,onClick:p,children:"Pagar con Stripe"})]}),(0,s.jsxs)("div",{className:i().methodCard,children:[(0,s.jsxs)("div",{className:i().methodHeader,children:[s.jsx("h3",{children:"Mercado Pago"}),s.jsx("p",{className:i().methodDescription,children:"Paga con tu cuenta de Mercado Pago"})]}),s.jsx("button",{className:i().payButton,onClick:m,children:"Pagar con Mercado Pago"})]})]}),s.jsx("div",{className:i().actions,children:s.jsx("button",{className:i().cancelButton,onClick:y,children:"Cancelar compra"})}),u&&s.jsx("div",{className:i().errorMessage,children:u})]})})}function u(){return s.jsx(a.Suspense,{fallback:s.jsx("div",{className:i().container,children:s.jsx("div",{className:i().loadingSpinner,children:"Cargando..."})}),children:s.jsx(d,{})})}},81364:(e,t,r)=>{"use strict";function s(){return null}r.d(t,{default:()=>s}),r(5507),r(82986),r(26379)},10752:(e,t,r)=>{"use strict";r.d(t,{x:()=>n});var s=r(20751);let a=(()=>{let e="http://localhost:3001/api";if(!e.startsWith("http://")&&!e.startsWith("https://"))return console.warn("⚠️ NEXT_PUBLIC_API_URL no tiene protocolo, usando https://"),`https://${e}`;if(!e.endsWith("/api")){let t=e.endsWith("/")?e.slice(0,-1):e;return`${t}/api`}return e})();class o{client;constructor(){this.client=s.Z.create({baseURL:a,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>{try{let t=localStorage.getItem("token");console.log("API Request - Token from localStorage:",t),t?(e.headers.Authorization=`Bearer ${t}`,console.log("API Request - Authorization header set:",e.headers.Authorization)):console.log("API Request - No token found"),e.data instanceof FormData&&delete e.headers["Content-Type"]}catch(e){console.error("Error reading token from localStorage:",e)}return e}),this.client.interceptors.response.use(e=>e,e=>(e.response?.status===401&&localStorage.removeItem("token"),Promise.reject(e)))}async register(e){return this.client.post("/auth/register",e)}async login(e){return this.client.post("/auth/login",e)}async getProfile(){return this.client.get("/auth/profile")}async logout(){return this.client.post("/auth/logout")}async get(e,t){return this.client.get(e,t)}async post(e,t,r){return this.client.post(e,t,r)}async put(e,t){return this.client.put(e,t)}async delete(e){return this.client.delete(e)}}let n=new o},26379:(e,t,r)=>{"use strict";let s;r.d(t,{I8:()=>l,db:()=>i});var a=r(3827),o=r(82986),n=r(31027),c=r(80549);s=0===(0,a.C6)().length?(0,a.ZF)({apiKey:"AIzaSyCROuDbFChzWrRSXQ42lih56oLEA1hjne4",authDomain:"sorteo-b8fb0.firebaseapp.com",projectId:"sorteo-b8fb0",storageBucket:"sorteo-b8fb0.firebasestorage.app",messagingSenderId:"58395659334",appId:"1:58395659334:web:58c8f46dab380710eb4e47"}):(0,a.C6)()[0];let i=(0,o.ad)(s);(0,n.cF)(s);let l=(0,c.v0)(s)},33745:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(10752);let a={async createPayment(e){try{return(await s.x.post("/payments",e)).data}catch(e){throw console.error("Error creating payment:",e),e}},async confirmPayment(e){try{return(await s.x.post("/payments/confirm",e)).data}catch(e){throw console.error("Error confirming payment:",e),e}},async failPayment(e,t){try{return(await s.x.post(`/payments/${e}/fail`,{failureReason:t})).data}catch(e){throw console.error("Error failing payment:",e),e}},async getPaymentById(e){try{return(await s.x.get(`/payments/${e}`)).data}catch(e){throw console.error("Error fetching payment:",e),e}},async getMyPayments(){try{return(await s.x.get("/payments/user/me")).data}catch(e){throw console.error("Error fetching user payments:",e),e}},async getCompletedPaymentsByRaffleId(e){try{return(await s.x.get(`/payments/raffle/${e}`)).data}catch(e){throw console.error("Error fetching raffle payments:",e),e}},async refundPayment(e){try{return(await s.x.post(`/payments/${e}/refund`,{})).data}catch(e){throw console.error("Error refunding payment:",e),e}}}},89053:e=>{e.exports={container:"checkout_container__GDzOa",checkoutCard:"checkout_checkoutCard__iuXeq",title:"checkout_title___IbnB",summarySection:"checkout_summarySection__P4iQG",summaryItem:"checkout_summaryItem__MnGnX",value:"checkout_value__bCB5l",paymentMethods:"checkout_paymentMethods__zaLSU",methodCard:"checkout_methodCard___LQqq",methodHeader:"checkout_methodHeader__rS04T",methodDescription:"checkout_methodDescription__V3XCm",payButton:"checkout_payButton__AP8qQ",actions:"checkout_actions__ZoHqw",cancelButton:"checkout_cancelButton__V4VVG",errorMessage:"checkout_errorMessage__WSOsj",loadingSpinner:"checkout_loadingSpinner__hzzjX",errorBox:"checkout_errorBox__MYp_o"}},60429:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,dynamic:()=>a});var s=r(2772);let a=(0,s.createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/app/checkout/page.tsx#dynamic`),o=(0,s.createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/app/checkout/page.tsx#default`)},24198:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,metadata:()=>o});var s=r(35023);r(91641);let a=(0,r(2772).createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/components/MakeAdminScript.tsx#default`),o={title:"TIKETEA ONLINE",description:"Plataforma de sorteos online - TIKETEA ONLINE"};function n({children:e}){return s.jsx("html",{lang:"es",children:(0,s.jsxs)("body",{children:[e,s.jsx(a,{})]})})}},91641:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[3591,8559],()=>r(44898));module.exports=s})();