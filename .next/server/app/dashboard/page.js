(()=>{var e={};e.id=7702,e.ids=[7702],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},94939:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>l}),a(12516),a(24198),a(12874);var s=a(27105),r=a(15265),o=a(90157),i=a.n(o),n=a(44665),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);a.d(t,d);let l=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,12516)),"/Users/axelhernandez/Sorteos/frontend/src/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,24198)),"/Users/axelhernandez/Sorteos/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,12874,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/axelhernandez/Sorteos/frontend/src/app/dashboard/page.tsx"],u="/dashboard/page",h={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},3041:(e,t,a)=>{Promise.resolve().then(a.bind(a,61240))},57800:(e,t,a)=>{Promise.resolve().then(a.bind(a,81364))},4104:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,33817,23)),Promise.resolve().then(a.t.bind(a,19323,23)),Promise.resolve().then(a.t.bind(a,52204,23)),Promise.resolve().then(a.t.bind(a,60820,23)),Promise.resolve().then(a.t.bind(a,55915,23)),Promise.resolve().then(a.t.bind(a,81611,23))},61240:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var s=a(19899),r=a(5507),o=a(76153),i=a(55562),n=a(80760);a(28848);var d=a(79114),l=a(33745),c=a(24544),u=a(43993),h=a(60594),p=a.n(h);function m(){let e=(0,o.useRouter)(),{user:t,token:h,logout:m,isHydrated:x}=(0,n.a)(),[g,j]=(0,r.useState)(!0),[b,f]=(0,r.useState)([]),[v,y]=(0,r.useState)(null),[N,w]=(0,r.useState)([]),[I,S]=(0,r.useState)([]),[C,_]=(0,r.useState)([]),[A,k]=(0,r.useState)([]),[E,T]=(0,r.useState)("overview"),[D,P]=(0,r.useState)([]),[F,B]=(0,r.useState)(null),[q,z]=(0,r.useState)(!1),[R,L]=(0,r.useState)(!1),[G,V]=(0,r.useState)(""),[M,O]=(0,r.useState)(null),[$,U]=(0,r.useState)(null),[W,H]=(0,r.useState)([]),[X,K]=(0,r.useState)([]),[J,Y]=(0,r.useState)(null),[Z,Q]=(0,r.useState)({}),[ee,et]=(0,r.useState)(null),[ea,es]=(0,r.useState)(!1),[er,eo]=(0,r.useState)(!1),[ei,en]=(0,r.useState)(!1),[ed,el]=(0,r.useState)(!1),[ec,eu]=(0,r.useState)({shopId:"",productId:"",specialConditions:""}),[eh,ep]=(0,r.useState)({shopId:"",name:"",description:"",value:0,height:0,width:0,depth:0,category:"",mainImage:""}),[em,ex]=(0,r.useState)([]),[,eg]=(0,r.useState)(null),[ej,eb]=(0,r.useState)(!1),[ef,ev]=(0,r.useState)(null),[ey,eN]=(0,r.useState)(null),[ew,eI]=(0,r.useState)(null),eS=async()=>{try{let{collection:e,query:t,getDocs:s,doc:r,getDoc:o}=await Promise.resolve().then(a.bind(a,82986)),{db:i}=await Promise.resolve().then(a.bind(a,26379)),n=e(i,"raffles"),d=await s(t(n));console.log("\uD83D\uDCCA Total sorteos en la base de datos:",d.docs.length);let l={};d.docs.forEach(e=>{let t=e.data().status||"sin-status";l[t]=(l[t]||0)+1}),console.log("\uD83D\uDCCA Status encontrados en todos los sorteos:",l);let c=["pending_approval","Pendiente de Aprobaci\xf3n","pending","Pendiente"],u=d.docs.filter(e=>{let t=(e.data().status||"").toLowerCase();return c.some(e=>{let a=e.toLowerCase();return t===a||t.includes("pending")||t.includes("pendiente")})});console.log("\uD83D\uDCCA Sorteos pendientes encontrados despu\xe9s de filtrar:",u.length),0===u.length&&console.warn('⚠️ No se encontraron sorteos pendientes. Verifica que los sorteos tengan status "pending_approval" en Firestore.');let h=[];for(let e of u){let t=e.data();console.log("\uD83D\uDD0D Sorteo encontrado:",{id:e.id,status:t.status,productId:t.productId,createdAt:t.createdAt});let a=null;if(t.productId)try{let e=await o(r(i,"products",t.productId));if(e.exists()){let t=e.data();a={id:e.id,name:t.name||"",value:t.value||0}}}catch(e){console.log("Error loading product:",e)}let s=t.createdAt?.toDate()||new Date;h.push({id:e.id,productId:t.productId||"",product:a||void 0,totalTickets:t.totalTickets||0,soldTickets:t.soldTickets||0,status:t.status||"draft",createdAt:s.toISOString(),productValue:t.productValue||0,winnerTicketId:t.winnerTicketId,raffleExecutedAt:t.raffleExecutedAt?.toDate()?.toISOString()})}return h.sort((e,t)=>{let a=new Date(e.createdAt).getTime();return new Date(t.createdAt).getTime()-a}),console.log("✅ Sorteos pendientes cargados:",h.length),console.log("\uD83D\uDCCB IDs de sorteos pendientes:",h.map(e=>e.id)),h}catch(e){if(console.error("Error loading pending raffles:",e),"failed-precondition"===e.code||e.message?.includes("index")){console.log("⚠️ \xcdndice faltante, intentando sin orderBy...");try{let{collection:e,query:t,where:s,getDocs:r,doc:o,getDoc:i}=await Promise.resolve().then(a.bind(a,82986)),{db:n}=await Promise.resolve().then(a.bind(a,26379)),d=e(n,"raffles"),l=t(d,s("status","==","pending_approval")),c=await r(l),u=[];for(let e of c.docs){let t=e.data(),a=null;if(t.productId)try{let e=await i(o(n,"products",t.productId));if(e.exists()){let t=e.data();a={id:e.id,name:t.name||"",value:t.value||0}}}catch(e){console.log("Error loading product:",e)}let s=t.createdAt?.toDate()||new Date;u.push({id:e.id,productId:t.productId||"",product:a||void 0,totalTickets:t.totalTickets||0,soldTickets:t.soldTickets||0,status:t.status||"draft",createdAt:s.toISOString(),productValue:t.productValue||0,winnerTicketId:t.winnerTicketId,raffleExecutedAt:t.raffleExecutedAt?.toDate()?.toISOString()})}return u.sort((e,t)=>{let a=new Date(e.createdAt).getTime();return new Date(t.createdAt).getTime()-a}),u}catch(e){console.error("Error en reintento:",e)}}return[]}},eC=async()=>{try{await m(),e.push("/")}catch(t){console.error("Error al cerrar sesi\xf3n:",t),e.push("/")}},e_=()=>{es(!1),eu({shopId:"",productId:"",specialConditions:""})},eA=async e=>{if(e.preventDefault(),!ec.shopId||!ec.productId){et("Por favor completa todos los campos requeridos");return}en(!0);try{let{raffleService:e}=await a.e(31).then(a.bind(a,31)),t=await e.createRaffle({shopId:ec.shopId,productId:ec.productId,specialConditions:ec.specialConditions||void 0}),s={...t,createdAt:t.createdAt instanceof Date?t.createdAt.toISOString():t.createdAt,raffleExecutedAt:t.raffleExecutedAt instanceof Date?t.raffleExecutedAt.toISOString():t.raffleExecutedAt};S([...I,s]),e_(),et(null)}catch(e){et(e.message||"Error al crear el sorteo")}finally{en(!1)}},ek=(e,t,a)=>{let s=[];return e<=0&&s.push("La altura debe ser mayor a 0"),t<=0&&s.push("El ancho debe ser mayor a 0"),a<=0&&s.push("La profundidad debe ser mayor a 0"),e>15&&s.push("La altura no puede exceder 15cm"),t>15&&s.push("El ancho no puede exceder 15cm"),a>15&&s.push("La profundidad no puede exceder 15cm"),s},eE=(e,t)=>{let a=parseFloat(t)||0;ep(t=>({...t,[e]:a})),ex(ek("height"===e?a:eh.height,"width"===e?a:eh.width,"depth"===e?a:eh.depth))},eT=async()=>{if(t?.role!=="shop"||v)v?ep(e=>({...e,shopId:v.id})):b.length>0&&ep(e=>({...e,shopId:b[0].id}));else try{let{collection:e,query:s,where:r,getDocs:o}=await Promise.resolve().then(a.bind(a,82986)),{db:i}=await Promise.resolve().then(a.bind(a,26379)),n=e(i,"shops"),d=s(n,r("userId","==",t.id)),l=await o(d);if(!l.empty){let e=l.docs[0],a=e.data(),s={id:e.id,userId:a.userId||t.id,name:a.name||"",description:a.description,logo:a.logo,publicEmail:a.publicEmail,phone:a.phone,socialMedia:a.socialMedia,status:a.status||"pending",createdAt:a.createdAt?.toDate()||new Date,updatedAt:a.updatedAt?.toDate()||new Date};y(s),f([s]),ep(e=>({...e,shopId:s.id}))}}catch(e){console.error("Error obteniendo tienda al abrir modal:",e),et("No se pudo obtener la informaci\xf3n de tu tienda. Por favor, recarga la p\xe1gina.");return}eo(!0)},eD=()=>{eo(!1),ep({shopId:b.length>0?b[0].id:"",name:"",description:"",value:0,height:0,width:0,depth:0,category:"",mainImage:""}),ex([]),eg(null)},eP=async e=>{ev(e),et(null);try{et("Funci\xf3n de pausar sorteo a\xfan no implementada en Firebase")}catch(e){et(e.message||"Error al pausar el sorteo")}finally{ev(null)}},eF=async e=>{eN(e),et(null);try{et("Funci\xf3n de reanudar sorteo a\xfan no implementada en Firebase")}catch(e){et(e.message||"Error al reanudar el sorteo")}finally{eN(null)}},eB=async e=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas enviar este sorteo a aprobaci\xf3n? Una vez enviado, no podr\xe1s editarlo hasta que sea aprobado o rechazado.")){eI(e),et(null);try{let{raffleService:s}=await a.e(31).then(a.bind(a,31)),r=await s.submitForApproval(e),o={...r,createdAt:r.createdAt instanceof Date?r.createdAt.toISOString():r.createdAt,raffleExecutedAt:r.raffleExecutedAt instanceof Date?r.raffleExecutedAt.toISOString():r.raffleExecutedAt};if(S(I.map(t=>t.id===e?o:t)),t?.role==="admin"){let e=await eS();P(e)}}catch(e){et(e.message||"Error al enviar el sorteo a aprobaci\xf3n")}finally{eI(null)}}},eq=async e=>{try{let{doc:t,getDoc:s}=await Promise.resolve().then(a.bind(a,82986)),{db:r}=await Promise.resolve().then(a.bind(a,26379)),o=await s(t(r,"raffles",e));if(!o.exists()){et("Sorteo no encontrado");return}let i=o.data(),n=null;if(i.productId)try{let e=await s(t(r,"products",i.productId));if(e.exists()){let t=e.data();n={id:e.id,name:t.name||"",value:t.value||0}}}catch(e){console.log("Error loading product:",e)}let d={id:o.id,productId:i.productId||"",product:n||void 0,totalTickets:i.totalTickets||0,soldTickets:i.soldTickets||0,status:i.status||"draft",createdAt:i.createdAt?.toDate()?.toISOString()||new Date().toISOString(),productValue:i.productValue||0,winnerTicketId:i.winnerTicketId,raffleExecutedAt:i.raffleExecutedAt?.toDate()?.toISOString()};B(d),z(!0)}catch(e){et(e.message||"Error al cargar detalles del sorteo")}},ez=async e=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas aprobar este sorteo?")){O(e),et(null);try{let{doc:t,updateDoc:s,serverTimestamp:r}=await Promise.resolve().then(a.bind(a,82986)),{db:o}=await Promise.resolve().then(a.bind(a,26379)),i=t(o,"raffles",e);await s(i,{status:"active",updatedAt:r(),activatedAt:r()}),P(D.filter(t=>t.id!==e)),z(!1),B(null);let n=await eS();P(n);let{raffleService:d}=await a.e(31).then(a.bind(a,31)),l=await d.getAllRaffles();S(l.map(e=>({...e,createdAt:e.createdAt instanceof Date?e.createdAt.toISOString():e.createdAt,raffleExecutedAt:e.raffleExecutedAt instanceof Date?e.raffleExecutedAt.toISOString():e.raffleExecutedAt})))}catch(e){et(e.message||"Error al aprobar el sorteo")}finally{O(null)}}},eR=async e=>{if(!G.trim()){et("Por favor ingresa un motivo de rechazo");return}U(e),et(null);try{let{doc:t,updateDoc:s,serverTimestamp:r}=await Promise.resolve().then(a.bind(a,82986)),{db:o}=await Promise.resolve().then(a.bind(a,26379)),i=t(o,"raffles",e);await s(i,{status:"rejected",updatedAt:r(),rejectReason:G.trim()}),P(D.filter(t=>t.id!==e)),L(!1),z(!1),V(""),B(null);let n=await eS();P(n);let{raffleService:d}=await a.e(31).then(a.bind(a,31)),l=await d.getAllRaffles();S(l.map(e=>({...e,createdAt:e.createdAt instanceof Date?e.createdAt.toISOString():e.createdAt,raffleExecutedAt:e.raffleExecutedAt instanceof Date?e.raffleExecutedAt.toISOString():e.raffleExecutedAt})))}catch(e){et(e.message||"Error al rechazar el sorteo")}finally{U(null)}},eL=async t=>{let a=Z[t]||1,s=W.find(e=>e.id===t);if(!s){et("Sorteo no encontrado");return}let r=s.totalTickets-s.soldTickets;if(a>r){et(`Solo hay ${r} tickets disponibles`);return}if(a<1){et("Debes comprar al menos 1 ticket");return}Y(t),et(null);try{let t=s.productValue||s.product?.value||0,r=await l.Z.createPayment({raffleId:s.id,amount:a*t,ticketQuantity:a});e.push(`/checkout?paymentId=${r.id}`)}catch(e){et(e.response?.data?.message||"Error al procesar la compra. Intenta de nuevo."),Y(null)}},eG=async e=>{let t=e.target.files?.[0];if(t){if(!["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(t.type)){et("Tipo de archivo no permitido. Solo se permiten im\xe1genes (JPEG, PNG, WEBP, GIF)");return}if(t.size>5242880){et("El archivo es demasiado grande. M\xe1ximo permitido: 5MB");return}eg(t),et(null),eb(!0);try{let e=await c.T.uploadProductImage(t);ep(t=>({...t,mainImage:e}));let a=e.startsWith("http")?e:`${"http://localhost:3001/api".replace("/api","")||0}${e}`;ep(e=>({...e,mainImage:a}))}catch(e){et(e.response?.data?.message||"Error al subir la imagen"),eg(null)}finally{eb(!1)}}},eV=async e=>{if(e.preventDefault(),et(null),!eh.shopId&&t?.role==="shop")try{let{collection:e,query:s,where:r,getDocs:o}=await Promise.resolve().then(a.bind(a,82986)),{db:i}=await Promise.resolve().then(a.bind(a,26379)),n=e(i,"shops"),d=s(n,r("userId","==",t.id)),l=await o(d);if(l.empty){et("No se encontr\xf3 tu tienda. Por favor, recarga la p\xe1gina.");return}{let e=l.docs[0],a=e.data(),s={id:e.id,userId:a.userId||t.id,name:a.name||"",description:a.description,logo:a.logo,publicEmail:a.publicEmail,phone:a.phone,socialMedia:a.socialMedia,status:a.status||"pending",createdAt:a.createdAt?.toDate()||new Date,updatedAt:a.updatedAt?.toDate()||new Date};y(s),f([s]),ep(e=>({...e,shopId:s.id}))}}catch(e){console.error("Error obteniendo tienda:",e),et("No se pudo obtener la informaci\xf3n de tu tienda. Por favor, recarga la p\xe1gina e intenta nuevamente.");return}if(!eh.shopId){t?.role==="shop"?et("No se pudo asociar tu tienda. Por favor, recarga la p\xe1gina e intenta nuevamente."):et("Por favor selecciona una tienda para crear el producto.");return}let s=ek(eh.height,eh.width,eh.depth);if(s.length>0){ex(s),et("Por favor corrige los errores en las dimensiones");return}if(!eh.name||!eh.description||eh.value<=0){et("Por favor completa todos los campos requeridos");return}el(!0);try{let e=await d._.createProduct(eh);w([...N,e]),eD(),et(null),eg(null)}catch(e){et(e.message||"Error al crear el producto")}finally{el(!1)}},eM=e=>({pending:"#FFA500",verified:"#4CAF50",blocked:"#F44336",active:"#2196F3",paused:"#FF9800",inactive:"#9E9E9E",archived:"#757575",draft:"#FF9800",pending_approval:"#FFC107",sold_out:"#9C27B0",finished:"#4CAF50",cancelled:"#F44336",rejected:"#F44336",sold:"#2196F3",winner:"#FFD700",refunded:"#9E9E9E",held:"#FF9800",released:"#4CAF50",executed:"#F44336"})[e]||"#757575";return!x||g?s.jsx("div",{className:p().dashboard,children:s.jsx("div",{className:p().loadingContainer,children:s.jsx("p",{children:"Cargando..."})})}):t?(0,s.jsxs)("div",{className:p().dashboard,children:[s.jsx("div",{className:p().header,children:(0,s.jsxs)("div",{className:p().headerContent,children:[(0,s.jsxs)("div",{className:p().headerTitle,children:[s.jsx(u.Z,{size:"small",showText:!1}),s.jsx("h1",{children:"Dashboard"})]}),(0,s.jsxs)("div",{className:p().userSection,children:[(0,s.jsxs)("div",{className:p().userInfo,children:[s.jsx("div",{className:p().userAvatar,children:s.jsx(i.fzv,{})}),(0,s.jsxs)("div",{className:p().userDetails,children:[s.jsx("p",{className:p().userName,children:t.name}),s.jsx("p",{className:p().email,children:t.email}),s.jsx("span",{className:p().role,children:t.role})]})]}),(0,s.jsxs)("button",{onClick:eC,className:p().logoutBtn,children:[s.jsx(i.xqh,{className:p().logoutIcon}),"Cerrar Sesi\xf3n"]})]})]})}),ee&&s.jsx("div",{className:p().errorBanner,children:ee}),s.jsx("div",{className:p().tabsContainer,children:"user"===t.role?(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{className:`${p().tab} ${"overview"===E?p().activeTab:""}`,onClick:()=>T("overview"),children:"Resumen"}),(0,s.jsxs)("button",{className:`${p().tab} ${"raffles"===E?p().activeTab:""}`,onClick:()=>T("raffles"),children:["Sorteos Disponibles (",W.length,")"]}),(0,s.jsxs)("button",{className:`${p().tab} ${"tickets"===E?p().activeTab:""}`,onClick:()=>T("tickets"),children:["Mis Tickets (",X.length,")"]})]}):"admin"===t.role?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{className:`${p().tab} ${"pending"===E?p().activeTab:""}`,onClick:()=>T("pending"),children:[s.jsx(i.TCC,{className:p().tabIcon}),"Sorteos Pendientes (",D.length,")"]}),(0,s.jsxs)("button",{className:`${p().tab} ${"overview"===E?p().activeTab:""}`,onClick:()=>T("overview"),children:[s.jsx(i.orK,{className:p().tabIcon}),"Resumen"]}),(0,s.jsxs)("button",{className:`${p().tab} ${"raffles"===E?p().activeTab:""}`,onClick:()=>T("raffles"),children:[s.jsx(i.KCr,{className:p().tabIcon}),"Todos los Sorteos (",I.length,")"]})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{className:`${p().tab} ${"overview"===E?p().activeTab:""}`,onClick:()=>T("overview"),children:"Resumen"}),(0,s.jsxs)("button",{className:`${p().tab} ${"products"===E?p().activeTab:""}`,onClick:()=>T("products"),children:["Productos (",N.length,")"]}),(0,s.jsxs)("button",{className:`${p().tab} ${"raffles"===E?p().activeTab:""}`,onClick:()=>T("raffles"),children:["Sorteos (",I.length,")"]}),(0,s.jsxs)("button",{className:`${p().tab} ${"tickets"===E?p().activeTab:""}`,onClick:()=>T("tickets"),children:["Tickets (",C.length,")"]}),(0,s.jsxs)("button",{className:`${p().tab} ${"deposits"===E?p().activeTab:""}`,onClick:()=>T("deposits"),children:["Dep\xf3sitos (",A.length,")"]})]})}),(0,s.jsxs)("div",{className:p().content,children:["pending"===E&&"admin"===t.role&&(0,s.jsxs)("div",{className:p().tableContainer,children:[s.jsx("div",{className:p().tableHeader,children:s.jsx("h2",{children:"Sorteos Pendientes de Aprobaci\xf3n"})}),0===D.length?s.jsx("p",{className:p().emptyMessage,children:"No hay sorteos pendientes de aprobaci\xf3n"}):(0,s.jsxs)("table",{className:p().table,children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"Tienda"}),s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Valor"}),s.jsx("th",{children:"Total Tickets"}),s.jsx("th",{children:"Requiere Dep\xf3sito"}),s.jsx("th",{children:"Fecha Creaci\xf3n"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:D.map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{children:e.shop?.name||"N/A"}),s.jsx("td",{children:s.jsx("strong",{children:e.product?.name||"Producto desconocido"})}),(0,s.jsxs)("td",{children:["S/. ",(e.productValue||e.product?.value||0).toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("td",{children:e.totalTickets.toLocaleString()}),s.jsx("td",{children:e.requiresDeposit?s.jsx("span",{className:p().badge,style:{backgroundColor:"#FF9800"},children:"S\xed"}):s.jsx("span",{className:p().badge,style:{backgroundColor:"#4CAF50"},children:"No"})}),s.jsx("td",{children:new Date(e.createdAt).toLocaleDateString("es-PE",{year:"numeric",month:"short",day:"numeric"})}),s.jsx("td",{children:s.jsx("div",{style:{display:"flex",gap:"8px"},children:s.jsx("button",{className:p().createBtn,onClick:()=>eq(e.id),style:{padding:"6px 12px",fontSize:"12px"},children:"Ver Detalles"})})})]},e.id))})]})]}),"products"===E&&"shop"===t.role&&(0,s.jsxs)("div",{className:p().tableContainer,children:[(0,s.jsxs)("div",{className:p().tableHeader,children:[s.jsx("h2",{children:"Productos"}),s.jsx("button",{className:p().createBtn,onClick:eT,children:"Crear Producto"})]}),0===N.length?s.jsx("p",{className:p().emptyMessage,children:"No hay productos creados"}):(0,s.jsxs)("table",{className:p().table,children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"Nombre"}),s.jsx("th",{children:"Valor"}),s.jsx("th",{children:"Dimensiones"}),s.jsx("th",{children:"Requiere Dep\xf3sito"}),s.jsx("th",{children:"Estado"})]})}),s.jsx("tbody",{children:N.map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{children:s.jsx("strong",{children:e.name})}),(0,s.jsxs)("td",{children:["S/. ",e.value.toLocaleString()]}),(0,s.jsxs)("td",{children:[e.height,"\xd7",e.width,"\xd7",e.depth," cm"]}),s.jsx("td",{children:e.requiresDeposit?s.jsx("span",{className:p().badge,style:{backgroundColor:"#FF9800"},children:"S\xed"}):s.jsx("span",{className:p().badge,style:{backgroundColor:"#4CAF50"},children:"No"})}),s.jsx("td",{children:s.jsx("span",{className:p().badge,style:{backgroundColor:eM(e.status)},children:e.status})})]},e.id))})]})]}),"overview"===E&&s.jsx("div",{className:p().overviewGrid,children:"user"===t.role?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.KCr,{})}),s.jsx("h3",{children:"Sorteos Disponibles"}),s.jsx("p",{className:p().bigNumber,children:W.length}),s.jsx("p",{className:p().subtitle,children:"Sorteos activos para participar"})]}),(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.E25,{})}),s.jsx("h3",{children:"Mis Tickets"}),s.jsx("p",{className:p().bigNumber,children:X.length}),s.jsx("p",{className:p().subtitle,children:"Tickets comprados"}),s.jsx("div",{className:p().statusBreakdown,children:X.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:["Vendidos: ",X.filter(e=>"sold"===e.status).length]}),(0,s.jsxs)("span",{children:["Ganadores: ",X.filter(e=>"winner"===e.status).length]})]})})]}),(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.HR2,{})}),s.jsx("h3",{children:"Sorteos Participados"}),s.jsx("p",{className:p().bigNumber,children:new Set(X.map(e=>e.raffleId)).size}),s.jsx("p",{className:p().subtitle,children:"Diferentes sorteos"})]})]}):"admin"===t.role?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.TCC,{})}),s.jsx("h3",{children:"Sorteos Pendientes"}),s.jsx("p",{className:p().bigNumber,children:D.length}),s.jsx("p",{className:p().subtitle,children:"Esperando aprobaci\xf3n"})]}),(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.KCr,{})}),s.jsx("h3",{children:"Sorteos Activos"}),s.jsx("p",{className:p().bigNumber,children:I.filter(e=>"active"===e.status).length}),s.jsx("p",{className:p().subtitle,children:"Sorteos en curso"})]}),(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i._rq,{})}),s.jsx("h3",{children:"Sorteos Finalizados"}),s.jsx("p",{className:p().bigNumber,children:I.filter(e=>"finished"===e.status).length}),s.jsx("p",{className:p().subtitle,children:"Sorteos completados"})]}),(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.x8h,{})}),s.jsx("h3",{children:"Total Sorteos"}),s.jsx("p",{className:p().bigNumber,children:I.length}),s.jsx("p",{className:p().subtitle,children:"Todos los sorteos"}),(0,s.jsxs)("div",{className:p().statusBreakdown,children:[(0,s.jsxs)("span",{children:["Pendientes: ",D.length]}),(0,s.jsxs)("span",{children:["Activos: ",I.filter(e=>"active"===e.status).length]}),(0,s.jsxs)("span",{children:["Finalizados: ",I.filter(e=>"finished"===e.status).length]})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.zFh,{})}),s.jsx("h3",{children:"Productos"}),s.jsx("p",{className:p().bigNumber,children:N.length}),s.jsx("p",{className:p().subtitle,children:"Total de productos"}),s.jsx("div",{className:p().statusBreakdown,children:N.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:["Activos: ",N.filter(e=>"active"===e.status).length]}),(0,s.jsxs)("span",{children:["Inactivos: ",N.filter(e=>"inactive"===e.status).length]}),(0,s.jsxs)("span",{children:["Con dep\xf3sito: ",N.filter(e=>e.requiresDeposit).length]})]})})]}),(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.KCr,{})}),s.jsx("h3",{children:"Sorteos"}),s.jsx("p",{className:p().bigNumber,children:I.length}),s.jsx("p",{className:p().subtitle,children:"Total de sorteos"}),s.jsx("div",{className:p().statusBreakdown,children:I.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:["Activos: ",I.filter(e=>"active"===e.status).length]}),(0,s.jsxs)("span",{children:["Pausados: ",I.filter(e=>"paused"===e.status).length]}),(0,s.jsxs)("span",{children:["Finalizados: ",I.filter(e=>"finished"===e.status).length]}),(0,s.jsxs)("span",{children:["Tickets vendidos: ",I.reduce((e,t)=>e+t.soldTickets,0).toLocaleString()]})]})})]}),(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.E25,{})}),s.jsx("h3",{children:"Tickets"}),s.jsx("p",{className:p().bigNumber,children:C.length}),s.jsx("p",{className:p().subtitle,children:"Total de tickets"}),s.jsx("div",{className:p().statusBreakdown,children:C.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:["Vendidos: ",C.filter(e=>"sold"===e.status).length]}),(0,s.jsxs)("span",{children:["Ganadores: ",C.filter(e=>"winner"===e.status).length]}),(0,s.jsxs)("span",{children:["Reembolsados: ",C.filter(e=>"refunded"===e.status).length]})]})})]}),(0,s.jsxs)("div",{className:p().card,children:[s.jsx("div",{className:p().cardIcon,children:s.jsx(i.oQC,{})}),s.jsx("h3",{children:"Dep\xf3sitos"}),s.jsx("p",{className:p().bigNumber,children:A.length}),s.jsx("p",{className:p().subtitle,children:"Total de dep\xf3sitos"}),s.jsx("div",{className:p().statusBreakdown,children:A.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:["Retenidos: ",A.filter(e=>"held"===e.status).length]}),(0,s.jsxs)("span",{children:["Liberados: ",A.filter(e=>"released"===e.status).length]}),(0,s.jsxs)("span",{children:["Monto total: $",A.reduce((e,t)=>e+t.amount,0).toLocaleString()]})]})})]})]})}),"raffles"===E&&(0,s.jsxs)("div",{className:p().tableContainer,children:[(0,s.jsxs)("div",{className:p().tableHeader,children:[s.jsx("h2",{children:"user"===t.role?"Sorteos Disponibles":"Sorteos"}),"user"!==t.role&&s.jsx("button",{className:p().createBtn,onClick:()=>{v?eu(e=>({...e,shopId:v.id})):b.length>0&&eu(e=>({...e,shopId:b[0].id})),es(!0)},children:"Crear Sorteo"})]}),"user"===t.role?0===W.length?s.jsx("p",{className:p().emptyMessage,children:"No hay sorteos disponibles en este momento"}):s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"20px",marginTop:"20px"},children:W.map(e=>{let t=e.totalTickets-e.soldTickets,a=e.totalTickets>0?e.soldTickets/e.totalTickets*100:0,r=e.product?.name||N.find(t=>t.id===e.productId)?.name||"Producto desconocido",o=e.productValue||e.product?.value||N.find(t=>t.id===e.productId)?.value||0,i=Z[e.id]||1,n=i*o,d="active"===e.status&&t>0;return(0,s.jsxs)("div",{style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"20px",backgroundColor:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",opacity:"cancelled"===e.status||"finished"===e.status?.8:1},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"10px"},children:[s.jsx("h3",{style:{marginTop:0,marginBottom:"10px",color:"#333",flex:1},children:r}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"5px",alignItems:"flex-end"},children:[s.jsx("span",{className:p().badge,style:{backgroundColor:eM(e.status),fontSize:"12px",padding:"4px 8px",borderRadius:"4px",color:"#fff",fontWeight:"bold"},children:{active:"Activo",paused:"Pausado",sold_out:"Agotado",finished:"Finalizado",cancelled:"Cancelado",pending_approval:"Pendiente de Aprobaci\xf3n"}[e.status]||e.status}),"finished"===e.status&&e.winnerTicketId&&s.jsx("div",{style:{fontSize:"11px",color:"#666",marginTop:"4px"},children:X.some(t=>t.raffleId===e.id&&t.id===e.winnerTicketId)?s.jsx("span",{style:{padding:"2px 6px",backgroundColor:"#4CAF50",color:"#fff",borderRadius:"4px",fontWeight:"bold"},children:"\uD83C\uDFC6 Ganaste!"}):s.jsx("span",{style:{color:"#999"},children:"Finalizado"})})]})]}),(0,s.jsxs)("p",{style:{fontSize:"18px",fontWeight:"bold",color:"#1976d2",margin:"10px 0"},children:["S/. ",o.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]}),(0,s.jsxs)("div",{style:{margin:"15px 0"},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px",fontSize:"14px"},children:[s.jsx("span",{children:"Tickets disponibles:"}),(0,s.jsxs)("strong",{style:{color:t>0?"#4CAF50":"#F44336"},children:[t.toLocaleString()," / ",e.totalTickets.toLocaleString()]})]}),s.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"#e0e0e0",borderRadius:"4px",overflow:"hidden",marginTop:"5px"},children:s.jsx("div",{style:{width:`${a}%`,height:"100%",backgroundColor:a>=100?"#4CAF50":"#2196F3",transition:"width 0.3s ease"}})}),(0,s.jsxs)("p",{style:{fontSize:"12px",color:"#666",marginTop:"5px"},children:[Math.round(a),"% vendido"]})]}),d&&(0,s.jsxs)("div",{style:{marginTop:"20px"},children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Cantidad de tickets:"}),(0,s.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[s.jsx("button",{onClick:()=>Q({...Z,[e.id]:Math.max(1,i-1)}),disabled:i<=1,className:p().quantityBtn,children:"-"}),s.jsx("input",{type:"number",min:"1",max:t,value:i,onChange:a=>{let s=parseInt(a.target.value)||1;Q({...Z,[e.id]:Math.max(1,Math.min(s,t))})},style:{width:"70px",padding:"8px",border:"2px solid #e0e0e0",borderRadius:"6px",textAlign:"center",fontSize:"14px",fontWeight:"600"}}),s.jsx("button",{onClick:()=>Q({...Z,[e.id]:Math.min(t,i+1)}),disabled:i>=t,className:p().quantityBtn,children:"+"})]}),(0,s.jsxs)("p",{style:{fontSize:"14px",marginTop:"10px",fontWeight:"bold"},children:["Total: S/. ",n.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("button",{onClick:()=>eL(e.id),disabled:J===e.id||0===t,className:p().buyTicketsBtn,children:J===e.id?"Procesando...":"Comprar Tickets"})]}),!d&&(0,s.jsxs)("div",{style:{marginTop:"20px",padding:"12px",backgroundColor:"#f5f5f5",borderRadius:"4px",textAlign:"center",color:"#666",fontSize:"14px"},children:["sold_out"===e.status&&"Este sorteo est\xe1 agotado","finished"===e.status&&"Este sorteo ha finalizado","cancelled"===e.status&&"Este sorteo ha sido cancelado","paused"===e.status&&"Este sorteo est\xe1 pausado","pending_approval"===e.status&&"Este sorteo est\xe1 pendiente de aprobaci\xf3n","active"!==e.status&&"sold_out"!==e.status&&"finished"!==e.status&&"cancelled"!==e.status&&"pending_approval"!==e.status&&"paused"!==e.status&&"No disponible para compra"]})]},e.id)})}):0===I.length?s.jsx("p",{className:p().emptyMessage,children:"No hay sorteos creados"}):(0,s.jsxs)("table",{className:p().table,children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Valor"}),s.jsx("th",{children:"Total Tickets"}),s.jsx("th",{children:"Vendidos"}),s.jsx("th",{children:"Disponibles"}),s.jsx("th",{children:"Progreso"}),s.jsx("th",{children:"Estado"}),s.jsx("th",{children:"Acciones"}),s.jsx("th",{children:"Fecha Creaci\xf3n"})]})}),s.jsx("tbody",{children:I.map(e=>{let a=e.totalTickets>0?e.soldTickets/e.totalTickets*100:0,r=e.totalTickets-e.soldTickets,o=e.product?.name||N.find(t=>t.id===e.productId)?.name||"Producto desconocido",n=e.productValue||e.product?.value||N.find(t=>t.id===e.productId)?.value||0;return(0,s.jsxs)("tr",{children:[s.jsx("td",{children:s.jsx("strong",{children:o})}),(0,s.jsxs)("td",{children:["S/. ",n.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("td",{children:e.totalTickets.toLocaleString()}),s.jsx("td",{children:e.soldTickets.toLocaleString()}),s.jsx("td",{children:s.jsx("span",{style:{color:r>0?"#4CAF50":"#F44336",fontWeight:"bold"},children:r.toLocaleString()})}),s.jsx("td",{children:(0,s.jsxs)("div",{className:p().progressBar,children:[s.jsx("div",{className:p().progressFill,style:{width:`${a}%`}}),(0,s.jsxs)("span",{className:p().progressText,children:[Math.round(a),"%"]})]})}),s.jsx("td",{children:s.jsx("span",{className:p().badge,style:{backgroundColor:eM(e.status)},children:{draft:"Borrador",pending_approval:"Pendiente de Aprobaci\xf3n",active:"Activo",paused:"Pausado",sold_out:"Agotado",finished:"Finalizado",cancelled:"Cancelado",rejected:"Rechazado"}[e.status]||e.status})}),s.jsx("td",{children:(0,s.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",alignItems:"center"},children:["draft"===e.status&&"shop"===t.role&&s.jsx("button",{className:p().createBtn,onClick:()=>eB(e.id),disabled:ew===e.id,style:{padding:"6px 12px",fontSize:"12px",background:"linear-gradient(135deg, #4CAF50 0%, #388E3C 100%)",whiteSpace:"nowrap"},title:"Enviar este sorteo a aprobaci\xf3n para que los usuarios puedan comprar tickets",children:ew===e.id?"Enviando...":(0,s.jsxs)(s.Fragment,{children:[s.jsx(i._rq,{style:{marginRight:"4px"}}),"Enviar a Aprobaci\xf3n"]})}),"active"===e.status&&"shop"===t.role&&s.jsx("button",{className:p().cancelBtn,onClick:()=>eP(e.id),disabled:ef===e.id,style:{padding:"6px 12px",fontSize:"12px",backgroundColor:"#FF9800",color:"white",borderColor:"#FF9800",whiteSpace:"nowrap"},children:ef===e.id?"Pausando...":(0,s.jsxs)(s.Fragment,{children:[s.jsx(i.R4s,{style:{marginRight:"4px"}}),"Pausar"]})}),"paused"===e.status&&"shop"===t.role&&s.jsx("button",{className:p().submitBtn,onClick:()=>eF(e.id),disabled:ey===e.id,style:{padding:"6px 12px",fontSize:"12px",whiteSpace:"nowrap"},children:ey===e.id?"Reanudando...":(0,s.jsxs)(s.Fragment,{children:[s.jsx(i.BVE,{style:{marginRight:"4px"}}),"Reanudar"]})}),"pending_approval"===e.status&&"shop"===t.role&&s.jsx("span",{style:{fontSize:"12px",color:"#FF9800",fontStyle:"italic",whiteSpace:"nowrap"},children:"⏳ Esperando aprobaci\xf3n"})]})}),s.jsx("td",{children:new Date(e.createdAt).toLocaleDateString("es-PE",{year:"numeric",month:"short",day:"numeric"})})]},e.id)})})]})]}),"tickets"===E&&(0,s.jsxs)("div",{className:p().tableContainer,children:[s.jsx("h2",{children:"user"===t.role?"Mis Tickets":"Tickets"}),"user"===t.role?0===X.length?s.jsx("p",{className:p().emptyMessage,children:"No has comprado tickets a\xfan. \xa1Participa en los sorteos disponibles!"}):(0,s.jsxs)("table",{className:p().table,children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"N\xfamero de Ticket"}),s.jsx("th",{children:"Producto del Sorteo"}),s.jsx("th",{children:"Valor del Producto"}),s.jsx("th",{children:"Estado"}),s.jsx("th",{children:"Fecha de Compra"})]})}),s.jsx("tbody",{children:X.map(e=>{let t=I.find(t=>t.id===e.raffleId),a=t?.product?.name||N.find(e=>e.id===t?.productId)?.name||"Producto desconocido",r=t?.productValue||t?.product?.value||N.find(e=>e.id===t?.productId)?.value||0,o=t?.status==="finished"&&t?.winnerTicketId===e.id,i=t?.status==="finished";return(0,s.jsxs)("tr",{style:{backgroundColor:o?"#e8f5e9":"transparent"},children:[(0,s.jsxs)("td",{children:[(0,s.jsxs)("strong",{children:["#",e.number]}),o&&s.jsx("span",{style:{marginLeft:"8px",padding:"2px 8px",backgroundColor:"#4CAF50",color:"#fff",borderRadius:"4px",fontSize:"11px",fontWeight:"bold"},children:"\uD83C\uDFC6 GANADOR"})]}),s.jsx("td",{children:a}),(0,s.jsxs)("td",{children:["S/. ",r.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("td",{children:o?s.jsx("span",{className:p().badge,style:{backgroundColor:"#4CAF50",color:"#fff",fontWeight:"bold"},children:"\uD83C\uDFC6 Ganador"}):i?s.jsx("span",{className:p().badge,style:{backgroundColor:"#9E9E9E",color:"#fff"},children:"Finalizado"}):s.jsx("span",{className:p().badge,style:{backgroundColor:eM(e.status)},children:"sold"===e.status?"Comprado":"winner"===e.status?"Ganador":e.status})}),s.jsx("td",{children:e.purchasedAt?new Date(e.purchasedAt).toLocaleDateString("es-PE",{year:"numeric",month:"short",day:"numeric"}):"-"})]},e.id)})})]}):0===C.length?s.jsx("p",{className:p().emptyMessage,children:"No hay tickets creados"}):(0,s.jsxs)("table",{className:p().table,children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"N\xfamero"}),s.jsx("th",{children:"Sorteo ID"}),s.jsx("th",{children:"Estado"})]})}),s.jsx("tbody",{children:C.slice(0,50).map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{children:(0,s.jsxs)("strong",{children:["#",e.number]})}),(0,s.jsxs)("td",{children:[e.raffleId.substring(0,8),"..."]}),s.jsx("td",{children:s.jsx("span",{className:p().badge,style:{backgroundColor:eM(e.status)},children:e.status})})]},e.id))})]}),"user"!==t.role&&C.length>50&&(0,s.jsxs)("p",{className:p().moreItems,children:["... y ",C.length-50," m\xe1s"]})]}),"deposits"===E&&"user"!==t.role&&(0,s.jsxs)("div",{className:p().tableContainer,children:[s.jsx("h2",{children:"Dep\xf3sitos"}),0===A.length?s.jsx("p",{className:p().emptyMessage,children:"No hay dep\xf3sitos creados"}):(0,s.jsxs)("table",{className:p().table,children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"Monto"}),s.jsx("th",{children:"Sorteo ID"}),s.jsx("th",{children:"Estado"})]})}),s.jsx("tbody",{children:A.map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{children:(0,s.jsxs)("strong",{children:["$",e.amount.toLocaleString()]})}),(0,s.jsxs)("td",{children:[e.raffleId.substring(0,8),"..."]}),s.jsx("td",{children:s.jsx("span",{className:p().badge,style:{backgroundColor:eM(e.status)},children:e.status})})]},e.id))})]})]}),ea&&s.jsx("div",{className:p().modalOverlay,onClick:e_,children:(0,s.jsxs)("div",{className:p().modal,onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:p().modalHeader,children:[s.jsx("h2",{children:"Crear Nuevo Sorteo"}),s.jsx("button",{className:p().closeBtn,onClick:e_,children:"\xd7"})]}),(0,s.jsxs)("form",{onSubmit:eA,className:p().form,children:[v?(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Tienda"}),s.jsx("div",{style:{padding:"10px",backgroundColor:"#f5f5f5",borderRadius:"4px",color:"#666"},children:s.jsx("strong",{children:v.name})})]}):(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"shopId",children:"Tienda *"}),(0,s.jsxs)("select",{id:"shopId",value:ec.shopId,onChange:e=>eu({...ec,shopId:e.target.value}),required:!0,className:p().input,children:[s.jsx("option",{value:"",children:"Selecciona una tienda"}),b.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"productId",children:"Producto *"}),(0,s.jsxs)("select",{id:"productId",value:ec.productId,onChange:e=>{eu({...ec,productId:e.target.value})},required:!0,className:p().input,children:[s.jsx("option",{value:"",children:"Selecciona un producto"}),N.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," - S/. ",e.value.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]},e.id))]})]}),ec.productId&&(()=>{let e=N.find(e=>e.id===ec.productId),t=e?Math.floor(2*e.value):0;return s.jsx("div",{className:p().formGroup,children:(0,s.jsxs)("div",{style:{padding:"12px",backgroundColor:"#e3f2fd",borderRadius:"8px",fontSize:"14px",color:"#1976d2",border:"1px solid #90caf9"},children:[s.jsx("div",{style:{marginBottom:"8px",fontWeight:"600"},children:"\uD83D\uDCCA Informaci\xf3n del Sorteo"}),e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{style:{marginBottom:"4px"},children:[s.jsx("strong",{children:"Producto:"})," ",e.name]}),(0,s.jsxs)("div",{style:{marginBottom:"4px"},children:[s.jsx("strong",{children:"Valor del producto:"})," S/. ",e.value.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]}),(0,s.jsxs)("div",{style:{marginTop:"8px",padding:"8px",backgroundColor:"#fff",borderRadius:"4px",border:"1px solid #90caf9"},children:[s.jsx("strong",{children:"\uD83C\uDFAB Tickets autom\xe1ticos:"})," ",t.toLocaleString()," tickets",(0,s.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:["(Valor \xd7 2 = ",e.value.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})," \xd7 2)"]})]})]})]})})})(),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"specialConditions",children:"Condiciones Especiales"}),s.jsx("textarea",{id:"specialConditions",value:ec.specialConditions,onChange:e=>eu({...ec,specialConditions:e.target.value}),placeholder:"Ingresa condiciones especiales del sorteo (opcional)",className:p().textarea,rows:4})]}),(0,s.jsxs)("div",{className:p().formActions,children:[s.jsx("button",{type:"button",onClick:e_,className:p().cancelBtn,children:"Cancelar"}),s.jsx("button",{type:"submit",disabled:ei,className:p().submitBtn,children:ei?"Creando...":"Crear Sorteo"})]})]})]})}),er&&s.jsx("div",{className:p().modalOverlay,onClick:eD,children:(0,s.jsxs)("div",{className:p().modal,onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:p().modalHeader,children:[s.jsx("h2",{children:"Crear Nuevo Producto"}),s.jsx("button",{className:p().closeBtn,onClick:eD,children:"\xd7"})]}),(0,s.jsxs)("form",{onSubmit:eV,className:p().form,children:[v&&(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Tienda"}),s.jsx("div",{style:{padding:"10px",backgroundColor:"#f5f5f5",borderRadius:"4px",color:"#666"},children:s.jsx("strong",{children:v.name})})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"productName",children:"Nombre del Producto *"}),s.jsx("input",{type:"text",id:"productName",value:eh.name,onChange:e=>ep({...eh,name:e.target.value}),required:!0,className:p().input,placeholder:"Ej: iPhone 15 Pro Max"})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"productDescription",children:"Descripci\xf3n *"}),s.jsx("textarea",{id:"productDescription",value:eh.description,onChange:e=>ep({...eh,description:e.target.value}),required:!0,className:p().textarea,rows:4,placeholder:"Describe el producto en detalle..."})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"productValue",children:"Valor del Producto (S/.) *"}),s.jsx("input",{type:"number",id:"productValue",step:"0.01",min:"0.01",value:eh.value||"",onChange:e=>ep({...eh,value:parseFloat(e.target.value)||0}),required:!0,className:p().input,placeholder:"0.00"})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"productCategory",children:"Categor\xeda (opcional)"}),s.jsx("input",{type:"text",id:"productCategory",value:eh.category,onChange:e=>ep({...eh,category:e.target.value}),className:p().input,placeholder:"Ej: Electr\xf3nica, Ropa, Hogar..."})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"productMainImage",children:"Imagen Principal (opcional)"}),(0,s.jsxs)("div",{style:{marginBottom:"10px"},children:[s.jsx("input",{type:"file",id:"productImageFile",accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:eG,className:p().input,style:{marginBottom:"10px"},disabled:ej}),ej&&s.jsx("p",{style:{fontSize:"12px",color:"#666",marginTop:"5px"},children:"Subiendo imagen..."}),eh.mainImage&&!ej&&s.jsx("div",{style:{marginTop:"10px"},children:s.jsx("img",{src:eh.mainImage,alt:"Preview",style:{maxWidth:"200px",maxHeight:"200px",borderRadius:"4px",border:"1px solid #ddd"}})})]}),s.jsx("small",{style:{display:"block",marginTop:"5px",color:"#666",fontSize:"12px"},children:"O ingresa una URL de imagen:"}),s.jsx("input",{type:"url",id:"productMainImage",value:eh.mainImage,onChange:e=>ep({...eh,mainImage:e.target.value}),className:p().input,placeholder:"https://ejemplo.com/imagen.jpg",style:{marginTop:"5px"}})]}),(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[s.jsx("h3",{style:{marginBottom:"10px",fontSize:"16px"},children:"Dimensiones (en cent\xedmetros) *"}),s.jsx("p",{style:{fontSize:"12px",color:"#666",marginBottom:"15px"},children:"M\xe1ximo permitido: 15cm por cada dimensi\xf3n. Si alguna dimensi\xf3n excede este l\xedmite, se requerir\xe1 un dep\xf3sito de garant\xeda."}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:[(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"productHeight",children:"Altura (cm)"}),s.jsx("input",{type:"number",id:"productHeight",step:"0.1",min:"0.1",max:"15",value:eh.height||"",onChange:e=>eE("height",e.target.value),required:!0,className:p().input})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"productWidth",children:"Ancho (cm)"}),s.jsx("input",{type:"number",id:"productWidth",step:"0.1",min:"0.1",max:"15",value:eh.width||"",onChange:e=>eE("width",e.target.value),required:!0,className:p().input})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{htmlFor:"productDepth",children:"Profundidad (cm)"}),s.jsx("input",{type:"number",id:"productDepth",step:"0.1",min:"0.1",max:"15",value:eh.depth||"",onChange:e=>eE("depth",e.target.value),required:!0,className:p().input})]})]}),em.length>0&&(0,s.jsxs)("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#ffebee",borderRadius:"4px",color:"#c62828"},children:[s.jsx("strong",{children:"Errores en las dimensiones:"}),s.jsx("ul",{style:{margin:"10px 0 0 20px"},children:em.map((e,t)=>s.jsx("li",{children:e},t))})]}),(eh.height>15||eh.width>15||eh.depth>15)&&0===em.length&&(0,s.jsxs)("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#fff3cd",borderRadius:"4px",color:"#856404"},children:["⚠️ Este producto requiere un dep\xf3sito de garant\xeda porque excede las dimensiones m\xe1ximas permitidas (15\xd715\xd715 cm).",s.jsx("br",{}),s.jsx("strong",{children:"Dep\xf3sito requerido:"})," S/. ",eh.value.toFixed(2)]}),eh.height>0&&eh.width>0&&eh.depth>0&&eh.height<=15&&eh.width<=15&&eh.depth<=15&&s.jsx("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#d4edda",borderRadius:"4px",color:"#155724"},children:"✓ Este producto no requiere dep\xf3sito de garant\xeda."})]}),(0,s.jsxs)("div",{className:p().formActions,children:[s.jsx("button",{type:"button",onClick:eD,className:p().cancelBtn,children:"Cancelar"}),s.jsx("button",{type:"submit",disabled:ed,className:p().submitBtn,children:ed?"Creando...":"Crear Producto"})]})]})]})}),q&&F&&"admin"===t.role&&s.jsx("div",{className:p().modalOverlay,onClick:()=>{z(!1),B(null)},children:(0,s.jsxs)("div",{className:p().modal,onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:p().modalHeader,children:[s.jsx("h2",{children:"Detalles del Sorteo"}),s.jsx("button",{className:p().closeBtn,onClick:()=>{z(!1),B(null)},children:"\xd7"})]}),(0,s.jsxs)("div",{className:p().form,style:{padding:"24px"},children:[(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Tienda"}),s.jsx("p",{style:{margin:"8px 0",color:"#333",fontSize:"16px",fontWeight:"600"},children:F.shop?.name||"N/A"})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Producto"}),s.jsx("p",{style:{margin:"8px 0",color:"#333",fontSize:"16px",fontWeight:"600"},children:F.product?.name||"Producto desconocido"})]}),F.product?.description&&(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Descripci\xf3n"}),s.jsx("p",{style:{margin:"8px 0",color:"#666",fontSize:"14px"},children:F.product.description})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Valor del Producto"}),(0,s.jsxs)("p",{style:{margin:"8px 0",color:"#333",fontSize:"18px",fontWeight:"600"},children:["S/. ",(F.productValue||F.product?.value||0).toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Total de Tickets"}),s.jsx("p",{style:{margin:"8px 0",color:"#333",fontSize:"16px"},children:F.totalTickets.toLocaleString()})]}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Requiere Dep\xf3sito"}),s.jsx("p",{style:{margin:"8px 0"},children:F.requiresDeposit?s.jsx("span",{className:p().badge,style:{backgroundColor:"#FF9800"},children:"S\xed"}):s.jsx("span",{className:p().badge,style:{backgroundColor:"#4CAF50"},children:"No"})})]}),F.specialConditions&&(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Condiciones Especiales"}),s.jsx("p",{style:{margin:"8px 0",color:"#666",fontSize:"14px"},children:F.specialConditions})]}),(0,s.jsxs)("div",{className:p().formActions,children:[s.jsx("button",{className:p().cancelBtn,onClick:()=>{z(!1),B(null)},disabled:M===F.id||$===F.id,children:"Cerrar"}),(0,s.jsxs)("button",{className:p().cancelBtn,onClick:()=>L(!0),disabled:M===F.id||$===F.id,style:{backgroundColor:"#F44336",color:"white",borderColor:"#F44336"},children:[s.jsx(i.$Rx,{style:{marginRight:"6px"}}),"Rechazar"]}),s.jsx("button",{className:p().submitBtn,onClick:()=>ez(F.id),disabled:M===F.id||$===F.id,children:M===F.id?"Procesando...":(0,s.jsxs)(s.Fragment,{children:[s.jsx(i._rq,{style:{marginRight:"6px"}}),"Aprobar"]})})]})]})]})}),R&&F&&"admin"===t.role&&s.jsx("div",{className:p().modalOverlay,onClick:()=>{L(!1),V("")},children:(0,s.jsxs)("div",{className:p().modal,onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:p().modalHeader,children:[s.jsx("h2",{children:"Rechazar Sorteo"}),s.jsx("button",{className:p().closeBtn,onClick:()=>{L(!1),V("")},children:"\xd7"})]}),(0,s.jsxs)("div",{className:p().form,style:{padding:"24px"},children:[s.jsx("p",{style:{color:"#666",marginBottom:"20px",fontSize:"14px"},children:"Por favor, proporciona un motivo para rechazar este sorteo. La tienda podr\xe1 ver este motivo."}),(0,s.jsxs)("div",{className:p().formGroup,children:[s.jsx("label",{children:"Motivo del Rechazo *"}),s.jsx("textarea",{className:p().textarea,value:G,onChange:e=>V(e.target.value),placeholder:"Ingresa el motivo del rechazo...",disabled:$===F.id,rows:4})]}),(0,s.jsxs)("div",{className:p().formActions,children:[s.jsx("button",{className:p().cancelBtn,onClick:()=>{L(!1),V("")},disabled:$===F.id,children:"Cancelar"}),s.jsx("button",{className:p().submitBtn,onClick:()=>eR(F.id),disabled:$===F.id||!G.trim(),style:{backgroundColor:"#F44336",borderColor:"#F44336"},children:$===F.id?"Procesando...":(0,s.jsxs)(s.Fragment,{children:[s.jsx(i.$Rx,{style:{marginRight:"6px"}}),"Confirmar Rechazo"]})})]})]})]})})]})]}):s.jsx("div",{className:p().dashboard,children:s.jsx("div",{className:p().errorContainer,children:s.jsx("p",{children:"No autenticado"})})})}},43993:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var s=a(19899),r=a(18154),o=a(54175);let i={src:"/_next/static/media/logo.4501bff6.png",height:1080,width:1080,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAz0lEQVR42mNgaFnGzAAFZnO3GZkDMYyPkDNtkpWbteVEyqr9/0FYdObmEwxc1bJwhXMOXTgx++D5/5P2nvk7Zd/Zv0uOXf4P5J+AyAb3Gi08eun/z99//i48cunf0uOX//3////vsuNX/jOE9QGti+g3Akr8BwlefPj839XHL8EKFhy5+J8hdiLEPTMOnDsBtOY/yHgg+++qk1f/zzt84QQDHGRMk7Wfv/2Ezuwt/5Vmbv6vNXvrCYbIfqgjp2+Ce7Nx23Gjms1HEd6csoEZAALjd67o7P0OAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8};var n=a(11648),d=a.n(n);function l({size:e="medium",showText:t=!0,className:a="",href:n="/"}){let l=(0,s.jsxs)("div",{className:`${d().logo} ${d()[e]} ${a}`,children:[s.jsx(r.default,{src:i,alt:"TIKETEA ONLINE",width:"small"===e?40:"medium"===e?60:80,height:"small"===e?40:"medium"===e?60:80,className:d().logoImage,priority:!0}),t&&s.jsx("span",{className:d().logoText,children:"TIKETEA ONLINE"})]});return n?s.jsx(o.default,{href:n,className:d().logoLink,children:l}):l}},81364:(e,t,a)=>{"use strict";function s(){return null}a.d(t,{default:()=>s}),a(5507),a(82986),a(26379)},80760:(e,t,a)=>{"use strict";a.d(t,{a:()=>o});var s=a(5507),r=a(38442);function o(){let[e,t]=(0,s.useState)(!1);return{...(0,r.t)(),isHydrated:e}}a(16012)},10752:(e,t,a)=>{"use strict";a.d(t,{x:()=>i});var s=a(20751);let r=(()=>{let e="http://localhost:3001/api";if(!e.startsWith("http://")&&!e.startsWith("https://"))return console.warn("⚠️ NEXT_PUBLIC_API_URL no tiene protocolo, usando https://"),`https://${e}`;if(!e.endsWith("/api")){let t=e.endsWith("/")?e.slice(0,-1):e;return`${t}/api`}return e})();class o{client;constructor(){this.client=s.Z.create({baseURL:r,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>{try{let t=localStorage.getItem("token");console.log("API Request - Token from localStorage:",t),t?(e.headers.Authorization=`Bearer ${t}`,console.log("API Request - Authorization header set:",e.headers.Authorization)):console.log("API Request - No token found"),e.data instanceof FormData&&delete e.headers["Content-Type"]}catch(e){console.error("Error reading token from localStorage:",e)}return e}),this.client.interceptors.response.use(e=>e,e=>(e.response?.status===401&&localStorage.removeItem("token"),Promise.reject(e)))}async register(e){return this.client.post("/auth/register",e)}async login(e){return this.client.post("/auth/login",e)}async getProfile(){return this.client.get("/auth/profile")}async logout(){return this.client.post("/auth/logout")}async get(e,t){return this.client.get(e,t)}async post(e,t,a){return this.client.post(e,t,a)}async put(e,t){return this.client.put(e,t)}async delete(e){return this.client.delete(e)}}let i=new o},26379:(e,t,a)=>{"use strict";let s;a.d(t,{I8:()=>l,db:()=>d});var r=a(3827),o=a(82986),i=a(31027),n=a(80549);s=0===(0,r.C6)().length?(0,r.ZF)({apiKey:"AIzaSyCROuDbFChzWrRSXQ42lih56oLEA1hjne4",authDomain:"sorteo-b8fb0.firebaseapp.com",projectId:"sorteo-b8fb0",storageBucket:"sorteo-b8fb0.firebasestorage.app",messagingSenderId:"58395659334",appId:"1:58395659334:web:58c8f46dab380710eb4e47"}):(0,r.C6)()[0];let d=(0,o.ad)(s);(0,i.cF)(s);let l=(0,n.v0)(s)},16012:(e,t,a)=>{"use strict";a.d(t,{Y:()=>d});var s=a(80549),r=a(82986),o=a(26379),i=a(1260);let n=async e=>{try{let t=await (0,r.getDoc)((0,r.doc)(o.db,"users",e.uid));if(!t.exists())return{id:e.uid,name:e.displayName||e.email?.split("@")[0]||"Usuario",email:e.email||"",role:i.i.USER};let a=t.data();return{id:e.uid,name:a.name||e.displayName||e.email?.split("@")[0]||"Usuario",email:e.email||"",role:a.role||i.i.USER}}catch(t){return console.error("Error converting Firebase user:",t),{id:e.uid,name:e.displayName||e.email?.split("@")[0]||"Usuario",email:e.email||"",role:i.i.USER}}},d={async register(e){try{let t=(await (0,s.Xb)(o.I8,e.email,e.password)).user;e.name&&await (0,s.ck)(t,{displayName:e.name});let a=await t.getIdToken(),d={name:e.name,email:e.email,role:e.role,createdAt:(0,r.serverTimestamp)(),updatedAt:(0,r.serverTimestamp)()};if(e.role===i.i.SHOP&&e.shopName){let a={userId:t.uid,name:e.shopName,description:"",status:"pending",createdAt:(0,r.serverTimestamp)(),updatedAt:(0,r.serverTimestamp)()},s=await (0,r.ET)((0,r.collection)(o.db,"shops"),a);d.shopId=s.id,await (0,r.pl)((0,r.doc)(o.db,"users",t.uid),d)}else await (0,r.pl)((0,r.doc)(o.db,"users",t.uid),d);return{user:await n(t),token:a}}catch(t){console.error("Error registering user:",t);let e="Error al registrar usuario";throw"auth/email-already-in-use"===t.code?e="Este email ya est\xe1 registrado":"auth/invalid-email"===t.code?e="Email inv\xe1lido":"auth/weak-password"===t.code?e="La contrase\xf1a debe tener al menos 6 caracteres":"auth/operation-not-allowed"===t.code?e="El m\xe9todo de autenticaci\xf3n por email/password no est\xe1 habilitado. Por favor, contacta al administrador.":"auth/network-request-failed"===t.code?e="Error de conexi\xf3n. Verifica tu conexi\xf3n a internet.":t.message&&(e=t.message),Error(e)}},async login(e){try{let t=(await (0,s.e5)(o.I8,e.email,e.password)).user,a=await t.getIdToken();return{user:await n(t),token:a}}catch(t){console.error("Error logging in:",t);let e="Error al iniciar sesi\xf3n";throw"auth/user-not-found"===t.code?e="Usuario no encontrado":"auth/wrong-password"===t.code?e="Contrase\xf1a incorrecta":"auth/invalid-email"===t.code?e="Email inv\xe1lido":"auth/user-disabled"===t.code?e="Usuario deshabilitado":"auth/too-many-requests"===t.code?e="Demasiados intentos. Intenta m\xe1s tarde":"auth/operation-not-allowed"===t.code?e="El m\xe9todo de autenticaci\xf3n por email/password no est\xe1 habilitado. Por favor, contacta al administrador.":"auth/network-request-failed"===t.code?e="Error de conexi\xf3n. Verifica tu conexi\xf3n a internet.":t.message&&(e=t.message),Error(e)}},async logout(){try{await (0,s.w7)(o.I8)}catch(e){throw console.error("Error logging out:",e),e}},async getCurrentUser(){try{let e=o.I8.currentUser;if(!e)return null;return await n(e)}catch(e){return console.error("Error getting current user:",e),null}},async getCurrentUserToken(){try{let e=o.I8.currentUser;if(!e)return null;return await e.getIdToken()}catch(e){return console.error("Error getting token:",e),null}},onAuthStateChanged:e=>(0,s.Aj)(o.I8,async t=>{t?e(await n(t)):e(null)})}},33745:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s=a(10752);let r={async createPayment(e){try{return(await s.x.post("/payments",e)).data}catch(e){throw console.error("Error creating payment:",e),e}},async confirmPayment(e){try{return(await s.x.post("/payments/confirm",e)).data}catch(e){throw console.error("Error confirming payment:",e),e}},async failPayment(e,t){try{return(await s.x.post(`/payments/${e}/fail`,{failureReason:t})).data}catch(e){throw console.error("Error failing payment:",e),e}},async getPaymentById(e){try{return(await s.x.get(`/payments/${e}`)).data}catch(e){throw console.error("Error fetching payment:",e),e}},async getMyPayments(){try{return(await s.x.get("/payments/user/me")).data}catch(e){throw console.error("Error fetching user payments:",e),e}},async getCompletedPaymentsByRaffleId(e){try{return(await s.x.get(`/payments/raffle/${e}`)).data}catch(e){throw console.error("Error fetching raffle payments:",e),e}},async refundPayment(e){try{return(await s.x.post(`/payments/${e}/refund`,{})).data}catch(e){throw console.error("Error refunding payment:",e),e}}}},79114:(e,t,a)=>{"use strict";a.d(t,{_:()=>l});var s,r=a(82986),o=a(26379);!function(e){e.ACTIVE="active",e.INACTIVE="inactive",e.ARCHIVED="archived"}(s||(s={}));let i=e=>e?.toDate?e.toDate():e instanceof Date?e:"string"==typeof e?new Date(e):new Date,n=e=>{let t=e.data();return{id:e.id,shopId:t.shopId||"",name:t.name||"",description:t.description||"",value:t.value||0,height:t.height||0,width:t.width||0,depth:t.depth||0,requiresDeposit:t.requiresDeposit||!1,category:t.category,mainImage:t.mainImage,status:t.status||s.INACTIVE,createdAt:i(t.createdAt),updatedAt:i(t.updatedAt)}},d={async getProductsByShop(e){try{let t=(0,r.collection)(o.db,"products"),a=(0,r.query)(t,(0,r.where)("shopId","==",e),(0,r.where)("status","==",s.ACTIVE));return(await (0,r.getDocs)(a)).docs.map(e=>n(e)).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime())}catch(e){throw console.error("Error fetching products by shop:",e),e}},async getActiveProductsByShop(e){return this.getProductsByShop(e)},async getProductById(e){try{let t=await (0,r.getDoc)((0,r.doc)(o.db,"products",e));if(!t.exists())throw Error("Product not found");return n(t)}catch(e){throw console.error("Error fetching product:",e),e}},async getAllProducts(){try{let e=(0,r.collection)(o.db,"products"),t=(0,r.query)(e,(0,r.where)("status","==",s.ACTIVE));return(await (0,r.getDocs)(t)).docs.map(e=>n(e)).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime())}catch(e){throw console.error("Error fetching all products:",e),e}},async createProduct(e){try{let t=(0,r.collection)(o.db,"products"),a={shopId:e.shopId,name:e.name,description:e.description,value:e.value,height:e.height,width:e.width,depth:e.depth,requiresDeposit:e.height>15||e.width>15||e.depth>15,category:e.category||null,mainImage:e.mainImage||null,status:s.ACTIVE,createdAt:(0,r.serverTimestamp)(),updatedAt:(0,r.serverTimestamp)()},i=await (0,r.ET)(t,a),d=await (0,r.getDoc)(i);if(!d.exists())throw Error("Error al crear el producto");return n(d)}catch(e){throw console.error("Error creating product:",e),e}},async updateProduct(e,t){try{let a=(0,r.doc)(o.db,"products",e),s={updatedAt:(0,r.serverTimestamp)()};if(void 0!==t.name&&(s.name=t.name),void 0!==t.description&&(s.description=t.description),void 0!==t.value&&(s.value=t.value),void 0!==t.height&&(s.height=t.height),void 0!==t.width&&(s.width=t.width),void 0!==t.depth&&(s.depth=t.depth),void 0!==t.category&&(s.category=t.category),void 0!==t.mainImage&&(s.mainImage=t.mainImage),void 0!==t.height||void 0!==t.width||void 0!==t.depth){let e=await (0,r.getDoc)(a);if(e.exists()){let a=e.data(),r=void 0!==t.height?t.height:a.height,o=void 0!==t.width?t.width:a.width,i=void 0!==t.depth?t.depth:a.depth;s.requiresDeposit=r>15||o>15||i>15}}await (0,r.updateDoc)(a,s);let i=await (0,r.getDoc)(a);if(!i.exists())throw Error("Producto no encontrado");return n(i)}catch(e){throw console.error("Error updating product:",e),e}},async deactivateProduct(e){try{let t=(0,r.doc)(o.db,"products",e);await (0,r.updateDoc)(t,{status:s.INACTIVE,updatedAt:(0,r.serverTimestamp)()});let a=await (0,r.getDoc)(t);if(!a.exists())throw Error("Producto no encontrado");return n(a)}catch(e){throw console.error("Error deactivating product:",e),e}}},l={getProductsByShop:async e=>d.getProductsByShop(e),getActiveProductsByShop:async e=>d.getActiveProductsByShop(e),getProductById:async e=>d.getProductById(e),getAllProducts:async()=>d.getAllProducts(),createProduct:async e=>d.createProduct(e),updateProduct:async(e,t)=>d.updateProduct(e,t),deactivateProduct:async e=>d.deactivateProduct(e)}},28848:(e,t,a)=>{"use strict";a.d(t,{m:()=>c});var s=a(10752),r=a(82986),o=a(26379),i=a(12576);let n=e=>e?.toDate?e.toDate():e instanceof Date?e:"string"==typeof e?new Date(e):new Date,d=e=>{let t=e.data();return{id:e.id,userId:t.userId||"",name:t.name||"",description:t.description,logo:t.logo,publicEmail:t.publicEmail,phone:t.phone,socialMedia:t.socialMedia,status:t.status||i.R.PENDING,createdAt:n(t.createdAt),updatedAt:n(t.updatedAt)}},l={async getShopById(e){try{let t=await (0,r.getDoc)((0,r.doc)(o.db,"shops",e));if(!t.exists())throw Error("Shop not found");return d(t)}catch(e){throw console.error("Error fetching shop:",e),e}},async getVerifiedShops(){try{let e=(0,r.collection)(o.db,"shops"),t=(0,r.query)(e,(0,r.where)("status","==",i.R.VERIFIED));return(await (0,r.getDocs)(t)).docs.map(e=>d(e)).sort((e,t)=>e.name.localeCompare(t.name))}catch(e){throw console.error("Error fetching verified shops:",e),e}},async getAllShops(){try{let e=(0,r.collection)(o.db,"shops");return(await (0,r.getDocs)(e)).docs.map(e=>d(e)).sort((e,t)=>e.name.localeCompare(t.name))}catch(e){throw console.error("Error fetching all shops:",e),e}}},c={getShopById:async e=>l.getShopById(e),getAllShops:async()=>l.getAllShops(),getVerifiedShops:async()=>l.getVerifiedShops(),getMyShop:async()=>(await s.x.get("/shops/my-shop/current")).data,updateShop:async(e,t)=>(await s.x.put(`/shops/${e}`,t)).data,getShopStatistics:async e=>(await s.x.get(`/shops/${e}/statistics`)).data}},24544:(e,t,a)=>{"use strict";a.d(t,{T:()=>r});var s=a(10752);let r={async uploadProductImage(e){let t=new FormData;return t.append("image",e),(await s.x.post("/uploads/products/image",t,{headers:{"Content-Type":"multipart/form-data"}})).data.fileUrl},async deleteImage(e){await s.x.delete(`/uploads/products/image/${e}`)}}},38442:(e,t,a)=>{"use strict";a.d(t,{t:()=>i});var s=a(24978),r=a(31460),o=a(16012);let i=(0,s.Ue)()((0,r.tJ)((e,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,setUser:t=>e({user:t,isAuthenticated:!!t}),setToken:t=>{t?localStorage.setItem("token",t):localStorage.removeItem("token"),e({token:t})},setIsLoading:t=>e({isLoading:t}),setError:t=>e({error:t}),logout:async()=>{try{await o.Y.logout()}catch(e){console.error("Error logging out:",e)}finally{localStorage.removeItem("token"),e({user:null,token:null,isAuthenticated:!1})}},refreshToken:async()=>{try{let e=await o.Y.getCurrentUserToken();e&&t().setToken(e)}catch(e){console.error("Error refreshing token:",e)}}}),{name:"auth-store",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))},1260:(e,t,a)=>{"use strict";var s;a.d(t,{i:()=>s}),function(e){e.ADMIN="admin",e.SHOP="shop",e.USER="user"}(s||(s={}))},12576:(e,t,a)=>{"use strict";var s;a.d(t,{R:()=>s}),function(e){e.PENDING="pending",e.VERIFIED="verified",e.BLOCKED="blocked"}(s||(s={}))},60594:e=>{e.exports={dashboard:"dashboard_dashboard__gQFzy",loadingContainer:"dashboard_loadingContainer__DQmdc",errorContainer:"dashboard_errorContainer__2k3e0",header:"dashboard_header__0IQ3E",headerTitle:"dashboard_headerTitle__HIxZh",headerIcon:"dashboard_headerIcon__5FI23",headerContent:"dashboard_headerContent__3oqbj",userSection:"dashboard_userSection__BSeKt",userInfo:"dashboard_userInfo__J_gfr",userAvatar:"dashboard_userAvatar__AphB1",userDetails:"dashboard_userDetails__hitT1",userName:"dashboard_userName__CtC1T",email:"dashboard_email__98kzB",role:"dashboard_role__560J9",logoutBtn:"dashboard_logoutBtn__UgAUz",logoutIcon:"dashboard_logoutIcon__DdWYL",errorBanner:"dashboard_errorBanner__FsIo1",tabsContainer:"dashboard_tabsContainer__IbrIv",tab:"dashboard_tab__nvtkC",activeTab:"dashboard_activeTab__YbTNq",tabIcon:"dashboard_tabIcon__8vIXb",content:"dashboard_content__lgdH3",overviewGrid:"dashboard_overviewGrid__tJR4P",card:"dashboard_card__uY0FF",cardIcon:"dashboard_cardIcon__mzkui",bigNumber:"dashboard_bigNumber__u5eTh",subtitle:"dashboard_subtitle__xP_XA",statusBreakdown:"dashboard_statusBreakdown__vsufj",tableContainer:"dashboard_tableContainer__XIu3f",table:"dashboard_table__qUgyM",badge:"dashboard_badge__3z1pJ",progressBar:"dashboard_progressBar__PzDkJ",progressFill:"dashboard_progressFill__eBY_A",progressText:"dashboard_progressText__zzeEz",emptyMessage:"dashboard_emptyMessage__Iagxl",moreItems:"dashboard_moreItems__rmW6c",tableHeader:"dashboard_tableHeader__n9Xxd",createBtn:"dashboard_createBtn__6OW9J",modalOverlay:"dashboard_modalOverlay__b2eFY",modal:"dashboard_modal__qgAga",modalHeader:"dashboard_modalHeader__E15Ib",closeBtn:"dashboard_closeBtn__FCbJn",form:"dashboard_form__2eBG3",formGroup:"dashboard_formGroup__xr6t0",input:"dashboard_input__5d_PV",textarea:"dashboard_textarea__gVSwe",formActions:"dashboard_formActions__l_SfE",cancelBtn:"dashboard_cancelBtn__sU02m",submitBtn:"dashboard_submitBtn__SO014",buyTicketsBtn:"dashboard_buyTicketsBtn__jp_hU",quantityBtn:"dashboard_quantityBtn__cJA_m"}},11648:e=>{e.exports={logo:"Logo_logo__hia7S",logoLink:"Logo_logoLink__gM3sV",logoImage:"Logo_logoImage__daWgp",logoText:"Logo_logoText___NRG4",small:"Logo_small__digRM",medium:"Logo_medium__HI_Ok",large:"Logo_large__OX_7R",dark:"Logo_dark__vov1N"}},12516:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(2772).createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/app/dashboard/page.tsx#default`)},24198:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i,metadata:()=>o});var s=a(35023);a(91641);let r=(0,a(2772).createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/components/MakeAdminScript.tsx#default`),o={title:"TIKETEA ONLINE",description:"Plataforma de sorteos online - TIKETEA ONLINE"};function i({children:e}){return s.jsx("html",{lang:"es",children:(0,s.jsxs)("body",{children:[e,s.jsx(r,{})]})})}},91641:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[3591,8559,3352,4175,5562,8154],()=>a(94939));module.exports=s})();