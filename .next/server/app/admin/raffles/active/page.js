(()=>{var e={};e.id=9060,e.ids=[9060],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},54430:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>o}),a(79819),a(83517),a(24198),a(12874);var s=a(27105),r=a(15265),n=a(90157),i=a.n(n),l=a(44665),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);a.d(t,d);let o=["",{children:["admin",{children:["raffles",{children:["active",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,79819)),"/Users/axelhernandez/Sorteos/frontend/src/app/admin/raffles/active/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,83517)),"/Users/axelhernandez/Sorteos/frontend/src/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,24198)),"/Users/axelhernandez/Sorteos/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,12874,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/axelhernandez/Sorteos/frontend/src/app/admin/raffles/active/page.tsx"],u="/admin/raffles/active/page",x={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/raffles/active/page",pathname:"/admin/raffles/active",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},49871:(e,t,a)=>{Promise.resolve().then(a.bind(a,88775))},88775:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(19899),r=a(5507),n=a(42466),i=a(51881),l=a.n(i);function d(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(!0),[d,o]=(0,r.useState)(null),[c,u]=(0,r.useState)(0),[x,p]=(0,r.useState)(0),[h,m]=(0,r.useState)(""),[f,g]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!1),[y,b]=(0,r.useState)(null),[S,w]=(0,r.useState)(""),[C,$]=(0,r.useState)(!1),q=async()=>{try{i(!0);let e=await n.d.getActiveRaffles(10,10*c,h||void 0);t(e[0]),p(e[1]),o(null)}catch(e){o(e.response?.data?.message||"Error al cargar sorteos"),console.error("Error:",e)}finally{i(!1)}},N=async()=>{if(!y||!S.trim()){alert("Por favor ingresa un motivo de cancelaci\xf3n");return}try{$(!0),await n.d.cancelRaffle(y,S),alert("Sorteo cancelado exitosamente"),g(!1),w(""),b(null),q()}catch(e){alert(e.response?.data?.message||"Error al cancelar sorteo"),console.error("Error:",e)}finally{$(!1)}},P=async()=>{if(!y){alert("Error: Sorteo no seleccionado");return}try{$(!0),await n.d.executeRaffle(y),alert("Sorteo ejecutado exitosamente"),v(!1),b(null),q()}catch(e){alert(e.response?.data?.message||"Error al ejecutar sorteo"),console.error("Error:",e)}finally{$(!1)}},k=(e,t)=>t>0?Math.round(e/t*100):0;return a&&0===e.length?s.jsx("div",{style:{textAlign:"center",padding:"40px"},children:s.jsx("p",{children:"Cargando sorteos activos..."})}):(0,s.jsxs)("div",{children:[s.jsx("h2",{style:{marginBottom:"20px",color:"#2c3e50"},children:"Sorteos Activos"}),d&&s.jsx("div",{style:{padding:"15px",backgroundColor:"#f8d7da",color:"#721c24",borderRadius:"4px",marginBottom:"20px"},children:d}),s.jsx("div",{className:l().tableHeader,style:{marginBottom:"20px"},children:s.jsx("div",{className:l().filterContainer,children:s.jsx("input",{type:"text",className:l().filterInput,placeholder:"Filtrar por ID de tienda...",value:h,onChange:e=>{m(e.target.value),u(0)}})})}),0===e.length?s.jsx("div",{style:{textAlign:"center",padding:"40px",backgroundColor:"white",borderRadius:"8px"},children:s.jsx("p",{style:{color:"#7f8c8d"},children:"No hay sorteos activos"})}):(0,s.jsxs)("div",{className:l().tableContainer,children:[(0,s.jsxs)("table",{children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"Tienda"}),s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Valor"}),s.jsx("th",{children:"Tickets Vendidos"}),s.jsx("th",{children:"Progreso"}),s.jsx("th",{children:"Activo desde"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:e.map(e=>{let t=k(e.soldTickets,e.totalTickets);return(0,s.jsxs)("tr",{children:[s.jsx("td",{children:e.shop.name}),s.jsx("td",{children:e.product.name}),(0,s.jsxs)("td",{children:["$",e.productValue.toFixed(2)]}),(0,s.jsxs)("td",{children:[e.soldTickets," / ",e.totalTickets]}),s.jsx("td",{children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx("div",{style:{width:"100px",height:"8px",backgroundColor:"#e0e0e0",borderRadius:"4px",overflow:"hidden"},children:s.jsx("div",{style:{width:`${t}%`,height:"100%",backgroundColor:100===t?"#27ae60":"#3498db",transition:"width 0.3s ease"}})}),(0,s.jsxs)("span",{style:{fontSize:"12px",fontWeight:"600"},children:[t,"%"]})]})}),s.jsx("td",{children:new Date(e.activatedAt).toLocaleDateString()}),s.jsx("td",{children:(0,s.jsxs)("div",{className:l().actionButtons,children:[100===t&&s.jsx("button",{className:`${l().btn} ${l().btnSuccess}`,onClick:()=>{b(e.id),v(!0)},children:"Ejecutar"}),s.jsx("button",{className:`${l().btn} ${l().btnDanger}`,onClick:()=>{b(e.id),g(!0)},children:"Cancelar"})]})})]},e.id)})})]}),(0,s.jsxs)("div",{className:l().pagination,children:[s.jsx("button",{className:l().paginationBtn,disabled:0===c,onClick:()=>u(c-1),children:"← Anterior"}),(0,s.jsxs)("span",{style:{padding:"8px 12px"},children:["P\xe1gina ",c+1," de ",Math.ceil(x/10)]}),s.jsx("button",{className:l().paginationBtn,disabled:c>=Math.ceil(x/10)-1,onClick:()=>u(c+1),children:"Siguiente →"})]})]}),f&&s.jsx("div",{className:`${l().modal} ${f?l().open:""}`,children:(0,s.jsxs)("div",{className:l().modalContent,children:[s.jsx("div",{className:l().modalHeader,children:s.jsx("h2",{children:"Cancelar Sorteo"})}),(0,s.jsxs)("div",{className:l().modalBody,children:[s.jsx("p",{style:{color:"#7f8c8d",marginBottom:"15px"},children:"\xbfEst\xe1s seguro de que deseas cancelar este sorteo? Esta acci\xf3n no se puede deshacer."}),(0,s.jsxs)("div",{className:l().formGroup,children:[s.jsx("label",{children:"Motivo de la Cancelaci\xf3n"}),s.jsx("textarea",{value:S,onChange:e=>w(e.target.value),placeholder:"Ingresa el motivo de la cancelaci\xf3n...",disabled:C})]})]}),(0,s.jsxs)("div",{className:l().modalFooter,children:[s.jsx("button",{className:`${l().btn} ${l().btnSecondary}`,onClick:()=>{g(!1),w(""),b(null)},disabled:C,children:"Cancelar"}),s.jsx("button",{className:`${l().btn} ${l().btnDanger}`,onClick:N,disabled:C,children:C?"Procesando...":"Confirmar Cancelaci\xf3n"})]})]})}),j&&s.jsx("div",{className:`${l().modal} ${j?l().open:""}`,children:(0,s.jsxs)("div",{className:l().modalContent,children:[s.jsx("div",{className:l().modalHeader,children:s.jsx("h2",{children:"Ejecutar Sorteo"})}),(0,s.jsxs)("div",{className:l().modalBody,children:[s.jsx("p",{style:{color:"#7f8c8d",marginBottom:"15px"},children:"\xbfEst\xe1s seguro de que deseas ejecutar este sorteo? Se seleccionar\xe1 un ganador de forma aleatoria entre todos los tickets vendidos."}),s.jsx("p",{style:{color:"#27ae60",fontWeight:"bold"},children:"Esta acci\xf3n no se puede deshacer."})]}),(0,s.jsxs)("div",{className:l().modalFooter,children:[s.jsx("button",{className:`${l().btn} ${l().btnSecondary}`,onClick:()=>{v(!1),b(null)},disabled:C,children:"Cancelar"}),s.jsx("button",{className:`${l().btn} ${l().btnSuccess}`,onClick:P,disabled:C,children:C?"Ejecutando...":"Confirmar Ejecuci\xf3n"})]})]})})]})}},42466:(e,t,a)=>{"use strict";a.d(t,{d:()=>r});var s=a(10752);let r={getDashboardStats:async()=>(await s.x.get("/admin/dashboard/stats")).data,getPendingRaffles:async(e=50,t=0)=>(await s.x.get("/admin/raffles/pending",{params:{limit:e,offset:t}})).data,getActiveRaffles:async(e=50,t=0,a)=>(await s.x.get("/admin/raffles/active",{params:{limit:e,offset:t,...a&&{shopId:a}}})).data,getFinishedRaffles:async(e=50,t=0,a)=>(await s.x.get("/admin/raffles/finished",{params:{limit:e,offset:t,...a&&{shopId:a}}})).data,getRaffleDetail:async e=>(await s.x.get(`/admin/raffles/${e}`)).data,approveRaffle:async e=>(await s.x.put(`/admin/raffles/${e}/approve`,{})).data,rejectRaffle:async(e,t)=>(await s.x.put(`/admin/raffles/${e}/reject`,{reason:t})).data,cancelRaffle:async(e,t)=>(await s.x.put(`/admin/raffles/${e}/cancel`,{reason:t})).data,executeRaffle:async e=>(await s.x.put(`/admin/raffles/${e}/execute`,{})).data,getAllShops:async(e=50,t=0,a)=>(await s.x.get("/admin/shops",{params:{limit:e,offset:t,...a&&{status:a}}})).data,getShopDetail:async e=>(await s.x.get(`/admin/shops/${e}`)).data,changeShopStatus:async(e,t,a)=>(await s.x.put(`/admin/shops/${e}/status`,{status:t,...a&&{reason:a}})).data,getAllUsers:async(e=50,t=0,a)=>(await s.x.get("/admin/users",{params:{limit:e,offset:t,...a&&{role:a}}})).data,getUserDetail:async e=>(await s.x.get(`/admin/users/${e}`)).data,getAuditLogs:async(e=50,t=0,a)=>(await s.x.get("/admin/audit/logs",{params:{limit:e,offset:t,...a}})).data,getEntityAuditLogs:async(e,t)=>(await s.x.get(`/admin/audit/entity/${e}/${t}`)).data,getAllPayments:async(e=50,t=0,a)=>(await s.x.get("/admin/payments",{params:{limit:e,offset:t,...a?.status&&{status:a.status},...a?.userId&&{userId:a.userId},...a?.raffleId&&{raffleId:a.raffleId}}})).data,getPaymentDetail:async e=>(await s.x.get(`/admin/payments/${e}`)).data}},79819:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(2772).createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/app/admin/raffles/active/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[3591,8559,3352,4175,5562,8154,6415],()=>a(54430));module.exports=s})();