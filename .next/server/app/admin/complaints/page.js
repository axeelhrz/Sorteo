(()=>{var e={};e.id=7634,e.ids=[7634],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},33122:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>r.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(94679),s(83517),s(24198),s(12874);var a=s(27105),i=s(15265),n=s(90157),r=s.n(n),l=s(44665),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["admin",{children:["complaints",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,94679)),"/Users/axelhernandez/Sorteos/frontend/src/app/admin/complaints/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,83517)),"/Users/axelhernandez/Sorteos/frontend/src/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,24198)),"/Users/axelhernandez/Sorteos/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,12874,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/axelhernandez/Sorteos/frontend/src/app/admin/complaints/page.tsx"],p="/admin/complaints/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/admin/complaints/page",pathname:"/admin/complaints",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},74978:(e,t,s)=>{Promise.resolve().then(s.bind(s,57747))},57747:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(19899),i=s(5507),n=s(76153),r=s(80760),l=s(24940),o=s(85125),d=s(63020),c=s.n(d);function p(){(0,n.useRouter)();let{user:e,isLoading:t}=(0,r.a)(),[s,d]=(0,i.useState)([]),[p,u]=(0,i.useState)(null),[x,h]=(0,i.useState)(!0),[_,v]=(0,i.useState)(null),[j,E]=(0,i.useState)(null),[f,g]=(0,i.useState)({status:"",type:"",shopId:""}),N=async()=>{try{h(!0);let{complaints:e}=await o.P.getAllComplaints({status:f.status||void 0,type:f.type||void 0,shopId:f.shopId||void 0,limit:50});d(e)}catch(e){v(e.response?.data?.message||"Error al cargar reclamos")}finally{h(!1)}},R=e=>{u(e)},P=async()=>{try{let{data:e,filename:t}=await o.P.exportComplaints({status:f.status||void 0,shopId:f.shopId||void 0}),s=document.createElement("a");s.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(e)),s.setAttribute("download",t),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch(e){v("Error al exportar reclamos")}};return t||!e||"admin"!==e.role?a.jsx("div",{className:c().loading,children:"Cargando..."}):(0,a.jsxs)("div",{className:c().container,children:[(0,a.jsxs)("div",{className:c().header,children:[a.jsx("h1",{children:"Gesti\xf3n de Reclamos"}),a.jsx("p",{children:"Administra y resuelve reclamos de usuarios"})]}),j&&(0,a.jsxs)("div",{className:c().statsGrid,children:[(0,a.jsxs)("div",{className:c().statCard,children:[a.jsx("div",{className:c().statValue,children:j.total}),a.jsx("div",{className:c().statLabel,children:"Total"})]}),(0,a.jsxs)("div",{className:c().statCard,children:[a.jsx("div",{className:c().statValue,style:{color:"#FFA500"},children:j.pending}),a.jsx("div",{className:c().statLabel,children:"Pendientes"})]}),(0,a.jsxs)("div",{className:c().statCard,children:[a.jsx("div",{className:c().statValue,style:{color:"#4169E1"},children:j.inReview}),a.jsx("div",{className:c().statLabel,children:"En Revisi\xf3n"})]}),(0,a.jsxs)("div",{className:c().statCard,children:[a.jsx("div",{className:c().statValue,style:{color:"#228B22"},children:j.resolved}),a.jsx("div",{className:c().statLabel,children:"Resueltos"})]}),(0,a.jsxs)("div",{className:c().statCard,children:[a.jsx("div",{className:c().statValue,style:{color:"#DC143C"},children:j.rejected}),a.jsx("div",{className:c().statLabel,children:"Rechazados"})]})]}),_&&a.jsx("div",{className:c().error,children:_}),(0,a.jsxs)("div",{className:c().mainContent,children:[(0,a.jsxs)("div",{className:c().listPanel,children:[(0,a.jsxs)("div",{className:c().filterBar,children:[(0,a.jsxs)("select",{value:f.status,onChange:e=>g({...f,status:e.target.value}),className:c().filterSelect,children:[a.jsx("option",{value:"",children:"Todos los estados"}),a.jsx("option",{value:l.P5.PENDING,children:"Pendiente"}),a.jsx("option",{value:l.P5.IN_REVIEW,children:"En Revisi\xf3n"}),a.jsx("option",{value:l.P5.RESOLVED,children:"Resuelto"}),a.jsx("option",{value:l.P5.REJECTED,children:"Rechazado"})]}),(0,a.jsxs)("select",{value:f.type,onChange:e=>g({...f,type:e.target.value}),className:c().filterSelect,children:[a.jsx("option",{value:"",children:"Todos los tipos"}),a.jsx("option",{value:l.pM.PRIZE_NOT_DELIVERED,children:"No entrega del premio"}),a.jsx("option",{value:l.pM.DIFFERENT_PRODUCT,children:"Producto diferente"}),a.jsx("option",{value:l.pM.PURCHASE_PROBLEM,children:"Problema en compra"}),a.jsx("option",{value:l.pM.SHOP_BEHAVIOR,children:"Problema con tienda"}),a.jsx("option",{value:l.pM.RAFFLE_FRAUD,children:"Fraude"}),a.jsx("option",{value:l.pM.TECHNICAL_ISSUE,children:"Problema t\xe9cnico"}),a.jsx("option",{value:l.pM.PAYMENT_ERROR,children:"Error de pago"})]}),a.jsx("button",{onClick:P,className:c().exportBtn,children:"\uD83D\uDCE5 Exportar CSV"})]}),x?a.jsx("div",{className:c().loading,children:"Cargando reclamos..."}):a.jsx("div",{className:c().complaintsList,children:s.map(e=>(0,a.jsxs)("div",{className:`${c().complaintItem} ${p?.id===e.id?c().selected:""}`,onClick:()=>R(e),children:[(0,a.jsxs)("div",{className:c().itemHeader,children:[(0,a.jsxs)("strong",{children:["#",e.complaintNumber]}),a.jsx("span",{className:c().statusBadge,style:{backgroundColor:e.status===l.P5.PENDING?"#FFA500":e.status===l.P5.IN_REVIEW?"#4169E1":e.status===l.P5.RESOLVED?"#228B22":"#DC143C"},children:e.status})]}),a.jsx("p",{className:c().itemType,children:e.type}),a.jsx("p",{className:c().itemUser,children:e.user?.email}),a.jsx("small",{children:new Date(e.createdAt).toLocaleDateString("es-ES")})]},e.id))})]}),p&&a.jsx("div",{className:c().detailPanel,children:a.jsx(m,{complaint:p,onUpdate:N})})]})]})}function m({complaint:e,onUpdate:t}){let[s,n]=(0,i.useState)(!1),[r,d]=(0,i.useState)({status:e.status,resolution:e.resolution||"",resolutionNotes:e.resolutionNotes||""}),p=async s=>{s.preventDefault(),n(!0);try{await o.P.updateComplaint(e.id,{status:r.status,resolution:r.resolution,resolutionNotes:r.resolutionNotes}),t()}catch(e){console.error("Error al actualizar:",e)}finally{n(!1)}};return(0,a.jsxs)("div",{className:c().detailContent,children:[(0,a.jsxs)("h2",{children:["#",e.complaintNumber]}),(0,a.jsxs)("div",{className:c().detailInfo,children:[(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Usuario:"})," ",e.user?.email]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Tipo:"})," ",e.type]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Tienda:"})," ",e.shop?.name||"N/A"]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Creado:"})," ",new Date(e.createdAt).toLocaleDateString("es-ES")]})]}),(0,a.jsxs)("div",{className:c().descriptionBox,children:[a.jsx("h3",{children:"Descripci\xf3n"}),a.jsx("p",{children:e.description})]}),(0,a.jsxs)("form",{onSubmit:p,className:c().updateForm,children:[(0,a.jsxs)("div",{className:c().formGroup,children:[a.jsx("label",{children:"Estado"}),(0,a.jsxs)("select",{value:r.status,onChange:e=>d({...r,status:e.target.value}),children:[a.jsx("option",{value:l.P5.PENDING,children:"Pendiente"}),a.jsx("option",{value:l.P5.IN_REVIEW,children:"En Revisi\xf3n"}),a.jsx("option",{value:l.P5.RESOLVED,children:"Resuelto"}),a.jsx("option",{value:l.P5.REJECTED,children:"Rechazado"})]})]}),(0,a.jsxs)("div",{className:c().formGroup,children:[a.jsx("label",{children:"Resoluci\xf3n"}),(0,a.jsxs)("select",{value:r.resolution,onChange:e=>d({...r,resolution:e.target.value}),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"resolved_user_favor",children:"A favor del usuario"}),a.jsx("option",{value:"resolved_shop_favor",children:"A favor de la tienda"}),a.jsx("option",{value:"resolved_platform_favor",children:"Resoluci\xf3n parcial"}),a.jsx("option",{value:"rejected",children:"Rechazado"})]})]}),(0,a.jsxs)("div",{className:c().formGroup,children:[a.jsx("label",{children:"Notas de Resoluci\xf3n"}),a.jsx("textarea",{value:r.resolutionNotes,onChange:e=>d({...r,resolutionNotes:e.target.value}),rows:4,placeholder:"Escribe las notas de resoluci\xf3n..."})]}),a.jsx("button",{type:"submit",disabled:s,className:c().submitBtn,children:s?"Actualizando...":"Actualizar Reclamo"})]})]})}},80760:(e,t,s)=>{"use strict";s.d(t,{a:()=>n});var a=s(5507),i=s(38442);function n(){let[e,t]=(0,a.useState)(!1);return{...(0,i.t)(),isHydrated:e}}s(16012)},85125:(e,t,s)=>{"use strict";s.d(t,{P:()=>i});var a=s(10752);let i={createComplaint:async e=>(await a.x.post("/complaints",e)).data,getComplaintById:async e=>(await a.x.get(`/complaints/${e}`)).data,async getUserComplaints(e){let t=new URLSearchParams;return e?.status&&t.append("status",e.status),e?.type&&t.append("type",e.type),e?.limit&&t.append("limit",e.limit.toString()),e?.offset&&t.append("offset",e.offset.toString()),(await a.x.get(`/complaints/user/my-complaints?${t.toString()}`)).data},async getShopComplaints(e,t){let s=new URLSearchParams;return t?.status&&s.append("status",t.status),t?.limit&&s.append("limit",t.limit.toString()),t?.offset&&s.append("offset",t.offset.toString()),(await a.x.get(`/complaints/shop/${e}?${s.toString()}`)).data},async getAllComplaints(e){let t=new URLSearchParams;return e?.status&&t.append("status",e.status),e?.type&&t.append("type",e.type),e?.shopId&&t.append("shopId",e.shopId),e?.raffleId&&t.append("raffleId",e.raffleId),e?.startDate&&t.append("startDate",e.startDate),e?.endDate&&t.append("endDate",e.endDate),e?.limit&&t.append("limit",e.limit.toString()),e?.offset&&t.append("offset",e.offset.toString()),(await a.x.get(`/complaints?${t.toString()}`)).data},updateComplaint:async(e,t)=>(await a.x.put(`/complaints/${e}`,t)).data,addMessage:async(e,t)=>(await a.x.post(`/complaints/${e}/messages`,{message:t})).data,getMessages:async e=>(await a.x.get(`/complaints/${e}/messages`)).data,addAttachment:async(e,t)=>(await a.x.post(`/complaints/${e}/attachments`,t)).data,getAttachments:async e=>(await a.x.get(`/complaints/${e}/attachments`)).data,cancelComplaint:async e=>(await a.x.put(`/complaints/${e}/cancel`,{})).data,async exportComplaints(e){let t=new URLSearchParams;return e?.startDate&&t.append("startDate",e.startDate),e?.endDate&&t.append("endDate",e.endDate),e?.shopId&&t.append("shopId",e.shopId),e?.status&&t.append("status",e.status),(await a.x.get(`/complaints/export/csv?${t.toString()}`)).data},getComplaintStats:async()=>(await a.x.get("/complaints/stats/overview")).data}},24940:(e,t,s)=>{"use strict";var a,i,n;s.d(t,{Fq:()=>n,P5:()=>i,pM:()=>a}),function(e){e.PRIZE_NOT_DELIVERED="prize_not_delivered",e.DIFFERENT_PRODUCT="different_product",e.PURCHASE_PROBLEM="purchase_problem",e.SHOP_BEHAVIOR="shop_behavior",e.RAFFLE_FRAUD="raffle_fraud",e.TECHNICAL_ISSUE="technical_issue",e.PAYMENT_ERROR="payment_error"}(a||(a={})),function(e){e.PENDING="pending",e.IN_REVIEW="in_review",e.RESOLVED="resolved",e.REJECTED="rejected",e.CANCELLED="cancelled"}(i||(i={})),function(e){e.RESOLVED_USER_FAVOR="resolved_user_favor",e.RESOLVED_SHOP_FAVOR="resolved_shop_favor",e.RESOLVED_PLATFORM_FAVOR="resolved_platform_favor",e.REJECTED="rejected",e.CANCELLED="cancelled"}(n||(n={}))},63020:e=>{e.exports={container:"admin-complaints_container__8QfLW",header:"admin-complaints_header__Fz5C0",statsGrid:"admin-complaints_statsGrid__DXBoc",statCard:"admin-complaints_statCard__V7bxL",statValue:"admin-complaints_statValue__OdamP",statLabel:"admin-complaints_statLabel__ACZHF",error:"admin-complaints_error__uaSfR",loading:"admin-complaints_loading__D4kEr",mainContent:"admin-complaints_mainContent__TAuB8",listPanel:"admin-complaints_listPanel__LqnrU",filterBar:"admin-complaints_filterBar__EmdVI",filterSelect:"admin-complaints_filterSelect__D6GTv",exportBtn:"admin-complaints_exportBtn__grQpC",complaintsList:"admin-complaints_complaintsList__oiNhV",complaintItem:"admin-complaints_complaintItem__U_Mts",selected:"admin-complaints_selected__gGio3",itemHeader:"admin-complaints_itemHeader__05p6Q",statusBadge:"admin-complaints_statusBadge__UAr51",itemType:"admin-complaints_itemType__Z3nsz",itemUser:"admin-complaints_itemUser__pR1qj",detailPanel:"admin-complaints_detailPanel___1LoM",detailContent:"admin-complaints_detailContent__qIM0f",detailInfo:"admin-complaints_detailInfo__MSMtf",descriptionBox:"admin-complaints_descriptionBox__jnd2i",updateForm:"admin-complaints_updateForm__5vaHv",formGroup:"admin-complaints_formGroup__VDOVk",submitBtn:"admin-complaints_submitBtn__i4iCO"}},94679:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(2772).createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/app/admin/complaints/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[3591,8559,3352,4175,5562,8154,6415],()=>s(33122));module.exports=a})();