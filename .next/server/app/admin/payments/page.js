(()=>{var e={};e.id=170,e.ids=[170],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},89422:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>c}),s(476),s(83517),s(24198),s(12874);var t=s(27105),r=s(15265),i=s(90157),n=s.n(i),l=s(44665),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(a,d);let c=["",{children:["admin",{children:["payments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,476)),"/Users/axelhernandez/Sorteos/frontend/src/app/admin/payments/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,83517)),"/Users/axelhernandez/Sorteos/frontend/src/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,24198)),"/Users/axelhernandez/Sorteos/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,12874,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/axelhernandez/Sorteos/frontend/src/app/admin/payments/page.tsx"],x="/admin/payments/page",p={require:s,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/payments/page",pathname:"/admin/payments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},69371:(e,a,s)=>{Promise.resolve().then(s.bind(s,61822))},61822:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>l});var t=s(19899),r=s(5507);s(42466);var i=s(51881),n=s.n(i);function l(){let[e,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[l,d]=(0,r.useState)(null),[c,o]=(0,r.useState)(0),[x,p]=(0,r.useState)(0),[u,m]=(0,r.useState)(""),[h,g]=(0,r.useState)(null),[j,f]=(0,r.useState)(!1),y=e=>({pending:"Pendiente",completed:"Completado",failed:"Fallido",refunded:"Reembolsado",cancelled:"Cancelado"})[e]||e,v=e=>{switch(e){case"completed":return n().success;case"pending":return n().warning;case"failed":case"cancelled":return n().danger;case"refunded":return n().info;default:return""}},b=e=>e?({stripe:"Stripe",mercado_pago:"Mercado Pago",paypal:"PayPal"})[e]||e:"N/A";return s&&0===e.length?t.jsx("div",{style:{textAlign:"center",padding:"40px"},children:t.jsx("p",{children:"Cargando transacciones..."})}):(0,t.jsxs)("div",{children:[t.jsx("h2",{style:{marginBottom:"20px",color:"#2c3e50"},children:"Gesti\xf3n de Transacciones"}),l&&t.jsx("div",{style:{padding:"15px",backgroundColor:"#f8d7da",color:"#721c24",borderRadius:"4px",marginBottom:"20px"},children:l}),t.jsx("div",{className:n().tableHeader,style:{marginBottom:"20px"},children:t.jsx("div",{className:n().filterContainer,children:(0,t.jsxs)("select",{className:n().filterSelect,value:u,onChange:e=>{m(e.target.value),o(0)},children:[t.jsx("option",{value:"",children:"Todos los estados"}),t.jsx("option",{value:"pending",children:"Pendiente"}),t.jsx("option",{value:"completed",children:"Completado"}),t.jsx("option",{value:"failed",children:"Fallido"}),t.jsx("option",{value:"refunded",children:"Reembolsado"}),t.jsx("option",{value:"cancelled",children:"Cancelado"})]})})}),0===e.length?t.jsx("div",{style:{textAlign:"center",padding:"40px",backgroundColor:"white",borderRadius:"8px"},children:t.jsx("p",{style:{color:"#7f8c8d"},children:"No hay transacciones registradas"})}):(0,t.jsxs)("div",{className:n().tableContainer,children:[(0,t.jsxs)("table",{children:[t.jsx("thead",{children:(0,t.jsxs)("tr",{children:[t.jsx("th",{children:"Usuario"}),t.jsx("th",{children:"Sorteo"}),t.jsx("th",{children:"Tienda"}),t.jsx("th",{children:"Monto"}),t.jsx("th",{children:"Tickets"}),t.jsx("th",{children:"M\xe9todo"}),t.jsx("th",{children:"Estado"}),t.jsx("th",{children:"Fecha"}),t.jsx("th",{children:"Acciones"})]})}),t.jsx("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{children:[t.jsx("td",{children:(0,t.jsxs)("div",{children:[t.jsx("p",{style:{margin:"0",fontWeight:"600",color:"#2c3e50"},children:e.user.name}),t.jsx("small",{style:{color:"#7f8c8d"},children:e.user.email})]})}),t.jsx("td",{children:(0,t.jsxs)("div",{children:[t.jsx("p",{style:{margin:"0",color:"#2c3e50"},children:e.raffle.product.name}),(0,t.jsxs)("small",{style:{color:"#7f8c8d"},children:["ID: ",e.raffle.id.substring(0,8),"..."]})]})}),t.jsx("td",{children:e.raffle.shop.name}),t.jsx("td",{children:(0,t.jsxs)("strong",{style:{color:"#27ae60"},children:["S/. ",Number(e.amount).toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),t.jsx("td",{children:e.ticketQuantity}),t.jsx("td",{children:b(e.paymentMethod)}),t.jsx("td",{children:t.jsx("span",{className:`${n().statusBadge} ${v(e.status)}`,children:y(e.status)})}),t.jsx("td",{children:new Date(e.createdAt).toLocaleDateString("es-PE",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),t.jsx("td",{children:t.jsx("div",{className:n().actionButtons,children:t.jsx("button",{className:`${n().btn} ${n().btnPrimary}`,onClick:()=>{g(e),f(!0)},children:"Ver"})})})]},e.id))})]}),(0,t.jsxs)("div",{className:n().pagination,children:[t.jsx("button",{className:n().paginationBtn,disabled:0===c,onClick:()=>o(c-1),children:"← Anterior"}),(0,t.jsxs)("span",{style:{padding:"8px 12px"},children:["P\xe1gina ",c+1," de ",Math.ceil(x/15)]}),t.jsx("button",{className:n().paginationBtn,disabled:c>=Math.ceil(x/15)-1,onClick:()=>o(c+1),children:"Siguiente →"})]})]}),j&&h&&t.jsx("div",{className:`${n().modal} ${j?n().open:""}`,children:(0,t.jsxs)("div",{className:n().modalContent,children:[t.jsx("div",{className:n().modalHeader,children:t.jsx("h2",{children:"Detalles de la Transacci\xf3n"})}),(0,t.jsxs)("div",{className:n().modalBody,children:[(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"ID de Transacci\xf3n"}),t.jsx("p",{style:{margin:"5px 0",color:"#2c3e50",wordBreak:"break-all"},children:h.id})]}),(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Usuario"}),(0,t.jsxs)("p",{style:{margin:"5px 0",color:"#2c3e50"},children:[h.user.name," (",h.user.email,")"]})]}),(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Sorteo"}),t.jsx("p",{style:{margin:"5px 0",color:"#2c3e50"},children:h.raffle.product.name}),(0,t.jsxs)("small",{style:{color:"#7f8c8d"},children:["ID: ",h.raffle.id]})]}),(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Tienda"}),t.jsx("p",{style:{margin:"5px 0",color:"#2c3e50"},children:h.raffle.shop.name})]}),(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Monto"}),(0,t.jsxs)("p",{style:{margin:"5px 0",color:"#27ae60",fontSize:"20px",fontWeight:"bold"},children:["S/. ",Number(h.amount).toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Cantidad de Tickets"}),t.jsx("p",{style:{margin:"5px 0",color:"#2c3e50"},children:h.ticketQuantity})]}),(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"M\xe9todo de Pago"}),t.jsx("p",{style:{margin:"5px 0",color:"#2c3e50"},children:b(h.paymentMethod)})]}),(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Estado"}),t.jsx("p",{style:{margin:"5px 0"},children:t.jsx("span",{className:`${n().statusBadge} ${v(h.status)}`,children:y(h.status)})})]}),h.externalTransactionId&&(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"ID de Transacci\xf3n Externa"}),t.jsx("p",{style:{margin:"5px 0",color:"#2c3e50",wordBreak:"break-all"},children:h.externalTransactionId})]}),h.failureReason&&(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Motivo de Fallo"}),t.jsx("p",{style:{margin:"5px 0",color:"#e74c3c"},children:h.failureReason})]}),(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Fecha de Creaci\xf3n"}),t.jsx("p",{style:{margin:"5px 0",color:"#2c3e50"},children:new Date(h.createdAt).toLocaleString("es-PE")})]}),h.completedAt&&(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Fecha de Completado"}),t.jsx("p",{style:{margin:"5px 0",color:"#2c3e50"},children:new Date(h.completedAt).toLocaleString("es-PE")})]}),h.failedAt&&(0,t.jsxs)("div",{className:n().formGroup,children:[t.jsx("label",{children:"Fecha de Fallo"}),t.jsx("p",{style:{margin:"5px 0",color:"#e74c3c"},children:new Date(h.failedAt).toLocaleString("es-PE")})]})]}),t.jsx("div",{className:n().modalFooter,children:t.jsx("button",{className:`${n().btn} ${n().btnSecondary}`,onClick:()=>f(!1),children:"Cerrar"})})]})})]})}},42466:(e,a,s)=>{"use strict";s.d(a,{d:()=>r});var t=s(10752);let r={getDashboardStats:async()=>(await t.x.get("/admin/dashboard/stats")).data,getPendingRaffles:async(e=50,a=0)=>(await t.x.get("/admin/raffles/pending",{params:{limit:e,offset:a}})).data,getActiveRaffles:async(e=50,a=0,s)=>(await t.x.get("/admin/raffles/active",{params:{limit:e,offset:a,...s&&{shopId:s}}})).data,getFinishedRaffles:async(e=50,a=0,s)=>(await t.x.get("/admin/raffles/finished",{params:{limit:e,offset:a,...s&&{shopId:s}}})).data,getRaffleDetail:async e=>(await t.x.get(`/admin/raffles/${e}`)).data,approveRaffle:async e=>(await t.x.put(`/admin/raffles/${e}/approve`,{})).data,rejectRaffle:async(e,a)=>(await t.x.put(`/admin/raffles/${e}/reject`,{reason:a})).data,cancelRaffle:async(e,a)=>(await t.x.put(`/admin/raffles/${e}/cancel`,{reason:a})).data,executeRaffle:async e=>(await t.x.put(`/admin/raffles/${e}/execute`,{})).data,getAllShops:async(e=50,a=0,s)=>(await t.x.get("/admin/shops",{params:{limit:e,offset:a,...s&&{status:s}}})).data,getShopDetail:async e=>(await t.x.get(`/admin/shops/${e}`)).data,changeShopStatus:async(e,a,s)=>(await t.x.put(`/admin/shops/${e}/status`,{status:a,...s&&{reason:s}})).data,getAllUsers:async(e=50,a=0,s)=>(await t.x.get("/admin/users",{params:{limit:e,offset:a,...s&&{role:s}}})).data,getUserDetail:async e=>(await t.x.get(`/admin/users/${e}`)).data,getAuditLogs:async(e=50,a=0,s)=>(await t.x.get("/admin/audit/logs",{params:{limit:e,offset:a,...s}})).data,getEntityAuditLogs:async(e,a)=>(await t.x.get(`/admin/audit/entity/${e}/${a}`)).data,getAllPayments:async(e=50,a=0,s)=>(await t.x.get("/admin/payments",{params:{limit:e,offset:a,...s?.status&&{status:s.status},...s?.userId&&{userId:s.userId},...s?.raffleId&&{raffleId:s.raffleId}}})).data,getPaymentDetail:async e=>(await t.x.get(`/admin/payments/${e}`)).data}},476:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>t});let t=(0,s(2772).createProxy)(String.raw`/Users/axelhernandez/Sorteos/frontend/src/app/admin/payments/page.tsx#default`)}};var a=require("../../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[3591,8559,3352,4175,5562,8154,6415],()=>s(89422));module.exports=t})();