"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/user-panel/won-raffles/page",{

/***/ "(app-pages-browser)/./src/services/email-service.ts":
/*!***************************************!*\
  !*** ./src/services/email-service.ts ***!
  \***************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   emailService: function() { return /* binding */ emailService; }\n/* harmony export */ });\n/**\n * Servicio de correos\n * Nota: Requiere configuración de Cloud Functions en Firebase\n * Para desarrollo, los correos se pueden simular o usar un servicio externo\n */ const emailService = {\n    /**\n   * Envía correo de confirmación de registro\n   */ async sendRegistrationEmail (data) {\n        try {\n            // Llamar a API backend para enviar correo\n            const response = await fetch(\"/api/emails/send-registration\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    email: data.email,\n                    name: data.name,\n                    username: data.email,\n                    password: data.password,\n                    role: data.role\n                })\n            });\n            if (!response.ok) {\n                console.warn(\"Error sending registration email:\", response.statusText);\n            }\n        } catch (error) {\n            console.error(\"Error sending registration email:\", error);\n        // No lanzar error para no bloquear el registro\n        }\n    },\n    /**\n   * Envía correo de recuperación de contraseña\n   */ async sendPasswordResetEmail (email) {\n        try {\n            const response = await fetch(\"/api/emails/send-password-reset\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    email\n                })\n            });\n            if (!response.ok) {\n                throw new Error(\"Error al enviar correo de recuperaci\\xf3n\");\n            }\n        } catch (error) {\n            console.error(\"Error sending password reset email:\", error);\n            throw new Error(\"Error al enviar correo de recuperaci\\xf3n\");\n        }\n    },\n    /**\n   * Envía correo de confirmación de cambio de contraseña\n   */ async sendPasswordChangeConfirmation (email, name) {\n        try {\n            const response = await fetch(\"/api/emails/send-password-change\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    email,\n                    name\n                })\n            });\n            if (!response.ok) {\n                console.warn(\"Error sending password change confirmation:\", response.statusText);\n            }\n        } catch (error) {\n            console.error(\"Error sending password change confirmation:\", error);\n        // No lanzar error para no bloquear el cambio de contraseña\n        }\n    }\n};\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9zZXJ2aWNlcy9lbWFpbC1zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFRQTs7OztDQUlDLEdBQ00sTUFBTUEsZUFBZTtJQUMxQjs7R0FFQyxHQUNELE1BQU1DLHVCQUFzQkMsSUFBMkI7UUFDckQsSUFBSTtZQUNGLDBDQUEwQztZQUMxQyxNQUFNQyxXQUFXLE1BQU1DLE1BQU0saUNBQWlDO2dCQUM1REMsUUFBUTtnQkFDUkMsU0FBUztvQkFDUCxnQkFBZ0I7Z0JBQ2xCO2dCQUNBQyxNQUFNQyxLQUFLQyxTQUFTLENBQUM7b0JBQ25CQyxPQUFPUixLQUFLUSxLQUFLO29CQUNqQkMsTUFBTVQsS0FBS1MsSUFBSTtvQkFDZkMsVUFBVVYsS0FBS1EsS0FBSztvQkFDcEJHLFVBQVVYLEtBQUtXLFFBQVE7b0JBQ3ZCQyxNQUFNWixLQUFLWSxJQUFJO2dCQUNqQjtZQUNGO1lBRUEsSUFBSSxDQUFDWCxTQUFTWSxFQUFFLEVBQUU7Z0JBQ2hCQyxRQUFRQyxJQUFJLENBQUMscUNBQXFDZCxTQUFTZSxVQUFVO1lBQ3ZFO1FBQ0YsRUFBRSxPQUFPQyxPQUFZO1lBQ25CSCxRQUFRRyxLQUFLLENBQUMscUNBQXFDQTtRQUNuRCwrQ0FBK0M7UUFDakQ7SUFDRjtJQUVBOztHQUVDLEdBQ0QsTUFBTUMsd0JBQXVCVixLQUFhO1FBQ3hDLElBQUk7WUFDRixNQUFNUCxXQUFXLE1BQU1DLE1BQU0sbUNBQW1DO2dCQUM5REMsUUFBUTtnQkFDUkMsU0FBUztvQkFDUCxnQkFBZ0I7Z0JBQ2xCO2dCQUNBQyxNQUFNQyxLQUFLQyxTQUFTLENBQUM7b0JBQUVDO2dCQUFNO1lBQy9CO1lBRUEsSUFBSSxDQUFDUCxTQUFTWSxFQUFFLEVBQUU7Z0JBQ2hCLE1BQU0sSUFBSU0sTUFBTTtZQUNsQjtRQUNGLEVBQUUsT0FBT0YsT0FBWTtZQUNuQkgsUUFBUUcsS0FBSyxDQUFDLHVDQUF1Q0E7WUFDckQsTUFBTSxJQUFJRSxNQUFNO1FBQ2xCO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQU1DLGdDQUErQlosS0FBYSxFQUFFQyxJQUFZO1FBQzlELElBQUk7WUFDRixNQUFNUixXQUFXLE1BQU1DLE1BQU0sb0NBQW9DO2dCQUMvREMsUUFBUTtnQkFDUkMsU0FBUztvQkFDUCxnQkFBZ0I7Z0JBQ2xCO2dCQUNBQyxNQUFNQyxLQUFLQyxTQUFTLENBQUM7b0JBQUVDO29CQUFPQztnQkFBSztZQUNyQztZQUVBLElBQUksQ0FBQ1IsU0FBU1ksRUFBRSxFQUFFO2dCQUNoQkMsUUFBUUMsSUFBSSxDQUFDLCtDQUErQ2QsU0FBU2UsVUFBVTtZQUNqRjtRQUNGLEVBQUUsT0FBT0MsT0FBWTtZQUNuQkgsUUFBUUcsS0FBSyxDQUFDLCtDQUErQ0E7UUFDN0QsMkRBQTJEO1FBQzdEO0lBQ0Y7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9zZXJ2aWNlcy9lbWFpbC1zZXJ2aWNlLnRzPzlmOWQiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGludGVyZmFjZSBSZWdpc3RyYXRpb25FbWFpbERhdGEge1xuICBlbWFpbDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHVzZXJuYW1lOiBzdHJpbmc7XG4gIHBhc3N3b3JkOiBzdHJpbmc7XG4gIHJvbGU6IHN0cmluZztcbn1cblxuLyoqXG4gKiBTZXJ2aWNpbyBkZSBjb3JyZW9zXG4gKiBOb3RhOiBSZXF1aWVyZSBjb25maWd1cmFjacOzbiBkZSBDbG91ZCBGdW5jdGlvbnMgZW4gRmlyZWJhc2VcbiAqIFBhcmEgZGVzYXJyb2xsbywgbG9zIGNvcnJlb3Mgc2UgcHVlZGVuIHNpbXVsYXIgbyB1c2FyIHVuIHNlcnZpY2lvIGV4dGVybm9cbiAqL1xuZXhwb3J0IGNvbnN0IGVtYWlsU2VydmljZSA9IHtcbiAgLyoqXG4gICAqIEVudsOtYSBjb3JyZW8gZGUgY29uZmlybWFjacOzbiBkZSByZWdpc3Ryb1xuICAgKi9cbiAgYXN5bmMgc2VuZFJlZ2lzdHJhdGlvbkVtYWlsKGRhdGE6IFJlZ2lzdHJhdGlvbkVtYWlsRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBMbGFtYXIgYSBBUEkgYmFja2VuZCBwYXJhIGVudmlhciBjb3JyZW9cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvZW1haWxzL3NlbmQtcmVnaXN0cmF0aW9uJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogZGF0YS5lbWFpbCxcbiAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgICAgdXNlcm5hbWU6IGRhdGEuZW1haWwsXG4gICAgICAgICAgcGFzc3dvcmQ6IGRhdGEucGFzc3dvcmQsXG4gICAgICAgICAgcm9sZTogZGF0YS5yb2xlLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignRXJyb3Igc2VuZGluZyByZWdpc3RyYXRpb24gZW1haWw6JywgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyByZWdpc3RyYXRpb24gZW1haWw6JywgZXJyb3IpO1xuICAgICAgLy8gTm8gbGFuemFyIGVycm9yIHBhcmEgbm8gYmxvcXVlYXIgZWwgcmVnaXN0cm9cbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEVudsOtYSBjb3JyZW8gZGUgcmVjdXBlcmFjacOzbiBkZSBjb250cmFzZcOxYVxuICAgKi9cbiAgYXN5bmMgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChlbWFpbDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvZW1haWxzL3NlbmQtcGFzc3dvcmQtcmVzZXQnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBlbWFpbCB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRXJyb3IgYWwgZW52aWFyIGNvcnJlbyBkZSByZWN1cGVyYWNpw7NuJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBwYXNzd29yZCByZXNldCBlbWFpbDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Vycm9yIGFsIGVudmlhciBjb3JyZW8gZGUgcmVjdXBlcmFjacOzbicpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogRW52w61hIGNvcnJlbyBkZSBjb25maXJtYWNpw7NuIGRlIGNhbWJpbyBkZSBjb250cmFzZcOxYVxuICAgKi9cbiAgYXN5bmMgc2VuZFBhc3N3b3JkQ2hhbmdlQ29uZmlybWF0aW9uKGVtYWlsOiBzdHJpbmcsIG5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2VtYWlscy9zZW5kLXBhc3N3b3JkLWNoYW5nZScsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGVtYWlsLCBuYW1lIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdFcnJvciBzZW5kaW5nIHBhc3N3b3JkIGNoYW5nZSBjb25maXJtYXRpb246JywgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBwYXNzd29yZCBjaGFuZ2UgY29uZmlybWF0aW9uOicsIGVycm9yKTtcbiAgICAgIC8vIE5vIGxhbnphciBlcnJvciBwYXJhIG5vIGJsb3F1ZWFyIGVsIGNhbWJpbyBkZSBjb250cmFzZcOxYVxuICAgIH1cbiAgfSxcbn07Il0sIm5hbWVzIjpbImVtYWlsU2VydmljZSIsInNlbmRSZWdpc3RyYXRpb25FbWFpbCIsImRhdGEiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZW1haWwiLCJuYW1lIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInJvbGUiLCJvayIsImNvbnNvbGUiLCJ3YXJuIiwic3RhdHVzVGV4dCIsImVycm9yIiwic2VuZFBhc3N3b3JkUmVzZXRFbWFpbCIsIkVycm9yIiwic2VuZFBhc3N3b3JkQ2hhbmdlQ29uZmlybWF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/services/email-service.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/services/firebase-auth-service.ts":
/*!***********************************************!*\
  !*** ./src/services/firebase-auth-service.ts ***!
  \***********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   firebaseAuthService: function() { return /* binding */ firebaseAuthService; }\n/* harmony export */ });\n/* harmony import */ var firebase_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/auth */ \"(app-pages-browser)/../node_modules/firebase/auth/dist/esm/index.esm.js\");\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase/firestore */ \"(app-pages-browser)/../node_modules/firebase/firestore/dist/esm/index.esm.js\");\n/* harmony import */ var _lib_firebase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/firebase */ \"(app-pages-browser)/./src/lib/firebase.ts\");\n/* harmony import */ var _types_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/types/auth */ \"(app-pages-browser)/./src/types/auth.ts\");\n/* harmony import */ var _email_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./email-service */ \"(app-pages-browser)/./src/services/email-service.ts\");\n\n\n\n\n\n/**\n * Convierte un FirebaseUser a nuestro tipo User\n */ const convertFirebaseUserToUser = async (firebaseUser)=>{\n    try {\n        var _firebaseUser_email;\n        // Obtener datos adicionales del usuario desde Firestore\n        const userDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.db, \"users\", firebaseUser.uid));\n        if (!userDoc.exists()) {\n            var _firebaseUser_email1;\n            // Si no existe el documento, crear uno básico\n            const basicUser = {\n                id: firebaseUser.uid,\n                name: firebaseUser.displayName || ((_firebaseUser_email1 = firebaseUser.email) === null || _firebaseUser_email1 === void 0 ? void 0 : _firebaseUser_email1.split(\"@\")[0]) || \"Usuario\",\n                email: firebaseUser.email || \"\",\n                role: _types_auth__WEBPACK_IMPORTED_MODULE_3__.UserRole.USER\n            };\n            return basicUser;\n        }\n        const userData = userDoc.data();\n        return {\n            id: firebaseUser.uid,\n            name: userData.name || firebaseUser.displayName || ((_firebaseUser_email = firebaseUser.email) === null || _firebaseUser_email === void 0 ? void 0 : _firebaseUser_email.split(\"@\")[0]) || \"Usuario\",\n            email: firebaseUser.email || \"\",\n            role: userData.role || _types_auth__WEBPACK_IMPORTED_MODULE_3__.UserRole.USER\n        };\n    } catch (error) {\n        var _firebaseUser_email2;\n        console.error(\"Error converting Firebase user:\", error);\n        // Retornar usuario básico si hay error\n        return {\n            id: firebaseUser.uid,\n            name: firebaseUser.displayName || ((_firebaseUser_email2 = firebaseUser.email) === null || _firebaseUser_email2 === void 0 ? void 0 : _firebaseUser_email2.split(\"@\")[0]) || \"Usuario\",\n            email: firebaseUser.email || \"\",\n            role: _types_auth__WEBPACK_IMPORTED_MODULE_3__.UserRole.USER\n        };\n    }\n};\nconst firebaseAuthService = {\n    /**\n   * Registra un nuevo usuario\n   */ async register (data) {\n        try {\n            // Crear usuario en Firebase Auth\n            const userCredential = await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_0__.createUserWithEmailAndPassword)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, data.email, data.password);\n            const firebaseUser = userCredential.user;\n            // Actualizar el perfil con el nombre\n            if (data.name) {\n                await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_0__.updateProfile)(firebaseUser, {\n                    displayName: data.name\n                });\n            }\n            // Obtener token de ID\n            const token = await firebaseUser.getIdToken();\n            // Crear documento de usuario en Firestore\n            const userData = {\n                name: data.name,\n                email: data.email,\n                role: data.role,\n                createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.serverTimestamp)(),\n                updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.serverTimestamp)()\n            };\n            // Si es una tienda, crear también el documento de la tienda\n            if (data.role === _types_auth__WEBPACK_IMPORTED_MODULE_3__.UserRole.SHOP && data.shopName) {\n                // Crear documento de tienda primero para obtener su ID\n                const shopData = {\n                    userId: firebaseUser.uid,\n                    name: data.shopName,\n                    description: \"\",\n                    status: \"pending\",\n                    createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.serverTimestamp)(),\n                    updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.serverTimestamp)()\n                };\n                // Crear tienda y obtener su ID\n                const shopRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.db, \"shops\"), shopData);\n                userData.shopId = shopRef.id;\n                // Crear el usuario con referencia a la tienda\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.setDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.db, \"users\", firebaseUser.uid), userData);\n            } else {\n                // Solo crear el usuario\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.setDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.db, \"users\", firebaseUser.uid), userData);\n            }\n            // Convertir a nuestro tipo User\n            const user = await convertFirebaseUserToUser(firebaseUser);\n            return {\n                user: user,\n                token\n            };\n        } catch (error) {\n            console.error(\"Error registering user:\", error);\n            let errorMessage = \"Error al registrar usuario\";\n            if (error.code === \"auth/email-already-in-use\") {\n                errorMessage = \"Este email ya est\\xe1 registrado\";\n            } else if (error.code === \"auth/invalid-email\") {\n                errorMessage = \"Email inv\\xe1lido\";\n            } else if (error.code === \"auth/weak-password\") {\n                errorMessage = \"La contrase\\xf1a debe tener al menos 6 caracteres\";\n            } else if (error.code === \"auth/operation-not-allowed\") {\n                errorMessage = \"El m\\xe9todo de autenticaci\\xf3n por email/password no est\\xe1 habilitado. Por favor, contacta al administrador.\";\n            } else if (error.code === \"auth/network-request-failed\") {\n                errorMessage = \"Error de conexi\\xf3n. Verifica tu conexi\\xf3n a internet.\";\n            } else if (error.message) {\n                errorMessage = error.message;\n            }\n            throw new Error(errorMessage);\n        }\n    },\n    /**\n   * Inicia sesión con email y contraseña\n   */ async login (data) {\n        try {\n            const userCredential = await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_0__.signInWithEmailAndPassword)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, data.email, data.password);\n            const firebaseUser = userCredential.user;\n            // Obtener token de ID\n            const token = await firebaseUser.getIdToken();\n            // Convertir a nuestro tipo User\n            const user = await convertFirebaseUserToUser(firebaseUser);\n            return {\n                user: user,\n                token\n            };\n        } catch (error) {\n            console.error(\"Error logging in:\", error);\n            let errorMessage = \"Error al iniciar sesi\\xf3n\";\n            if (error.code === \"auth/user-not-found\") {\n                errorMessage = \"Usuario no encontrado\";\n            } else if (error.code === \"auth/wrong-password\") {\n                errorMessage = \"Contrase\\xf1a incorrecta\";\n            } else if (error.code === \"auth/invalid-email\") {\n                errorMessage = \"Email inv\\xe1lido\";\n            } else if (error.code === \"auth/user-disabled\") {\n                errorMessage = \"Usuario deshabilitado\";\n            } else if (error.code === \"auth/too-many-requests\") {\n                errorMessage = \"Demasiados intentos. Intenta m\\xe1s tarde\";\n            } else if (error.code === \"auth/operation-not-allowed\") {\n                errorMessage = \"El m\\xe9todo de autenticaci\\xf3n por email/password no est\\xe1 habilitado. Por favor, contacta al administrador.\";\n            } else if (error.code === \"auth/network-request-failed\") {\n                errorMessage = \"Error de conexi\\xf3n. Verifica tu conexi\\xf3n a internet.\";\n            } else if (error.message) {\n                errorMessage = error.message;\n            }\n            throw new Error(errorMessage);\n        }\n    },\n    /**\n   * Cierra sesión\n   */ async logout () {\n        try {\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_0__.signOut)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.auth);\n        } catch (error) {\n            console.error(\"Error logging out:\", error);\n            throw error;\n        }\n    },\n    /**\n   * Obtiene el usuario actual\n   */ async getCurrentUser () {\n        try {\n            const firebaseUser = _lib_firebase__WEBPACK_IMPORTED_MODULE_2__.auth.currentUser;\n            if (!firebaseUser) {\n                return null;\n            }\n            return await convertFirebaseUserToUser(firebaseUser);\n        } catch (error) {\n            console.error(\"Error getting current user:\", error);\n            return null;\n        }\n    },\n    /**\n   * Obtiene el token del usuario actual\n   */ async getCurrentUserToken () {\n        try {\n            const firebaseUser = _lib_firebase__WEBPACK_IMPORTED_MODULE_2__.auth.currentUser;\n            if (!firebaseUser) {\n                return null;\n            }\n            return await firebaseUser.getIdToken();\n        } catch (error) {\n            console.error(\"Error getting token:\", error);\n            return null;\n        }\n    },\n    /**\n   * Escucha cambios en el estado de autenticación\n   */ onAuthStateChanged (callback) {\n        return (0,firebase_auth__WEBPACK_IMPORTED_MODULE_0__.onAuthStateChanged)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, async (firebaseUser)=>{\n            if (firebaseUser) {\n                const user = await convertFirebaseUserToUser(firebaseUser);\n                callback(user);\n            } else {\n                callback(null);\n            }\n        });\n    },\n    /**\n   * Cambia la contraseña del usuario actual\n   */ async changePassword (newPassword) {\n        try {\n            const firebaseUser = _lib_firebase__WEBPACK_IMPORTED_MODULE_2__.auth.currentUser;\n            if (!firebaseUser) {\n                throw new Error(\"No hay usuario autenticado\");\n            }\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_0__.updatePassword)(firebaseUser, newPassword);\n            // Enviar correo de confirmación\n            if (firebaseUser.email) {\n                const user = await convertFirebaseUserToUser(firebaseUser);\n                await _email_service__WEBPACK_IMPORTED_MODULE_4__.emailService.sendPasswordChangeConfirmation(firebaseUser.email, (user === null || user === void 0 ? void 0 : user.name) || \"Usuario\");\n            }\n        } catch (error) {\n            console.error(\"Error changing password:\", error);\n            let errorMessage = \"Error al cambiar la contrase\\xf1a\";\n            if (error.code === \"auth/weak-password\") {\n                errorMessage = \"La contrase\\xf1a debe tener al menos 6 caracteres\";\n            } else if (error.code === \"auth/requires-recent-login\") {\n                errorMessage = \"Por seguridad, debes iniciar sesi\\xf3n nuevamente para cambiar tu contrase\\xf1a\";\n            } else if (error.message) {\n                errorMessage = error.message;\n            }\n            throw new Error(errorMessage);\n        }\n    },\n    /**\n   * Envía correo de recuperación de contraseña\n   */ async sendPasswordReset (email) {\n        try {\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_0__.sendPasswordResetEmail)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.auth, email);\n            // Enviar correo adicional con información\n            await _email_service__WEBPACK_IMPORTED_MODULE_4__.emailService.sendPasswordResetEmail(email);\n        } catch (error) {\n            console.error(\"Error sending password reset:\", error);\n            let errorMessage = \"Error al enviar correo de recuperaci\\xf3n\";\n            if (error.code === \"auth/user-not-found\") {\n                errorMessage = \"Usuario no encontrado\";\n            } else if (error.code === \"auth/invalid-email\") {\n                errorMessage = \"Email inv\\xe1lido\";\n            } else if (error.message) {\n                errorMessage = error.message;\n            }\n            throw new Error(errorMessage);\n        }\n    },\n    /**\n   * Actualiza el nombre del usuario\n   */ async updateUserName (newName) {\n        try {\n            const firebaseUser = _lib_firebase__WEBPACK_IMPORTED_MODULE_2__.auth.currentUser;\n            if (!firebaseUser) {\n                throw new Error(\"No hay usuario autenticado\");\n            }\n            // Actualizar en Firebase Auth\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_0__.updateProfile)(firebaseUser, {\n                displayName: newName\n            });\n            // Actualizar en Firestore\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.setDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_2__.db, \"users\", firebaseUser.uid), {\n                name: newName,\n                updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.serverTimestamp)()\n            }, {\n                merge: true\n            });\n            // Retornar usuario actualizado\n            return await convertFirebaseUserToUser(firebaseUser);\n        } catch (error) {\n            console.error(\"Error updating user name:\", error);\n            throw new Error(\"Error al actualizar el nombre de usuario\");\n        }\n    }\n};\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9zZXJ2aWNlcy9maXJlYmFzZS1hdXRoLXNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBU3VCO0FBQ3VFO0FBQ3BEO0FBQ0k7QUFDQztBQWUvQzs7Q0FFQyxHQUNELE1BQU1rQiw0QkFBNEIsT0FBT0M7SUFDdkMsSUFBSTtZQWtCbURBO1FBakJyRCx3REFBd0Q7UUFDeEQsTUFBTUMsVUFBVSxNQUFNViwwREFBTUEsQ0FBQ0YsdURBQUdBLENBQUNPLDZDQUFFQSxFQUFFLFNBQVNJLGFBQWFFLEdBQUc7UUFFOUQsSUFBSSxDQUFDRCxRQUFRRSxNQUFNLElBQUk7Z0JBSWVIO1lBSHBDLDhDQUE4QztZQUM5QyxNQUFNSSxZQUFrQjtnQkFDdEJDLElBQUlMLGFBQWFFLEdBQUc7Z0JBQ3BCSSxNQUFNTixhQUFhTyxXQUFXLE1BQUlQLHVCQUFBQSxhQUFhUSxLQUFLLGNBQWxCUiwyQ0FBQUEscUJBQW9CUyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSTtnQkFDdkVELE9BQU9SLGFBQWFRLEtBQUssSUFBSTtnQkFDN0JFLE1BQU1iLGlEQUFRQSxDQUFDYyxJQUFJO1lBQ3JCO1lBQ0EsT0FBT1A7UUFDVDtRQUVBLE1BQU1RLFdBQVdYLFFBQVFZLElBQUk7UUFDN0IsT0FBTztZQUNMUixJQUFJTCxhQUFhRSxHQUFHO1lBQ3BCSSxNQUFNTSxTQUFTTixJQUFJLElBQUlOLGFBQWFPLFdBQVcsTUFBSVAsc0JBQUFBLGFBQWFRLEtBQUssY0FBbEJSLDBDQUFBQSxvQkFBb0JTLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFJO1lBQ3hGRCxPQUFPUixhQUFhUSxLQUFLLElBQUk7WUFDN0JFLE1BQU0sU0FBVUEsSUFBSSxJQUFpQmIsaURBQVFBLENBQUNjLElBQUk7UUFDcEQ7SUFDRixFQUFFLE9BQU9HLE9BQU87WUFLc0JkO1FBSnBDZSxRQUFRRCxLQUFLLENBQUMsbUNBQW1DQTtRQUNqRCx1Q0FBdUM7UUFDdkMs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YztnQkFDakIsTUFBTSxJQUFJb0MsTUFBTTtZQUNsQjtZQUVBLDhCQUE4QjtZQUM5QixNQUFNbkQsNERBQWFBLENBQUNlLGNBQWM7Z0JBQUVPLGFBQWF5QztZQUFRO1lBRXpELDBCQUEwQjtZQUMxQixNQUFNMUQsMERBQU1BLENBQ1ZELHVEQUFHQSxDQUFDTyw2Q0FBRUEsRUFBRSxTQUFTSSxhQUFhRSxHQUFHLEdBQ2pDO2dCQUFFSSxNQUFNMEM7Z0JBQVN4QixXQUFXaEMsbUVBQWVBO1lBQUcsR0FDOUM7Z0JBQUV5RCxPQUFPO1lBQUs7WUFHaEIsK0JBQStCO1lBQy9CLE9BQU8sTUFBTWxELDBCQUEwQkM7UUFDekMsRUFBRSxPQUFPYyxPQUFZO1lBQ25CQyxRQUFRRCxLQUFLLENBQUMsNkJBQTZCQTtZQUMzQyxNQUFNLElBQUlzQixNQUFNO1FBQ2xCO0lBQ0Y7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9zZXJ2aWNlcy9maXJlYmFzZS1hdXRoLXNlcnZpY2UudHM/MzFjOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQsXG4gIHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkLFxuICBzaWduT3V0LFxuICBvbkF1dGhTdGF0ZUNoYW5nZWQsXG4gIFVzZXIgYXMgRmlyZWJhc2VVc2VyLFxuICB1cGRhdGVQcm9maWxlLFxuICB1cGRhdGVQYXNzd29yZCxcbiAgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCBhcyBmaXJlYmFzZVNlbmRQYXNzd29yZFJlc2V0RW1haWwsXG59IGZyb20gJ2ZpcmViYXNlL2F1dGgnO1xuaW1wb3J0IHsgZG9jLCBzZXREb2MsIGdldERvYywgc2VydmVyVGltZXN0YW1wLCBjb2xsZWN0aW9uLCBhZGREb2MgfSBmcm9tICdmaXJlYmFzZS9maXJlc3RvcmUnO1xuaW1wb3J0IHsgYXV0aCwgZGIgfSBmcm9tICdAL2xpYi9maXJlYmFzZSc7XG5pbXBvcnQgeyBVc2VyLCBVc2VyUm9sZSB9IGZyb20gJ0AvdHlwZXMvYXV0aCc7XG5pbXBvcnQgeyBlbWFpbFNlcnZpY2UgfSBmcm9tICcuL2VtYWlsLXNlcnZpY2UnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFJlZ2lzdGVyRGF0YSB7XG4gIG5hbWU6IHN0cmluZztcbiAgZW1haWw6IHN0cmluZztcbiAgcGFzc3dvcmQ6IHN0cmluZztcbiAgcm9sZTogVXNlclJvbGU7XG4gIHNob3BOYW1lPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExvZ2luRGF0YSB7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIHBhc3N3b3JkOiBzdHJpbmc7XG59XG5cbi8qKlxuICogQ29udmllcnRlIHVuIEZpcmViYXNlVXNlciBhIG51ZXN0cm8gdGlwbyBVc2VyXG4gKi9cbmNvbnN0IGNvbnZlcnRGaXJlYmFzZVVzZXJUb1VzZXIgPSBhc3luYyAoZmlyZWJhc2VVc2VyOiBGaXJlYmFzZVVzZXIpOiBQcm9taXNlPFVzZXIgfCBudWxsPiA9PiB7XG4gIHRyeSB7XG4gICAgLy8gT2J0ZW5lciBkYXRvcyBhZGljaW9uYWxlcyBkZWwgdXN1YXJpbyBkZXNkZSBGaXJlc3RvcmVcbiAgICBjb25zdCB1c2VyRG9jID0gYXdhaXQgZ2V0RG9jKGRvYyhkYiwgJ3VzZXJzJywgZmlyZWJhc2VVc2VyLnVpZCkpO1xuICAgIFxuICAgIGlmICghdXNlckRvYy5leGlzdHMoKSkge1xuICAgICAgLy8gU2kgbm8gZXhpc3RlIGVsIGRvY3VtZW50bywgY3JlYXIgdW5vIGLDoXNpY29cbiAgICAgIGNvbnN0IGJhc2ljVXNlcjogVXNlciA9IHtcbiAgICAgICAgaWQ6IGZpcmViYXNlVXNlci51aWQsXG4gICAgICAgIG5hbWU6IGZpcmViYXNlVXNlci5kaXNwbGF5TmFtZSB8fCBmaXJlYmFzZVVzZXIuZW1haWw/LnNwbGl0KCdAJylbMF0gfHwgJ1VzdWFyaW8nLFxuICAgICAgICBlbWFpbDogZmlyZWJhc2VVc2VyLmVtYWlsIHx8ICcnLFxuICAgICAgICByb2xlOiBVc2VyUm9sZS5VU0VSLFxuICAgICAgfTtcbiAgICAgIHJldHVybiBiYXNpY1VzZXI7XG4gICAgfVxuXG4gICAgY29uc3QgdXNlckRhdGEgPSB1c2VyRG9jLmRhdGEoKTtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGZpcmViYXNlVXNlci51aWQsXG4gICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lIHx8IGZpcmViYXNlVXNlci5kaXNwbGF5TmFtZSB8fCBmaXJlYmFzZVVzZXIuZW1haWw/LnNwbGl0KCdAJylbMF0gfHwgJ1VzdWFyaW8nLFxuICAgICAgZW1haWw6IGZpcmViYXNlVXNlci5lbWFpbCB8fCAnJyxcbiAgICAgIHJvbGU6ICh1c2VyRGF0YS5yb2xlIGFzIFVzZXJSb2xlKSB8fCBVc2VyUm9sZS5VU0VSLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY29udmVydGluZyBGaXJlYmFzZSB1c2VyOicsIGVycm9yKTtcbiAgICAvLyBSZXRvcm5hciB1c3VhcmlvIGLDoXNpY28gc2kgaGF5IGVycm9yXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBmaXJlYmFzZVVzZXIudWlkLFxuICAgICAgbmFtZTogZmlyZWJhc2VVc2VyLmRpc3BsYXlOYW1lIHx8IGZpcmViYXNlVXNlci5lbWFpbD8uc3BsaXQoJ0AnKVswXSB8fCAnVXN1YXJpbycsXG4gICAgICBlbWFpbDogZmlyZWJhc2VVc2VyLmVtYWlsIHx8ICcnLFxuICAgICAgcm9sZTogVXNlclJvbGUuVVNFUixcbiAgICB9O1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZmlyZWJhc2VBdXRoU2VydmljZSA9IHtcbiAgLyoqXG4gICAqIFJlZ2lzdHJhIHVuIG51ZXZvIHVzdWFyaW9cbiAgICovXG4gIGFzeW5jIHJlZ2lzdGVyKGRhdGE6IFJlZ2lzdGVyRGF0YSk6IFByb21pc2U8eyB1c2VyOiBVc2VyOyB0b2tlbjogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQ3JlYXIgdXN1YXJpbyBlbiBGaXJlYmFzZSBBdXRoXG4gICAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBkYXRhLmVtYWlsLCBkYXRhLnBhc3N3b3JkKTtcbiAgICAgIGNvbnN0IGZpcmViYXNlVXNlciA9IHVzZXJDcmVkZW50aWFsLnVzZXI7XG5cbiAgICAgIC8vIEFjdHVhbGl6YXIgZWwgcGVyZmlsIGNvbiBlbCBub21icmVcbiAgICAgIGlmIChkYXRhLm5hbWUpIHtcbiAgICAgICAgYXdhaXQgdXBkYXRlUHJvZmlsZShmaXJlYmFzZVVzZXIsIHsgZGlzcGxheU5hbWU6IGRhdGEubmFtZSB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gT2J0ZW5lciB0b2tlbiBkZSBJRFxuICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBmaXJlYmFzZVVzZXIuZ2V0SWRUb2tlbigpO1xuXG4gICAgICAvLyBDcmVhciBkb2N1bWVudG8gZGUgdXN1YXJpbyBlbiBGaXJlc3RvcmVcbiAgICAgIGNvbnN0IHVzZXJEYXRhOiBhbnkgPSB7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgZW1haWw6IGRhdGEuZW1haWwsXG4gICAgICAgIHJvbGU6IGRhdGEucm9sZSxcbiAgICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgIH07XG5cbiAgICAgIC8vIFNpIGVzIHVuYSB0aWVuZGEsIGNyZWFyIHRhbWJpw6luIGVsIGRvY3VtZW50byBkZSBsYSB0aWVuZGFcbiAgICAgIGlmIChkYXRhLnJvbGUgPT09IFVzZXJSb2xlLlNIT1AgJiYgZGF0YS5zaG9wTmFtZSkge1xuICAgICAgICAvLyBDcmVhciBkb2N1bWVudG8gZGUgdGllbmRhIHByaW1lcm8gcGFyYSBvYnRlbmVyIHN1IElEXG4gICAgICAgIGNvbnN0IHNob3BEYXRhID0ge1xuICAgICAgICAgIHVzZXJJZDogZmlyZWJhc2VVc2VyLnVpZCxcbiAgICAgICAgICBuYW1lOiBkYXRhLnNob3BOYW1lLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJyxcbiAgICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKCksXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhciB0aWVuZGEgeSBvYnRlbmVyIHN1IElEXG4gICAgICAgIGNvbnN0IHNob3BSZWYgPSBhd2FpdCBhZGREb2MoY29sbGVjdGlvbihkYiwgJ3Nob3BzJyksIHNob3BEYXRhKTtcbiAgICAgICAgdXNlckRhdGEuc2hvcElkID0gc2hvcFJlZi5pZDtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWFyIGVsIHVzdWFyaW8gY29uIHJlZmVyZW5jaWEgYSBsYSB0aWVuZGFcbiAgICAgICAgYXdhaXQgc2V0RG9jKGRvYyhkYiwgJ3VzZXJzJywgZmlyZWJhc2VVc2VyLnVpZCksIHVzZXJEYXRhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFNvbG8gY3JlYXIgZWwgdXN1YXJpb1xuICAgICAgICBhd2FpdCBzZXREb2MoZG9jKGRiLCAndXNlcnMnLCBmaXJlYmFzZVVzZXIudWlkKSwgdXNlckRhdGEpO1xuICAgICAgfVxuXG4gICAgICAvLyBDb252ZXJ0aXIgYSBudWVzdHJvIHRpcG8gVXNlclxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGNvbnZlcnRGaXJlYmFzZVVzZXJUb1VzZXIoZmlyZWJhc2VVc2VyKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjogdXNlciEsXG4gICAgICAgIHRva2VuLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWdpc3RlcmluZyB1c2VyOicsIGVycm9yKTtcbiAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSAnRXJyb3IgYWwgcmVnaXN0cmFyIHVzdWFyaW8nO1xuICAgICAgXG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ2F1dGgvZW1haWwtYWxyZWFkeS1pbi11c2UnKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9ICdFc3RlIGVtYWlsIHlhIGVzdMOhIHJlZ2lzdHJhZG8nO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5jb2RlID09PSAnYXV0aC9pbnZhbGlkLWVtYWlsJykge1xuICAgICAgICBlcnJvck1lc3NhZ2UgPSAnRW1haWwgaW52w6FsaWRvJztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IuY29kZSA9PT0gJ2F1dGgvd2Vhay1wYXNzd29yZCcpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0xhIGNvbnRyYXNlw7FhIGRlYmUgdGVuZXIgYWwgbWVub3MgNiBjYXJhY3RlcmVzJztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IuY29kZSA9PT0gJ2F1dGgvb3BlcmF0aW9uLW5vdC1hbGxvd2VkJykge1xuICAgICAgICBlcnJvck1lc3NhZ2UgPSAnRWwgbcOpdG9kbyBkZSBhdXRlbnRpY2FjacOzbiBwb3IgZW1haWwvcGFzc3dvcmQgbm8gZXN0w6EgaGFiaWxpdGFkby4gUG9yIGZhdm9yLCBjb250YWN0YSBhbCBhZG1pbmlzdHJhZG9yLic7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLmNvZGUgPT09ICdhdXRoL25ldHdvcmstcmVxdWVzdC1mYWlsZWQnKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9ICdFcnJvciBkZSBjb25leGnDs24uIFZlcmlmaWNhIHR1IGNvbmV4acOzbiBhIGludGVybmV0Lic7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBJbmljaWEgc2VzacOzbiBjb24gZW1haWwgeSBjb250cmFzZcOxYVxuICAgKi9cbiAgYXN5bmMgbG9naW4oZGF0YTogTG9naW5EYXRhKTogUHJvbWlzZTx7IHVzZXI6IFVzZXI7IHRva2VuOiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGRhdGEuZW1haWwsIGRhdGEucGFzc3dvcmQpO1xuICAgICAgY29uc3QgZmlyZWJhc2VVc2VyID0gdXNlckNyZWRlbnRpYWwudXNlcjtcblxuICAgICAgLy8gT2J0ZW5lciB0b2tlbiBkZSBJRFxuICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBmaXJlYmFzZVVzZXIuZ2V0SWRUb2tlbigpO1xuXG4gICAgICAvLyBDb252ZXJ0aXIgYSBudWVzdHJvIHRpcG8gVXNlclxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGNvbnZlcnRGaXJlYmFzZVVzZXJUb1VzZXIoZmlyZWJhc2VVc2VyKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjogdXNlciEsXG4gICAgICAgIHRva2VuLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2dnaW5nIGluOicsIGVycm9yKTtcbiAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSAnRXJyb3IgYWwgaW5pY2lhciBzZXNpw7NuJztcbiAgICAgIFxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdhdXRoL3VzZXItbm90LWZvdW5kJykge1xuICAgICAgICBlcnJvck1lc3NhZ2UgPSAnVXN1YXJpbyBubyBlbmNvbnRyYWRvJztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IuY29kZSA9PT0gJ2F1dGgvd3JvbmctcGFzc3dvcmQnKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9ICdDb250cmFzZcOxYSBpbmNvcnJlY3RhJztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IuY29kZSA9PT0gJ2F1dGgvaW52YWxpZC1lbWFpbCcpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0VtYWlsIGludsOhbGlkbyc7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLmNvZGUgPT09ICdhdXRoL3VzZXItZGlzYWJsZWQnKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9ICdVc3VhcmlvIGRlc2hhYmlsaXRhZG8nO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5jb2RlID09PSAnYXV0aC90b28tbWFueS1yZXF1ZXN0cycpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0RlbWFzaWFkb3MgaW50ZW50b3MuIEludGVudGEgbcOhcyB0YXJkZSc7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLmNvZGUgPT09ICdhdXRoL29wZXJhdGlvbi1ub3QtYWxsb3dlZCcpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0VsIG3DqXRvZG8gZGUgYXV0ZW50aWNhY2nDs24gcG9yIGVtYWlsL3Bhc3N3b3JkIG5vIGVzdMOhIGhhYmlsaXRhZG8uIFBvciBmYXZvciwgY29udGFjdGEgYWwgYWRtaW5pc3RyYWRvci4nO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5jb2RlID09PSAnYXV0aC9uZXR3b3JrLXJlcXVlc3QtZmFpbGVkJykge1xuICAgICAgICBlcnJvck1lc3NhZ2UgPSAnRXJyb3IgZGUgY29uZXhpw7NuLiBWZXJpZmljYSB0dSBjb25leGnDs24gYSBpbnRlcm5ldC4nO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogQ2llcnJhIHNlc2nDs25cbiAgICovXG4gIGFzeW5jIGxvZ291dCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgc2lnbk91dChhdXRoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9nZ2luZyBvdXQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBPYnRpZW5lIGVsIHVzdWFyaW8gYWN0dWFsXG4gICAqL1xuICBhc3luYyBnZXRDdXJyZW50VXNlcigpOiBQcm9taXNlPFVzZXIgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZpcmViYXNlVXNlciA9IGF1dGguY3VycmVudFVzZXI7XG4gICAgICBpZiAoIWZpcmViYXNlVXNlcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhd2FpdCBjb252ZXJ0RmlyZWJhc2VVc2VyVG9Vc2VyKGZpcmViYXNlVXNlcik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgY3VycmVudCB1c2VyOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogT2J0aWVuZSBlbCB0b2tlbiBkZWwgdXN1YXJpbyBhY3R1YWxcbiAgICovXG4gIGFzeW5jIGdldEN1cnJlbnRVc2VyVG9rZW4oKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZpcmViYXNlVXNlciA9IGF1dGguY3VycmVudFVzZXI7XG4gICAgICBpZiAoIWZpcmViYXNlVXNlcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhd2FpdCBmaXJlYmFzZVVzZXIuZ2V0SWRUb2tlbigpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHRva2VuOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogRXNjdWNoYSBjYW1iaW9zIGVuIGVsIGVzdGFkbyBkZSBhdXRlbnRpY2FjacOzblxuICAgKi9cbiAgb25BdXRoU3RhdGVDaGFuZ2VkKGNhbGxiYWNrOiAodXNlcjogVXNlciB8IG51bGwpID0+IHZvaWQpOiAoKSA9PiB2b2lkIHtcbiAgICByZXR1cm4gb25BdXRoU3RhdGVDaGFuZ2VkKGF1dGgsIGFzeW5jIChmaXJlYmFzZVVzZXIpID0+IHtcbiAgICAgIGlmIChmaXJlYmFzZVVzZXIpIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGNvbnZlcnRGaXJlYmFzZVVzZXJUb1VzZXIoZmlyZWJhc2VVc2VyKTtcbiAgICAgICAgY2FsbGJhY2sodXNlcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogQ2FtYmlhIGxhIGNvbnRyYXNlw7FhIGRlbCB1c3VhcmlvIGFjdHVhbFxuICAgKi9cbiAgYXN5bmMgY2hhbmdlUGFzc3dvcmQobmV3UGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmaXJlYmFzZVVzZXIgPSBhdXRoLmN1cnJlbnRVc2VyO1xuICAgICAgaWYgKCFmaXJlYmFzZVVzZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBoYXkgdXN1YXJpbyBhdXRlbnRpY2FkbycpO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCB1cGRhdGVQYXNzd29yZChmaXJlYmFzZVVzZXIsIG5ld1Bhc3N3b3JkKTtcblxuICAgICAgLy8gRW52aWFyIGNvcnJlbyBkZSBjb25maXJtYWNpw7NuXG4gICAgICBpZiAoZmlyZWJhc2VVc2VyLmVtYWlsKSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjb252ZXJ0RmlyZWJhc2VVc2VyVG9Vc2VyKGZpcmViYXNlVXNlcik7XG4gICAgICAgIGF3YWl0IGVtYWlsU2VydmljZS5zZW5kUGFzc3dvcmRDaGFuZ2VDb25maXJtYXRpb24oXG4gICAgICAgICAgZmlyZWJhc2VVc2VyLmVtYWlsLFxuICAgICAgICAgIHVzZXI/Lm5hbWUgfHwgJ1VzdWFyaW8nXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2hhbmdpbmcgcGFzc3dvcmQ6JywgZXJyb3IpO1xuICAgICAgbGV0IGVycm9yTWVzc2FnZSA9ICdFcnJvciBhbCBjYW1iaWFyIGxhIGNvbnRyYXNlw7FhJztcblxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdhdXRoL3dlYWstcGFzc3dvcmQnKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9ICdMYSBjb250cmFzZcOxYSBkZWJlIHRlbmVyIGFsIG1lbm9zIDYgY2FyYWN0ZXJlcyc7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLmNvZGUgPT09ICdhdXRoL3JlcXVpcmVzLXJlY2VudC1sb2dpbicpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gJ1BvciBzZWd1cmlkYWQsIGRlYmVzIGluaWNpYXIgc2VzacOzbiBudWV2YW1lbnRlIHBhcmEgY2FtYmlhciB0dSBjb250cmFzZcOxYSc7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZTtcbiAgICAgIH1cblxuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBFbnbDrWEgY29ycmVvIGRlIHJlY3VwZXJhY2nDs24gZGUgY29udHJhc2XDsWFcbiAgICovXG4gIGFzeW5jIHNlbmRQYXNzd29yZFJlc2V0KGVtYWlsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZmlyZWJhc2VTZW5kUGFzc3dvcmRSZXNldEVtYWlsKGF1dGgsIGVtYWlsKTtcbiAgICAgIC8vIEVudmlhciBjb3JyZW8gYWRpY2lvbmFsIGNvbiBpbmZvcm1hY2nDs25cbiAgICAgIGF3YWl0IGVtYWlsU2VydmljZS5zZW5kUGFzc3dvcmRSZXNldEVtYWlsKGVtYWlsKTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZW5kaW5nIHBhc3N3b3JkIHJlc2V0OicsIGVycm9yKTtcbiAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSAnRXJyb3IgYWwgZW52aWFyIGNvcnJlbyBkZSByZWN1cGVyYWNpw7NuJztcblxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdhdXRoL3VzZXItbm90LWZvdW5kJykge1xuICAgICAgICBlcnJvck1lc3NhZ2UgPSAnVXN1YXJpbyBubyBlbmNvbnRyYWRvJztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IuY29kZSA9PT0gJ2F1dGgvaW52YWxpZC1lbWFpbCcpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0VtYWlsIGludsOhbGlkbyc7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZTtcbiAgICAgIH1cblxuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBBY3R1YWxpemEgZWwgbm9tYnJlIGRlbCB1c3VhcmlvXG4gICAqL1xuICBhc3luYyB1cGRhdGVVc2VyTmFtZShuZXdOYW1lOiBzdHJpbmcpOiBQcm9taXNlPFVzZXIgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZpcmViYXNlVXNlciA9IGF1dGguY3VycmVudFVzZXI7XG4gICAgICBpZiAoIWZpcmViYXNlVXNlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGhheSB1c3VhcmlvIGF1dGVudGljYWRvJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFjdHVhbGl6YXIgZW4gRmlyZWJhc2UgQXV0aFxuICAgICAgYXdhaXQgdXBkYXRlUHJvZmlsZShmaXJlYmFzZVVzZXIsIHsgZGlzcGxheU5hbWU6IG5ld05hbWUgfSk7XG5cbiAgICAgIC8vIEFjdHVhbGl6YXIgZW4gRmlyZXN0b3JlXG4gICAgICBhd2FpdCBzZXREb2MoXG4gICAgICAgIGRvYyhkYiwgJ3VzZXJzJywgZmlyZWJhc2VVc2VyLnVpZCksXG4gICAgICAgIHsgbmFtZTogbmV3TmFtZSwgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSB9LFxuICAgICAgICB7IG1lcmdlOiB0cnVlIH1cbiAgICAgICk7XG5cbiAgICAgIC8vIFJldG9ybmFyIHVzdWFyaW8gYWN0dWFsaXphZG9cbiAgICAgIHJldHVybiBhd2FpdCBjb252ZXJ0RmlyZWJhc2VVc2VyVG9Vc2VyKGZpcmViYXNlVXNlcik7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgdXNlciBuYW1lOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXJyb3IgYWwgYWN0dWFsaXphciBlbCBub21icmUgZGUgdXN1YXJpbycpO1xuICAgIH1cbiAgfSxcbn07Il0sIm5hbWVzIjpbImNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZCIsInNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkIiwic2lnbk91dCIsIm9uQXV0aFN0YXRlQ2hhbmdlZCIsInVwZGF0ZVByb2ZpbGUiLCJ1cGRhdGVQYXNzd29yZCIsInNlbmRQYXNzd29yZFJlc2V0RW1haWwiLCJmaXJlYmFzZVNlbmRQYXNzd29yZFJlc2V0RW1haWwiLCJkb2MiLCJzZXREb2MiLCJnZXREb2MiLCJzZXJ2ZXJUaW1lc3RhbXAiLCJjb2xsZWN0aW9uIiwiYWRkRG9jIiwiYXV0aCIsImRiIiwiVXNlclJvbGUiLCJlbWFpbFNlcnZpY2UiLCJjb252ZXJ0RmlyZWJhc2VVc2VyVG9Vc2VyIiwiZmlyZWJhc2VVc2VyIiwidXNlckRvYyIsInVpZCIsImV4aXN0cyIsImJhc2ljVXNlciIsImlkIiwibmFtZSIsImRpc3BsYXlOYW1lIiwiZW1haWwiLCJzcGxpdCIsInJvbGUiLCJVU0VSIiwidXNlckRhdGEiLCJkYXRhIiwiZXJyb3IiLCJjb25zb2xlIiwiZmlyZWJhc2VBdXRoU2VydmljZSIsInJlZ2lzdGVyIiwidXNlckNyZWRlbnRpYWwiLCJwYXNzd29yZCIsInVzZXIiLCJ0b2tlbiIsImdldElkVG9rZW4iLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJTSE9QIiwic2hvcE5hbWUiLCJzaG9wRGF0YSIsInVzZXJJZCIsImRlc2NyaXB0aW9uIiwic3RhdHVzIiwic2hvcFJlZiIsInNob3BJZCIsImVycm9yTWVzc2FnZSIsImNvZGUiLCJtZXNzYWdlIiwiRXJyb3IiLCJsb2dpbiIsImxvZ291dCIsImdldEN1cnJlbnRVc2VyIiwiY3VycmVudFVzZXIiLCJnZXRDdXJyZW50VXNlclRva2VuIiwiY2FsbGJhY2siLCJjaGFuZ2VQYXNzd29yZCIsIm5ld1Bhc3N3b3JkIiwic2VuZFBhc3N3b3JkQ2hhbmdlQ29uZmlybWF0aW9uIiwic2VuZFBhc3N3b3JkUmVzZXQiLCJ1cGRhdGVVc2VyTmFtZSIsIm5ld05hbWUiLCJtZXJnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/services/firebase-auth-service.ts\n"));

/***/ })

});