(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4624],{9634:function(e,t,r){Promise.resolve().then(r.bind(r,4219))},4219:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var a=r(7821),o=r(8078),s=r(7197),c=r(6289),i=r(9422),d=r(2379),n=r(692),l=r(1850),h=r(5959),u=r(6066),p=r(192),m=r.n(p);function g(){let{user:e,isAuthenticated:t}=(0,s.t)(),[r,p]=(0,o.useState)(null),[g,y]=(0,o.useState)([]),[v,x]=(0,o.useState)(!0),[w,f]=(0,o.useState)(null);(0,o.useEffect)(()=>{t&&e&&N()},[t,e]);let N=async()=>{x(!0),f(null);try{let e=await i.m.getMyShop();p(e);let t=await d._.getProductsByShop(e.id);y(t)}catch(r){var e,t;f((null===(t=r.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Error al cargar los datos")}finally{x(!1)}};return(0,a.jsx)(u.i,{requiredRole:c.i.SHOP,children:(0,a.jsxs)("div",{className:m().panelContainer,children:[(0,a.jsx)(l.G,{isBlocked:(null==r?void 0:r.status)==="blocked"}),(0,a.jsxs)("main",{className:m().mainContent,children:[v&&(0,a.jsx)("div",{className:m().alert,children:"Cargando datos..."}),w&&(0,a.jsxs)("div",{className:"".concat(m().alert," ").concat(m().alertError),children:[w,(0,a.jsx)("button",{onClick:N,className:m().primaryButton,style:{marginLeft:"10px"},children:"Reintentar"})]}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.N,{shop:r}),(0,a.jsxs)("div",{className:m().raffleDetail,children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,a.jsx)("h1",{className:m().raffleDetailTitle,style:{margin:0},children:"Mis productos"}),(0,a.jsx)("a",{href:"/panel/productos/crear",className:m().primaryButton,style:{textDecoration:"none"},children:"+ Crear producto"})]}),0===g.length?(0,a.jsx)(h.u,{title:"No tienes productos a\xfan",description:"Crea tu primer producto para poder crear sorteos.",icon:"\uD83D\uDCE6"}):(0,a.jsxs)("table",{className:m().table,children:[(0,a.jsx)("thead",{className:m().tableHeader,children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:m().tableHeaderCell,children:"Nombre"}),(0,a.jsx)("th",{className:m().tableHeaderCell,children:"Valor"}),(0,a.jsx)("th",{className:m().tableHeaderCell,children:"Dimensiones"}),(0,a.jsx)("th",{className:m().tableHeaderCell,children:"Dep\xf3sito"}),(0,a.jsx)("th",{className:m().tableHeaderCell,children:"Estado"}),(0,a.jsx)("th",{className:m().tableHeaderCell,children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:g.map(e=>(0,a.jsxs)("tr",{className:m().tableRow,children:[(0,a.jsx)("td",{className:m().tableCell,children:e.name}),(0,a.jsxs)("td",{className:m().tableCell,children:["S/. ",Number(e.value).toFixed(2)]}),(0,a.jsxs)("td",{className:m().tableCell,children:[Number(e.height).toFixed(1)," \xd7 ",Number(e.width).toFixed(1)," \xd7 ",Number(e.depth).toFixed(1)," cm"]}),(0,a.jsx)("td",{className:m().tableCell,children:e.requiresDeposit?"✓ S\xed":"✗ No"}),(0,a.jsx)("td",{className:m().tableCell,children:e.status}),(0,a.jsx)("td",{className:m().tableCell,children:(0,a.jsx)("a",{href:"/panel/productos/".concat(e.id,"/editar"),className:m().secondaryButton,style:{textDecoration:"none",padding:"5px 10px",fontSize:"12px"},children:"Editar"})})]},e.id))})]})]})]})]})]})})}},5959:function(e,t,r){"use strict";r.d(t,{u:function(){return c}});var a=r(7821),o=r(192),s=r.n(o);function c(e){let{title:t,description:r,icon:o,action:c}=e;return(0,a.jsxs)("div",{className:s().emptyState,children:[o&&(0,a.jsx)("div",{className:s().emptyStateIcon,children:o}),(0,a.jsx)("h3",{className:s().emptyStateTitle,children:t}),(0,a.jsx)("p",{className:s().emptyStateDescription,children:r}),c&&(0,a.jsx)("button",{className:s().primaryButton,onClick:c.onClick,children:c.label})]})}},2379:function(e,t,r){"use strict";r.d(t,{_:function(){return l}});var a,o,s=r(6534),c=r(6532);(a=o||(o={})).ACTIVE="active",a.INACTIVE="inactive",a.ARCHIVED="archived";let i=e=>(null==e?void 0:e.toDate)?e.toDate():e instanceof Date?e:"string"==typeof e?new Date(e):new Date,d=e=>{let t=e.data();return{id:e.id,shopId:t.shopId||"",name:t.name||"",description:t.description||"",value:t.value||0,height:t.height||0,width:t.width||0,depth:t.depth||0,requiresDeposit:t.requiresDeposit||!1,category:t.category,mainImage:t.mainImage,status:t.status||o.INACTIVE,createdAt:i(t.createdAt),updatedAt:i(t.updatedAt)}},n={async getProductsByShop(e){try{let t=(0,s.collection)(c.db,"products"),r=(0,s.query)(t,(0,s.where)("shopId","==",e),(0,s.where)("status","==",o.ACTIVE));return(await (0,s.getDocs)(r)).docs.map(e=>d(e)).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime())}catch(e){throw console.error("Error fetching products by shop:",e),e}},async getActiveProductsByShop(e){return this.getProductsByShop(e)},async getProductById(e){try{let t=await (0,s.getDoc)((0,s.doc)(c.db,"products",e));if(!t.exists())throw Error("Product not found");return d(t)}catch(e){throw console.error("Error fetching product:",e),e}},async getAllProducts(){try{let e=(0,s.collection)(c.db,"products"),t=(0,s.query)(e,(0,s.where)("status","==",o.ACTIVE));return(await (0,s.getDocs)(t)).docs.map(e=>d(e)).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime())}catch(e){throw console.error("Error fetching all products:",e),e}},async createProduct(e){try{let t=(0,s.collection)(c.db,"products"),r={shopId:e.shopId,name:e.name,description:e.description,value:e.value,height:e.height,width:e.width,depth:e.depth,requiresDeposit:e.height>15||e.width>15||e.depth>15,category:e.category||null,mainImage:e.mainImage||null,status:o.ACTIVE,createdAt:(0,s.serverTimestamp)(),updatedAt:(0,s.serverTimestamp)()},a=await (0,s.ET)(t,r),i=await (0,s.getDoc)(a);if(!i.exists())throw Error("Error al crear el producto");return d(i)}catch(e){throw console.error("Error creating product:",e),e}},async updateProduct(e,t){try{let r=(0,s.doc)(c.db,"products",e),a={updatedAt:(0,s.serverTimestamp)()};if(void 0!==t.name&&(a.name=t.name),void 0!==t.description&&(a.description=t.description),void 0!==t.value&&(a.value=t.value),void 0!==t.height&&(a.height=t.height),void 0!==t.width&&(a.width=t.width),void 0!==t.depth&&(a.depth=t.depth),void 0!==t.category&&(a.category=t.category),void 0!==t.mainImage&&(a.mainImage=t.mainImage),void 0!==t.height||void 0!==t.width||void 0!==t.depth){let e=await (0,s.getDoc)(r);if(e.exists()){let r=e.data(),o=void 0!==t.height?t.height:r.height,s=void 0!==t.width?t.width:r.width,c=void 0!==t.depth?t.depth:r.depth;a.requiresDeposit=o>15||s>15||c>15}}await (0,s.updateDoc)(r,a);let o=await (0,s.getDoc)(r);if(!o.exists())throw Error("Producto no encontrado");return d(o)}catch(e){throw console.error("Error updating product:",e),e}},async deactivateProduct(e){try{let t=(0,s.doc)(c.db,"products",e);await (0,s.updateDoc)(t,{status:o.INACTIVE,updatedAt:(0,s.serverTimestamp)()});let r=await (0,s.getDoc)(t);if(!r.exists())throw Error("Producto no encontrado");return d(r)}catch(e){throw console.error("Error deactivating product:",e),e}}},l={getProductsByShop:async e=>n.getProductsByShop(e),getActiveProductsByShop:async e=>n.getActiveProductsByShop(e),getProductById:async e=>n.getProductById(e),getAllProducts:async()=>n.getAllProducts(),createProduct:async e=>n.createProduct(e),updateProduct:async(e,t)=>n.updateProduct(e,t),deactivateProduct:async e=>n.deactivateProduct(e)}},9422:function(e,t,r){"use strict";r.d(t,{m:function(){return l}});var a=r(3404),o=r(6534),s=r(6532),c=r(9283);let i=e=>(null==e?void 0:e.toDate)?e.toDate():e instanceof Date?e:"string"==typeof e?new Date(e):new Date,d=e=>{let t=e.data();return{id:e.id,userId:t.userId||"",name:t.name||"",description:t.description,logo:t.logo,publicEmail:t.publicEmail,phone:t.phone,socialMedia:t.socialMedia,status:t.status||c.R.PENDING,createdAt:i(t.createdAt),updatedAt:i(t.updatedAt)}},n={async getShopById(e){try{let t=await (0,o.getDoc)((0,o.doc)(s.db,"shops",e));if(!t.exists())throw Error("Shop not found");return d(t)}catch(e){throw console.error("Error fetching shop:",e),e}},async getVerifiedShops(){try{let e=(0,o.collection)(s.db,"shops"),t=(0,o.query)(e,(0,o.where)("status","==",c.R.VERIFIED));return(await (0,o.getDocs)(t)).docs.map(e=>d(e)).sort((e,t)=>e.name.localeCompare(t.name))}catch(e){throw console.error("Error fetching verified shops:",e),e}},async getAllShops(){try{let e=(0,o.collection)(s.db,"shops");return(await (0,o.getDocs)(e)).docs.map(e=>d(e)).sort((e,t)=>e.name.localeCompare(t.name))}catch(e){throw console.error("Error fetching all shops:",e),e}}},l={getShopById:async e=>n.getShopById(e),getAllShops:async()=>n.getAllShops(),getVerifiedShops:async()=>n.getVerifiedShops(),getMyShop:async()=>(await a.x.get("/shops/my-shop/current")).data,updateShop:async(e,t)=>(await a.x.put("/shops/".concat(e),t)).data,getShopStatistics:async e=>(await a.x.get("/shops/".concat(e,"/statistics"))).data}},9283:function(e,t,r){"use strict";var a,o;r.d(t,{R:function(){return a}}),(o=a||(a={})).PENDING="pending",o.VERIFIED="verified",o.BLOCKED="blocked"}},function(e){e.O(0,[6438,2907,4183,1044,2489,8641,4755,4542,4446,7115,2364,1744],function(){return e(e.s=9634)}),_N_E=e.O()}]);