(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6993],{4629:function(e,a,s){Promise.resolve().then(s.bind(s,5681))},5681:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return x}});var t=s(7821),l=s(8078),i=s(7197),r=s(6289),n=s(9422),c=s(692),o=s(1850),d=s(9283),u=s(192),m=s.n(u),p=s(5975);function h(e){let{shop:a,onUpdate:s}=e,[i,r]=(0,l.useState)(!1),[c,o]=(0,l.useState)(a),[u,h]=(0,l.useState)(!1),[f,x]=(0,l.useState)(null);(0,l.useEffect)(()=>{o(a)},[a]);let v=e=>{let{name:a,value:s}=e.target;o(e=>({...e,[a]:s}))},N=async e=>{e.preventDefault(),h(!0),x(null);try{let e=await n.m.updateShop(a.id,{name:c.name,description:c.description,logo:c.logo,publicEmail:c.publicEmail,phone:c.phone,socialMedia:c.socialMedia});x({type:"success",text:"Tienda actualizada correctamente"}),s(e),r(!1)}catch(e){var t,l;x({type:"error",text:(null===(l=e.response)||void 0===l?void 0:null===(t=l.data)||void 0===t?void 0:t.message)||"Error al actualizar la tienda"})}finally{h(!1)}},j=()=>{switch(a.status){case d.R.PENDING:return"Tu tienda est\xe1 en revisi\xf3n. Nos pondremos en contacto pronto.";case d.R.BLOCKED:return"Tu tienda ha sido bloqueada. No puedes crear nuevos sorteos.";case d.R.VERIFIED:return"Tu tienda est\xe1 verificada y activa.";default:return""}};return(0,t.jsxs)("div",{className:m().raffleDetail,children:[(0,t.jsxs)("div",{className:m().raffleDetailHeader,children:[(0,t.jsx)("h1",{className:m().raffleDetailTitle,children:"Mi tienda"}),(0,t.jsx)(p.O,{status:a.status})]}),j()&&(0,t.jsx)("div",{className:"".concat(m().alert," ").concat(a.status===d.R.BLOCKED?m().alertError:m().alertInfo),children:j()}),f&&(0,t.jsx)("div",{className:"".concat(m().alert," ").concat("success"===f.type?m().alertSuccess:m().alertError),children:f.text}),i?(0,t.jsxs)("form",{onSubmit:N,className:m().profileForm,children:[(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{className:m().formLabel,children:"Nombre de la tienda"}),(0,t.jsx)("input",{type:"text",name:"name",value:c.name,onChange:v,className:m().formInput,required:!0})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{className:m().formLabel,children:"Descripci\xf3n"}),(0,t.jsx)("textarea",{name:"description",value:c.description||"",onChange:v,className:m().formTextarea})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{className:m().formLabel,children:"Logo (URL)"}),(0,t.jsx)("input",{type:"url",name:"logo",value:c.logo||"",onChange:v,className:m().formInput})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{className:m().formLabel,children:"Email p\xfablico"}),(0,t.jsx)("input",{type:"email",name:"publicEmail",value:c.publicEmail||"",onChange:v,className:m().formInput})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{className:m().formLabel,children:"Tel\xe9fono"}),(0,t.jsx)("input",{type:"tel",name:"phone",value:c.phone||"",onChange:v,className:m().formInput})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{className:m().formLabel,children:"Redes sociales"}),(0,t.jsx)("input",{type:"text",name:"socialMedia",value:c.socialMedia||"",onChange:v,className:m().formInput,placeholder:"@usuario o enlace"})]}),(0,t.jsxs)("div",{className:m().buttonGroup,children:[(0,t.jsx)("button",{type:"submit",className:m().primaryButton,disabled:u,children:u?"Guardando...":"Guardar cambios"}),(0,t.jsx)("button",{type:"button",className:m().secondaryButton,onClick:()=>{r(!1),o(a)},children:"Cancelar"})]})]}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:m().raffleDetailGrid,children:[(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[(0,t.jsx)("div",{className:m().raffleDetailItemLabel,children:"Nombre"}),(0,t.jsx)("div",{className:m().raffleDetailItemValue,children:a.name})]}),(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[(0,t.jsx)("div",{className:m().raffleDetailItemLabel,children:"Email p\xfablico"}),(0,t.jsx)("div",{className:m().raffleDetailItemValue,children:a.publicEmail||"No especificado"})]}),(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[(0,t.jsx)("div",{className:m().raffleDetailItemLabel,children:"Tel\xe9fono"}),(0,t.jsx)("div",{className:m().raffleDetailItemValue,children:a.phone||"No especificado"})]}),(0,t.jsxs)("div",{className:m().raffleDetailItem,children:[(0,t.jsx)("div",{className:m().raffleDetailItemLabel,children:"Redes sociales"}),(0,t.jsx)("div",{className:m().raffleDetailItemValue,children:a.socialMedia||"No especificado"})]})]}),a.description&&(0,t.jsxs)("div",{className:m().raffleDetailSection,children:[(0,t.jsx)("div",{className:m().raffleDetailSectionTitle,children:"Descripci\xf3n"}),(0,t.jsx)("p",{children:a.description})]}),a.status!==d.R.BLOCKED&&(0,t.jsx)("button",{className:m().primaryButton,onClick:()=>r(!0),children:"✏️ Editar informaci\xf3n"})]})]})}var f=s(6066);function x(){let{user:e,isAuthenticated:a}=(0,i.t)(),[s,d]=(0,l.useState)(null),[u,p]=(0,l.useState)(!0),[x,v]=(0,l.useState)(null);(0,l.useEffect)(()=>{a&&e&&N()},[a,e]);let N=async()=>{p(!0),v(null);try{let e=await n.m.getMyShop();d(e)}catch(s){var e,a;v((null===(a=s.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Error al cargar la tienda")}finally{p(!1)}};return(0,t.jsx)(f.i,{requiredRole:r.i.SHOP,children:(0,t.jsxs)("div",{className:m().panelContainer,children:[(0,t.jsx)(o.G,{isBlocked:(null==s?void 0:s.status)==="blocked"}),(0,t.jsxs)("main",{className:m().mainContent,children:[u&&(0,t.jsx)("div",{className:m().alert,children:"Cargando tienda..."}),x&&(0,t.jsxs)("div",{className:"".concat(m().alert," ").concat(m().alertError),children:[x,(0,t.jsx)("button",{onClick:N,className:m().primaryButton,style:{marginLeft:"10px"},children:"Reintentar"})]}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.N,{shop:s}),(0,t.jsx)(h,{shop:s,onUpdate:d})]})]})]})})}},5975:function(e,a,s){"use strict";s.d(a,{O:function(){return r}});var t=s(7821),l=s(192),i=s.n(l);function r(e){let{status:a}=e;return(0,t.jsx)("span",{className:i().statusBadge,style:{backgroundColor:(e=>{switch(e){case"pending":case"pending_approval":return"#FFA500";case"verified":case"active":return"#4CAF50";case"blocked":case"rejected":case"cancelled":return"#F44336";case"draft":return"#9E9E9E";case"sold_out":return"#2196F3";case"finished":return"#673AB7";default:return"#757575"}})(a)},children:{pending:"Pendiente",pending_approval:"Pendiente de aprobaci\xf3n",verified:"Verificada",blocked:"Bloqueada",active:"Activo",draft:"Borrador",sold_out:"Agotado",finished:"Finalizado",cancelled:"Cancelado",rejected:"Rechazado"}[a]||a})}},9422:function(e,a,s){"use strict";s.d(a,{m:function(){return d}});var t=s(3404),l=s(6534),i=s(6532),r=s(9283);let n=e=>(null==e?void 0:e.toDate)?e.toDate():e instanceof Date?e:"string"==typeof e?new Date(e):new Date,c=e=>{let a=e.data();return{id:e.id,userId:a.userId||"",name:a.name||"",description:a.description,logo:a.logo,publicEmail:a.publicEmail,phone:a.phone,socialMedia:a.socialMedia,status:a.status||r.R.PENDING,createdAt:n(a.createdAt),updatedAt:n(a.updatedAt)}},o={async getShopById(e){try{let a=await (0,l.getDoc)((0,l.doc)(i.db,"shops",e));if(!a.exists())throw Error("Shop not found");return c(a)}catch(e){throw console.error("Error fetching shop:",e),e}},async getVerifiedShops(){try{let e=(0,l.collection)(i.db,"shops"),a=(0,l.query)(e,(0,l.where)("status","==",r.R.VERIFIED));return(await (0,l.getDocs)(a)).docs.map(e=>c(e)).sort((e,a)=>e.name.localeCompare(a.name))}catch(e){throw console.error("Error fetching verified shops:",e),e}},async getAllShops(){try{let e=(0,l.collection)(i.db,"shops");return(await (0,l.getDocs)(e)).docs.map(e=>c(e)).sort((e,a)=>e.name.localeCompare(a.name))}catch(e){throw console.error("Error fetching all shops:",e),e}}},d={getShopById:async e=>o.getShopById(e),getAllShops:async()=>o.getAllShops(),getVerifiedShops:async()=>o.getVerifiedShops(),getMyShop:async()=>(await t.x.get("/shops/my-shop/current")).data,updateShop:async(e,a)=>(await t.x.put("/shops/".concat(e),a)).data,getShopStatistics:async e=>(await t.x.get("/shops/".concat(e,"/statistics"))).data}},9283:function(e,a,s){"use strict";var t,l;s.d(a,{R:function(){return t}}),(l=t||(t={})).PENDING="pending",l.VERIFIED="verified",l.BLOCKED="blocked"}},function(e){e.O(0,[6438,2907,4183,1044,2489,8641,4755,4542,4446,7115,2364,1744],function(){return e(e.s=4629)}),_N_E=e.O()}]);