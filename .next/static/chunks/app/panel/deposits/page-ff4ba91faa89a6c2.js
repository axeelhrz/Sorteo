(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7408],{289:function(e,a,t){Promise.resolve().then(t.bind(t,1401))},1401:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(7821),s=t(8078),n=t(7197),r=t(6289),i=t(4767),o=t(3404),c=t(692),d=t(1850),p=t(6066),_=t(192),u=t.n(_);function h(){let{user:e,isAuthenticated:a}=(0,n.t)(),[t,_]=(0,s.useState)(null),[h,m]=(0,s.useState)(!0),[f,x]=(0,s.useState)([]),[g,v]=(0,s.useState)(null),[j,C]=(0,s.useState)(null),[N,y]=(0,s.useState)("all");(0,s.useEffect)(()=>{a&&e&&b()},[a,e]),(0,s.useEffect)(()=>{t&&S()},[t,N]);let b=async()=>{try{let e=await i.m.getMyShop();_(e)}catch(t){var e,a;C((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Error al cargar la tienda"),m(!1)}},S=async()=>{try{let e;m(!0),e="all"===N?await o.x.get("/deposits"):await o.x.get("/deposits/by-status/".concat(N)),x(e.data||[]);let a=await o.x.get("/deposits/stats/overview");v(a.data),C(null)}catch(t){var e,a;C((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Error al cargar dep\xf3sitos")}finally{m(!1)}},D=e=>({pending:"#FFA500",held:"#F44336",released:"#4CAF50",executed:"#2196F3"})[e]||"#757575",I=e=>({pending:"Pendiente",held:"Retenido",released:"Liberado",executed:"Ejecutado"})[e]||e;return(0,l.jsx)(p.i,{requiredRole:r.i.SHOP,children:(0,l.jsxs)("div",{className:u().panelContainer,children:[(0,l.jsx)(d.G,{isBlocked:(null==t?void 0:t.status)==="blocked"}),(0,l.jsxs)("main",{className:u().mainContent,children:[h&&(0,l.jsx)("div",{className:u().alert,children:"Cargando..."}),j&&(0,l.jsxs)("div",{className:"".concat(u().alert," ").concat(u().alertError),children:[j,(0,l.jsx)("button",{onClick:S,className:u().primaryButton,style:{marginLeft:"10px"},children:"Reintentar"})]}),t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.N,{shop:t}),(0,l.jsxs)("div",{className:u().raffleDetail,children:[(0,l.jsx)("h1",{className:u().raffleDetailTitle,children:"Gesti\xf3n de Dep\xf3sitos de Garant\xeda"}),(0,l.jsx)("p",{style:{color:"#7f8c8d",marginBottom:"30px"},children:"Visualiza y gestiona todos tus dep\xf3sitos de garant\xeda"}),g&&(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px",marginBottom:"30px"},children:[(0,l.jsxs)("div",{className:u().statCard,children:[(0,l.jsx)("div",{className:u().statCardIcon,children:"\uD83D\uDCCA"}),(0,l.jsx)("div",{className:u().statCardValue,children:g.totalDeposits}),(0,l.jsx)("div",{className:u().statCardLabel,children:"Total de Dep\xf3sitos"})]}),(0,l.jsxs)("div",{className:u().statCard,children:[(0,l.jsx)("div",{className:u().statCardIcon,children:"\uD83D\uDCB0"}),(0,l.jsxs)("div",{className:u().statCardValue,children:["S/. ",g.totalAmount.toFixed(2)]}),(0,l.jsx)("div",{className:u().statCardLabel,children:"Monto Total"})]}),(0,l.jsxs)("div",{className:u().statCard,children:[(0,l.jsx)("div",{className:u().statCardIcon,children:"⏳"}),(0,l.jsx)("div",{className:u().statCardValue,children:g.byStatus.pending}),(0,l.jsx)("div",{className:u().statCardLabel,children:"Pendientes"}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#7f8c8d",marginTop:"5px"},children:["S/. ",g.amountByStatus.pending.toFixed(2)]})]}),(0,l.jsxs)("div",{className:u().statCard,children:[(0,l.jsx)("div",{className:u().statCardIcon,children:"\uD83D\uDD12"}),(0,l.jsx)("div",{className:u().statCardValue,children:g.byStatus.held}),(0,l.jsx)("div",{className:u().statCardLabel,children:"Retenidos"}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#7f8c8d",marginTop:"5px"},children:["S/. ",g.amountByStatus.held.toFixed(2)]})]}),(0,l.jsxs)("div",{className:u().statCard,children:[(0,l.jsx)("div",{className:u().statCardIcon,children:"✅"}),(0,l.jsx)("div",{className:u().statCardValue,children:g.byStatus.released}),(0,l.jsx)("div",{className:u().statCardLabel,children:"Liberados"}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#7f8c8d",marginTop:"5px"},children:["S/. ",g.amountByStatus.released.toFixed(2)]})]}),(0,l.jsxs)("div",{className:u().statCard,children:[(0,l.jsx)("div",{className:u().statCardIcon,children:"✓"}),(0,l.jsx)("div",{className:u().statCardValue,children:g.byStatus.executed}),(0,l.jsx)("div",{className:u().statCardLabel,children:"Ejecutados"}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#7f8c8d",marginTop:"5px"},children:["S/. ",g.amountByStatus.executed.toFixed(2)]})]})]}),(0,l.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,l.jsx)("label",{htmlFor:"statusFilter",className:u().formLabel,style:{marginRight:"10px"},children:"Filtrar por estado:"}),(0,l.jsxs)("select",{id:"statusFilter",value:N,onChange:e=>y(e.target.value),className:u().formSelect,style:{width:"auto",display:"inline-block"},children:[(0,l.jsx)("option",{value:"all",children:"Todos"}),(0,l.jsx)("option",{value:"pending",children:"Pendiente"}),(0,l.jsx)("option",{value:"held",children:"Retenido"}),(0,l.jsx)("option",{value:"released",children:"Liberado"}),(0,l.jsx)("option",{value:"executed",children:"Ejecutado"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{style:{marginBottom:"15px",fontSize:"18px",color:"#2c3e50"},children:"Historial de Dep\xf3sitos"}),0===f.length?(0,l.jsx)("div",{className:u().alert,style:{textAlign:"center"},children:"No hay dep\xf3sitos registrados"}):(0,l.jsxs)("table",{className:u().table,children:[(0,l.jsx)("thead",{className:u().tableHeader,children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:u().tableHeaderCell,children:"ID Dep\xf3sito"}),(0,l.jsx)("th",{className:u().tableHeaderCell,children:"Producto"}),(0,l.jsx)("th",{className:u().tableHeaderCell,children:"Monto"}),(0,l.jsx)("th",{className:u().tableHeaderCell,children:"Estado"}),(0,l.jsx)("th",{className:u().tableHeaderCell,children:"Fecha Creaci\xf3n"}),(0,l.jsx)("th",{className:u().tableHeaderCell,children:"Notas"})]})}),(0,l.jsx)("tbody",{children:f.map(e=>{var a,t;return(0,l.jsxs)("tr",{className:u().tableRow,children:[(0,l.jsx)("td",{className:u().tableCell,children:(0,l.jsxs)("strong",{children:[e.id.substring(0,8),"..."]})}),(0,l.jsx)("td",{className:u().tableCell,children:(null===(t=e.raffle)||void 0===t?void 0:null===(a=t.product)||void 0===a?void 0:a.name)||"N/A"}),(0,l.jsx)("td",{className:u().tableCell,children:(0,l.jsxs)("strong",{children:["S/. ",Number(e.amount).toFixed(2)]})}),(0,l.jsx)("td",{className:u().tableCell,children:(0,l.jsx)("span",{className:u().statusBadge,style:{backgroundColor:D(e.status)},children:I(e.status)})}),(0,l.jsx)("td",{className:u().tableCell,children:new Date(e.createdAt).toLocaleDateString("es-ES")}),(0,l.jsx)("td",{className:u().tableCell,style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis"},children:e.notes?e.notes.substring(0,50)+"...":"-"})]},e.id)})})]})]})]})]})]})]})})}},6066:function(e,a,t){"use strict";t.d(a,{i:function(){return i}});var l=t(7821),s=t(8078),n=t(8504),r=t(7197);function i(e){let{children:a,requiredRole:t}=e,i=(0,n.useRouter)(),{user:o,isAuthenticated:c}=(0,r.t)();return((0,s.useEffect)(()=>{if(!c||!o){i.push("/login");return}if(t&&o.role!==t){i.push("/");return}},[c,o,t,i]),c&&o)?t&&o.role!==t?(0,l.jsx)("div",{children:"No tienes permiso para acceder a esta p\xe1gina"}):(0,l.jsx)(l.Fragment,{children:a}):(0,l.jsx)("div",{children:"Cargando..."})}},692:function(e,a,t){"use strict";t.d(a,{N:function(){return r}});var l=t(7821),s=t(192),n=t.n(s);function r(e){let{shop:a}=e;return(0,l.jsx)("div",{className:n().shopHeader,children:(0,l.jsxs)("div",{className:n().shopHeaderContent,children:[a.logo&&(0,l.jsx)("img",{src:a.logo,alt:a.name,className:n().shopLogo}),(0,l.jsxs)("div",{className:n().shopHeaderInfo,children:[(0,l.jsx)("h1",{className:n().shopName,children:a.name}),(0,l.jsx)("p",{className:n().shopDescription,children:a.description})]})]})})}},1850:function(e,a,t){"use strict";t.d(a,{G:function(){return o}});var l=t(7821),s=t(4542),n=t(8504),r=t(192),i=t.n(r);function o(e){let{isBlocked:a=!1}=e,t=(0,n.usePathname)();return(0,l.jsx)("aside",{className:i().sidebar,children:(0,l.jsxs)("nav",{className:i().sidebarNav,children:[(0,l.jsx)(s.default,{href:"/panel/tienda",className:"".concat(i().navLink," ").concat("/panel/tienda"===t?i().active:""),children:"\uD83D\uDCCB Mi tienda"}),(0,l.jsx)(s.default,{href:"/panel/productos",className:"".concat(i().navLink," ").concat("/panel/productos"===t?i().active:""),children:"\uD83D\uDCE6 Mis productos"}),(0,l.jsx)(s.default,{href:"/panel/sorteos",className:"".concat(i().navLink," ").concat("/panel/sorteos"===t?i().active:""),children:"\uD83C\uDFB2 Mis sorteos"}),!a&&(0,l.jsx)(s.default,{href:"/panel/sorteos/crear",className:"".concat(i().navLink," ").concat("/panel/sorteos/crear"===t?i().active:""),children:"➕ Crear sorteo"})]})})}},3404:function(e,a,t){"use strict";t.d(a,{x:function(){return r}});var l=t(7147),s=t(9190);class n{async register(e){return this.client.post("/auth/register",e)}async login(e){return this.client.post("/auth/login",e)}async getProfile(){return this.client.get("/auth/profile")}async logout(){return this.client.post("/auth/logout")}async get(e,a){return this.client.get(e,a)}async post(e,a,t){return this.client.post(e,a,t)}async put(e,a){return this.client.put(e,a)}async delete(e){return this.client.delete(e)}constructor(){(0,l._)(this,"client",void 0),this.client=s.Z.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>{try{let a=localStorage.getItem("token");console.log("API Request - Token from localStorage:",a),a?(e.headers.Authorization="Bearer ".concat(a),console.log("API Request - Authorization header set:",e.headers.Authorization)):console.log("API Request - No token found"),e.data instanceof FormData&&delete e.headers["Content-Type"]}catch(e){console.error("Error reading token from localStorage:",e)}return e}),this.client.interceptors.response.use(e=>e,e=>{var a;return(null===(a=e.response)||void 0===a?void 0:a.status)===401&&localStorage.removeItem("token"),Promise.reject(e)})}}let r=new n},4767:function(e,a,t){"use strict";t.d(a,{m:function(){return s}});var l=t(3404);let s={getMyShop:async()=>(await l.x.get("/shops/my-shop/current")).data,getShopById:async e=>(await l.x.get("/shops/".concat(e))).data,updateShop:async(e,a)=>(await l.x.put("/shops/".concat(e),a)).data,getAllShops:async()=>(await l.x.get("/shops")).data,getVerifiedShops:async()=>(await l.x.get("/shops/verified")).data,getShopStatistics:async e=>(await l.x.get("/shops/".concat(e,"/statistics"))).data}},7197:function(e,a,t){"use strict";t.d(a,{t:function(){return n}});var l=t(3020),s=t(4302);let n=(0,l.Ue)()((0,s.tJ)(e=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,setUser:a=>e({user:a,isAuthenticated:!!a}),setToken:a=>{a?localStorage.setItem("token",a):localStorage.removeItem("token"),e({token:a})},setIsLoading:a=>e({isLoading:a}),setError:a=>e({error:a}),logout:()=>{localStorage.removeItem("token"),e({user:null,token:null,isAuthenticated:!1})}}),{name:"auth-store",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))},6289:function(e,a,t){"use strict";var l,s;t.d(a,{i:function(){return l}}),(s=l||(l={})).ADMIN="admin",s.SHOP="shop",s.USER="user"},192:function(e){e.exports={panelContainer:"panel_panelContainer__Kt8Ty",sidebar:"panel_sidebar__KeScH",sidebarNav:"panel_sidebarNav__KjeNV",navLink:"panel_navLink__sQoV6",active:"panel_active___ehGn",mainContent:"panel_mainContent__7V2fv",shopHeader:"panel_shopHeader__iRrDp",shopHeaderContent:"panel_shopHeaderContent__wsZnH",shopLogo:"panel_shopLogo__gTusz",shopHeaderInfo:"panel_shopHeaderInfo__IKOo3",shopName:"panel_shopName__lr5MU",shopDescription:"panel_shopDescription__zNvIE",statusBadge:"panel_statusBadge__37f3q",formGroup:"panel_formGroup__0UyVN",formLabel:"panel_formLabel___zOHD",formInput:"panel_formInput__bLzwR",formTextarea:"panel_formTextarea__B2MkI",formSelect:"panel_formSelect__thum_",primaryButton:"panel_primaryButton__ArDHW",secondaryButton:"panel_secondaryButton__KSKVI",dangerButton:"panel_dangerButton__2WLFi",buttonGroup:"panel_buttonGroup__pcyfD",card:"panel_card__ttDyJ",cardHeader:"panel_cardHeader__scyyA",cardTitle:"panel_cardTitle__K6V__",cardActions:"panel_cardActions___eqre",cardAction:"panel_cardAction__xpZWN",cardActionPrimary:"panel_cardActionPrimary__t_VOi",cardActionSecondary:"panel_cardActionSecondary__gcgLm",table:"panel_table__GBWH_",tableHeader:"panel_tableHeader__TN7va",tableHeaderCell:"panel_tableHeaderCell__WZypp",tableRow:"panel_tableRow__oR22e",tableCell:"panel_tableCell__GdQvd",tableCellCenter:"panel_tableCellCenter__Gc4za",tableCellRight:"panel_tableCellRight__jl067",emptyState:"panel_emptyState__1c4lK",emptyStateIcon:"panel_emptyStateIcon__znkGr",emptyStateTitle:"panel_emptyStateTitle__OpZSI",emptyStateDescription:"panel_emptyStateDescription__P3sK_",alert:"panel_alert__dbKCy",alertSuccess:"panel_alertSuccess__T39ZR",alertError:"panel_alertError__9DFT4",alertWarning:"panel_alertWarning__sOPwe",alertInfo:"panel_alertInfo__PLXx9",progressBar:"panel_progressBar__Ik7pm",progressBarFill:"panel_progressBarFill__NCwij",profileForm:"panel_profileForm__VbWs3",profileFormSection:"panel_profileFormSection__t80bQ",profileFormSectionTitle:"panel_profileFormSectionTitle__o8RW2",readOnlyField:"panel_readOnlyField___M4rQ",raffleForm:"panel_raffleForm__s3ll7",raffleFormSection:"panel_raffleFormSection__PUcJc",raffleFormSectionTitle:"panel_raffleFormSectionTitle__1DglO",dimensionsGrid:"panel_dimensionsGrid__7jafN",dimensionInfo:"panel_dimensionInfo__bjc2e",dimensionLabel:"panel_dimensionLabel__FAjKe",dimensionValue:"panel_dimensionValue__Jm7tM",depositWarning:"panel_depositWarning__mU2qE",ticketCalculation:"panel_ticketCalculation___d694",ticketCalculationValue:"panel_ticketCalculationValue__KOcl_",raffleDetail:"panel_raffleDetail__nigCY",raffleDetailHeader:"panel_raffleDetailHeader__xcVaX",raffleDetailTitle:"panel_raffleDetailTitle___LWvI",raffleDetailStatus:"panel_raffleDetailStatus__GBSlq",raffleDetailSection:"panel_raffleDetailSection__Y6dGR",raffleDetailSectionTitle:"panel_raffleDetailSectionTitle__6HXue",raffleDetailGrid:"panel_raffleDetailGrid__U8h9R",raffleDetailItem:"panel_raffleDetailItem__frOK2",raffleDetailItemLabel:"panel_raffleDetailItemLabel__PLUUN",raffleDetailItemValue:"panel_raffleDetailItemValue__mVKfw",ticketProgress:"panel_ticketProgress__9PZKW",ticketProgressLabel:"panel_ticketProgressLabel__fBS77",ticketProgressPercentage:"panel_ticketProgressPercentage__nBOhy",statCard:"panel_statCard__Dx3Sz",statCardIcon:"panel_statCardIcon__zp227",statCardValue:"panel_statCardValue__RWvG6",statCardLabel:"panel_statCardLabel__wRjrF",formHelpText:"panel_formHelpText__IpKar",formInputError:"panel_formInputError__oPd_O"}}},function(e){e.O(0,[6438,2489,4755,4542,7115,2364,1744],function(){return e(e.s=289)}),_N_E=e.O()}]);