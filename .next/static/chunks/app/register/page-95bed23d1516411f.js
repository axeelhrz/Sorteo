(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4011],{5002:function(e,r,a){Promise.resolve().then(a.bind(a,9316))},9730:function(e,r,a){"use strict";a.d(r,{Z:function(){return c}});var t=a(7821),o=a(8149),s=a(4542),i={src:"/_next/static/media/logo.4501bff6.png",height:1080,width:1080,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAz0lEQVR42mNgaFnGzAAFZnO3GZkDMYyPkDNtkpWbteVEyqr9/0FYdObmEwxc1bJwhXMOXTgx++D5/5P2nvk7Zd/Zv0uOXf4P5J+AyAb3Gi08eun/z99//i48cunf0uOX//3////vsuNX/jOE9QGti+g3Akr8BwlefPj839XHL8EKFhy5+J8hdiLEPTMOnDsBtOY/yHgg+++qk1f/zzt84QQDHGRMk7Wfv/2Ezuwt/5Vmbv6vNXvrCYbIfqgjp2+Ce7Nx23Gjms1HEd6csoEZAALjd67o7P0OAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},n=a(3616),l=a.n(n);function c(e){let{size:r="medium",showText:a=!0,className:n="",href:c="/"}=e,u=(0,t.jsxs)("div",{className:"".concat(l().logo," ").concat(l()[r]," ").concat(n),children:[(0,t.jsx)(o.default,{src:i,alt:"TIKETEA ONLINE",width:"small"===r?40:"medium"===r?60:80,height:"small"===r?40:"medium"===r?60:80,className:l().logoImage,priority:!0}),a&&(0,t.jsx)("span",{className:l().logoText,children:"TIKETEA ONLINE"})]});return c?(0,t.jsx)(s.default,{href:c,className:l().logoLink,children:u}):u}},9316:function(e,r,a){"use strict";a.d(r,{default:function(){return h}});var t=a(7821),o=a(8078),s=a(4542),i=a(8504),n=a(7851),l=a(5161),c=a(7197),u=a(9730),m=a(5171),d=a.n(m);function h(){let e=(0,i.useRouter)(),{setUser:r,setToken:a}=(0,c.t)(),[m,h]=(0,o.useState)({name:"",email:"",password:"",role:"user",shopName:""}),[g,p]=(0,o.useState)(""),[_,f]=(0,o.useState)(!1),b=e=>{let{name:r,value:a}=e.target;h(e=>({...e,[r]:a}))},N=async t=>{if(t.preventDefault(),p(""),"shop"===m.role&&!m.shopName.trim()){p("El nombre de la tienda es requerido");return}f(!0);try{let t={name:m.name,email:m.email,password:m.password,role:m.role,shopName:"shop"===m.role?m.shopName.trim():void 0},{user:o,token:s}=await l.Y.register(t);a(s),r(o),setTimeout(()=>{e.push("/dashboard")},100)}catch(e){p(e.message||"Error al registrarse")}finally{f(!1)}};return(0,t.jsx)("div",{className:d().container,children:(0,t.jsxs)("div",{className:d().formCard,children:[(0,t.jsx)(u.Z,{size:"medium",className:d().logo}),(0,t.jsx)("h2",{className:d().title,children:"Crear Cuenta"}),(0,t.jsx)("p",{className:d().subtitle,children:"\xdanete a nuestra plataforma y comienza a participar"}),g&&(0,t.jsx)("div",{className:d().errorMessage,children:g}),(0,t.jsxs)("form",{onSubmit:N,className:d().form,children:[(0,t.jsxs)("div",{className:d().formGroup,children:[(0,t.jsxs)("label",{htmlFor:"name",className:d().label,children:[(0,t.jsx)(n.fzv,{className:d().labelIcon}),"Nombre"]}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:m.name,onChange:b,required:!0,minLength:3,className:d().input,placeholder:"Tu nombre completo"})]}),(0,t.jsxs)("div",{className:d().formGroup,children:[(0,t.jsxs)("label",{htmlFor:"email",className:d().label,children:[(0,t.jsx)(n.Imn,{className:d().labelIcon}),"Email"]}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:m.email,onChange:b,required:!0,className:d().input,placeholder:"tu@email.com"})]}),(0,t.jsxs)("div",{className:d().formGroup,children:[(0,t.jsxs)("label",{htmlFor:"password",className:d().label,children:[(0,t.jsx)(n.UIZ,{className:d().labelIcon}),"Contrase\xf1a"]}),(0,t.jsx)("input",{type:"password",id:"password",name:"password",value:m.password,onChange:b,required:!0,minLength:8,className:d().input,placeholder:"M\xednimo 8 caracteres"})]}),(0,t.jsxs)("div",{className:d().formGroup,children:[(0,t.jsx)("label",{htmlFor:"role",className:d().label,children:"Tipo de cuenta"}),(0,t.jsxs)("select",{id:"role",name:"role",value:m.role,onChange:b,className:d().select,children:[(0,t.jsx)("option",{value:"user",children:"Usuario"}),(0,t.jsx)("option",{value:"shop",children:"Tienda"})]})]}),"shop"===m.role&&(0,t.jsxs)("div",{className:d().formGroup,children:[(0,t.jsxs)("label",{htmlFor:"shopName",className:d().label,children:[(0,t.jsx)(n.x8h,{className:d().labelIcon}),"Nombre de la Tienda"]}),(0,t.jsx)("input",{type:"text",id:"shopName",name:"shopName",value:m.shopName,onChange:b,required:!0,minLength:3,className:d().input,placeholder:"Ej: Mi Tienda de Sorteos"}),(0,t.jsx)("small",{className:d().helpText,children:"Este ser\xe1 el nombre de tu tienda en la plataforma"})]}),(0,t.jsx)("button",{type:"submit",disabled:_,className:d().submitButton,children:_?"Registrando...":(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.zy7,{className:d().buttonIcon}),"Crear Cuenta"]})})]}),(0,t.jsx)("div",{className:d().footer,children:(0,t.jsxs)("p",{className:d().footerText,children:["\xbfYa tienes una cuenta?"," ",(0,t.jsx)(s.default,{href:"/login",className:d().footerLink,children:"Inicia sesi\xf3n aqu\xed"})]})})]})})}},6532:function(e,r,a){"use strict";let t;a.d(r,{I8:function(){return c},db:function(){return l}});var o=a(1830),s=a(6534),i=a(1069),n=a(4304);t=0===(0,o.C6)().length?(0,o.ZF)({apiKey:"AIzaSyCROuDbFChzWrRSXQ42lih56oLEA1hjne4",authDomain:"sorteo-b8fb0.firebaseapp.com",projectId:"sorteo-b8fb0",storageBucket:"sorteo-b8fb0.firebasestorage.app",messagingSenderId:"58395659334",appId:"1:58395659334:web:58c8f46dab380710eb4e47"}):(0,o.C6)()[0];let l=(0,s.ad)(t);(0,i.cF)(t);let c=(0,n.v0)(t)},5161:function(e,r,a){"use strict";a.d(r,{Y:function(){return l}});var t=a(4304),o=a(6534),s=a(6532),i=a(6289);let n=async e=>{var r,a,t;try{let t=await (0,o.getDoc)((0,o.doc)(s.db,"users",e.uid));if(!t.exists())return{id:e.uid,name:e.displayName||(null===(a=e.email)||void 0===a?void 0:a.split("@")[0])||"Usuario",email:e.email||"",role:i.i.USER};let n=t.data();return{id:e.uid,name:n.name||e.displayName||(null===(r=e.email)||void 0===r?void 0:r.split("@")[0])||"Usuario",email:e.email||"",role:n.role||i.i.USER}}catch(r){return console.error("Error converting Firebase user:",r),{id:e.uid,name:e.displayName||(null===(t=e.email)||void 0===t?void 0:t.split("@")[0])||"Usuario",email:e.email||"",role:i.i.USER}}},l={async register(e){try{let r=(await (0,t.Xb)(s.I8,e.email,e.password)).user;e.name&&await (0,t.ck)(r,{displayName:e.name});let a=await r.getIdToken(),l={name:e.name,email:e.email,role:e.role,createdAt:(0,o.serverTimestamp)(),updatedAt:(0,o.serverTimestamp)()};if(e.role===i.i.SHOP&&e.shopName){let a={userId:r.uid,name:e.shopName,description:"",status:"pending",createdAt:(0,o.serverTimestamp)(),updatedAt:(0,o.serverTimestamp)()},t=await (0,o.ET)((0,o.collection)(s.db,"shops"),a);l.shopId=t.id,await (0,o.pl)((0,o.doc)(s.db,"users",r.uid),l)}else await (0,o.pl)((0,o.doc)(s.db,"users",r.uid),l);return{user:await n(r),token:a}}catch(r){console.error("Error registering user:",r);let e="Error al registrar usuario";throw"auth/email-already-in-use"===r.code?e="Este email ya est\xe1 registrado":"auth/invalid-email"===r.code?e="Email inv\xe1lido":"auth/weak-password"===r.code?e="La contrase\xf1a debe tener al menos 6 caracteres":"auth/operation-not-allowed"===r.code?e="El m\xe9todo de autenticaci\xf3n por email/password no est\xe1 habilitado. Por favor, contacta al administrador.":"auth/network-request-failed"===r.code?e="Error de conexi\xf3n. Verifica tu conexi\xf3n a internet.":r.message&&(e=r.message),Error(e)}},async login(e){try{let r=(await (0,t.e5)(s.I8,e.email,e.password)).user,a=await r.getIdToken();return{user:await n(r),token:a}}catch(r){console.error("Error logging in:",r);let e="Error al iniciar sesi\xf3n";throw"auth/user-not-found"===r.code?e="Usuario no encontrado":"auth/wrong-password"===r.code?e="Contrase\xf1a incorrecta":"auth/invalid-email"===r.code?e="Email inv\xe1lido":"auth/user-disabled"===r.code?e="Usuario deshabilitado":"auth/too-many-requests"===r.code?e="Demasiados intentos. Intenta m\xe1s tarde":"auth/operation-not-allowed"===r.code?e="El m\xe9todo de autenticaci\xf3n por email/password no est\xe1 habilitado. Por favor, contacta al administrador.":"auth/network-request-failed"===r.code?e="Error de conexi\xf3n. Verifica tu conexi\xf3n a internet.":r.message&&(e=r.message),Error(e)}},async logout(){try{await (0,t.w7)(s.I8)}catch(e){throw console.error("Error logging out:",e),e}},async getCurrentUser(){try{let e=s.I8.currentUser;if(!e)return null;return await n(e)}catch(e){return console.error("Error getting current user:",e),null}},async getCurrentUserToken(){try{let e=s.I8.currentUser;if(!e)return null;return await e.getIdToken()}catch(e){return console.error("Error getting token:",e),null}},onAuthStateChanged:e=>(0,t.Aj)(s.I8,async r=>{r?e(await n(r)):e(null)})}},7197:function(e,r,a){"use strict";a.d(r,{t:function(){return i}});var t=a(3020),o=a(4302),s=a(5161);let i=(0,t.Ue)()((0,o.tJ)((e,r)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,setUser:r=>e({user:r,isAuthenticated:!!r}),setToken:r=>{r?localStorage.setItem("token",r):localStorage.removeItem("token"),e({token:r})},setIsLoading:r=>e({isLoading:r}),setError:r=>e({error:r}),logout:async()=>{try{await s.Y.logout()}catch(e){console.error("Error logging out:",e)}finally{localStorage.removeItem("token"),e({user:null,token:null,isAuthenticated:!1})}},refreshToken:async()=>{try{let e=await s.Y.getCurrentUserToken();e&&r().setToken(e)}catch(e){console.error("Error refreshing token:",e)}}}),{name:"auth-store",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))},6289:function(e,r,a){"use strict";var t,o;a.d(r,{i:function(){return t}}),(o=t||(t={})).ADMIN="admin",o.SHOP="shop",o.USER="user"},3616:function(e){e.exports={logo:"Logo_logo__hia7S",logoLink:"Logo_logoLink__gM3sV",logoImage:"Logo_logoImage__daWgp",logoText:"Logo_logoText___NRG4",small:"Logo_small__digRM",medium:"Logo_medium__HI_Ok",large:"Logo_large__OX_7R",dark:"Logo_dark__vov1N"}},5171:function(e){e.exports={container:"RegisterForm_container__PXItq",logo:"RegisterForm_logo__Oe7l8",formCard:"RegisterForm_formCard__85zJy",title:"RegisterForm_title__5_yhQ",subtitle:"RegisterForm_subtitle__ferAR",form:"RegisterForm_form__uphLJ",formGroup:"RegisterForm_formGroup__lN_hv",label:"RegisterForm_label__pcttj",labelIcon:"RegisterForm_labelIcon__KEcvy",input:"RegisterForm_input___RUoH",select:"RegisterForm_select__RUIMH",helpText:"RegisterForm_helpText__V7TVV",submitButton:"RegisterForm_submitButton__ao_5X",buttonIcon:"RegisterForm_buttonIcon__cMnsi",errorMessage:"RegisterForm_errorMessage__Uoa9H",footer:"RegisterForm_footer__24861",footerText:"RegisterForm_footerText__zg9YR",footerLink:"RegisterForm_footerLink__AuLU5"}}},function(e){e.O(0,[9286,2907,4183,9134,1044,8641,4755,4542,6153,7115,2364,1744],function(){return e(e.s=5002)}),_N_E=e.O()}]);