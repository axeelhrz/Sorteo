(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626],{3392:function(e,r,a){Promise.resolve().then(a.bind(a,9057))},9057:function(e,r,a){"use strict";a.d(r,{default:function(){return g}});var t=a(7821),o=a(8078),i=a(4542),n=a(8504),s=a(7851),l=a(5161),u=a(7197),c=a(9730),d=a(6552),m=a.n(d);function g(){let e=(0,n.useRouter)(),{setUser:r,setToken:a}=(0,u.t)(),[d,g]=(0,o.useState)({email:"",password:""}),[h,_]=(0,o.useState)(""),[f,p]=(0,o.useState)(!1),b=e=>{let{name:r,value:a}=e.target;g(e=>({...e,[r]:a}))},A=async t=>{t.preventDefault(),_(""),p(!0);try{let{user:t,token:o}=await l.Y.login(d);a(o),r(t),setTimeout(()=>{e.push("/dashboard")},100)}catch(e){_(e.message||"Credenciales inv\xe1lidas")}finally{p(!1)}};return(0,t.jsx)("div",{className:m().container,children:(0,t.jsxs)("div",{className:m().formCard,children:[(0,t.jsx)(c.Z,{size:"medium",className:m().logo}),(0,t.jsx)("h2",{className:m().title,children:"Iniciar Sesi\xf3n"}),(0,t.jsx)("p",{className:m().subtitle,children:"Accede a tu cuenta para continuar"}),h&&(0,t.jsx)("div",{className:m().errorMessage,children:h}),(0,t.jsxs)("form",{onSubmit:A,className:m().form,children:[(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsxs)("label",{htmlFor:"email",className:m().label,children:[(0,t.jsx)(s.Imn,{className:m().labelIcon}),"Email"]}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:d.email,onChange:b,required:!0,className:m().input,placeholder:"tu@email.com"})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsxs)("label",{htmlFor:"password",className:m().label,children:[(0,t.jsx)(s.UIZ,{className:m().labelIcon}),"Contrase\xf1a"]}),(0,t.jsx)("input",{type:"password",id:"password",name:"password",value:d.password,onChange:b,required:!0,className:m().input,placeholder:"••••••••"})]}),(0,t.jsx)("button",{type:"submit",disabled:f,className:m().submitButton,children:f?"Iniciando sesi\xf3n...":(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s._fJ,{className:m().buttonIcon}),"Iniciar Sesi\xf3n"]})})]}),(0,t.jsx)("div",{className:m().footer,children:(0,t.jsxs)("p",{className:m().footerText,children:["\xbfNo tienes una cuenta?"," ",(0,t.jsx)(i.default,{href:"/register",className:m().footerLink,children:"Reg\xedstrate aqu\xed"})]})})]})})}},9730:function(e,r,a){"use strict";a.d(r,{Z:function(){return u}});var t=a(7821),o=a(8149),i=a(4542),n={src:"/_next/static/media/logo.4501bff6.png",height:1080,width:1080,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAz0lEQVR42mNgaFnGzAAFZnO3GZkDMYyPkDNtkpWbteVEyqr9/0FYdObmEwxc1bJwhXMOXTgx++D5/5P2nvk7Zd/Zv0uOXf4P5J+AyAb3Gi08eun/z99//i48cunf0uOX//3////vsuNX/jOE9QGti+g3Akr8BwlefPj839XHL8EKFhy5+J8hdiLEPTMOnDsBtOY/yHgg+++qk1f/zzt84QQDHGRMk7Wfv/2Ezuwt/5Vmbv6vNXvrCYbIfqgjp2+Ce7Nx23Gjms1HEd6csoEZAALjd67o7P0OAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},s=a(3616),l=a.n(s);function u(e){let{size:r="medium",showText:a=!0,className:s="",href:u="/"}=e,c=(0,t.jsxs)("div",{className:"".concat(l().logo," ").concat(l()[r]," ").concat(s),children:[(0,t.jsx)(o.default,{src:n,alt:"TIKETEA ONLINE",width:"small"===r?40:"medium"===r?60:80,height:"small"===r?40:"medium"===r?60:80,className:l().logoImage,priority:!0}),a&&(0,t.jsx)("span",{className:l().logoText,children:"TIKETEA ONLINE"})]});return u?(0,t.jsx)(i.default,{href:u,className:l().logoLink,children:c}):c}},6532:function(e,r,a){"use strict";let t;a.d(r,{I8:function(){return u},db:function(){return l}});var o=a(1830),i=a(6534),n=a(1069),s=a(4304);t=0===(0,o.C6)().length?(0,o.ZF)({apiKey:"AIzaSyCROuDbFChzWrRSXQ42lih56oLEA1hjne4",authDomain:"sorteo-b8fb0.firebaseapp.com",projectId:"sorteo-b8fb0",storageBucket:"sorteo-b8fb0.firebasestorage.app",messagingSenderId:"58395659334",appId:"1:58395659334:web:58c8f46dab380710eb4e47"}):(0,o.C6)()[0];let l=(0,i.ad)(t);(0,n.cF)(t);let u=(0,s.v0)(t)},5161:function(e,r,a){"use strict";a.d(r,{Y:function(){return l}});var t=a(4304),o=a(6534),i=a(6532),n=a(6289);let s=async e=>{var r,a,t;try{let t=await (0,o.getDoc)((0,o.doc)(i.db,"users",e.uid));if(!t.exists())return{id:e.uid,name:e.displayName||(null===(a=e.email)||void 0===a?void 0:a.split("@")[0])||"Usuario",email:e.email||"",role:n.i.USER};let s=t.data();return{id:e.uid,name:s.name||e.displayName||(null===(r=e.email)||void 0===r?void 0:r.split("@")[0])||"Usuario",email:e.email||"",role:s.role||n.i.USER}}catch(r){return console.error("Error converting Firebase user:",r),{id:e.uid,name:e.displayName||(null===(t=e.email)||void 0===t?void 0:t.split("@")[0])||"Usuario",email:e.email||"",role:n.i.USER}}},l={async register(e){try{let r=(await (0,t.Xb)(i.I8,e.email,e.password)).user;e.name&&await (0,t.ck)(r,{displayName:e.name});let a=await r.getIdToken(),l={name:e.name,email:e.email,role:e.role,createdAt:(0,o.serverTimestamp)(),updatedAt:(0,o.serverTimestamp)()};if(e.role===n.i.SHOP&&e.shopName){let a={userId:r.uid,name:e.shopName,description:"",status:"pending",createdAt:(0,o.serverTimestamp)(),updatedAt:(0,o.serverTimestamp)()},t=await (0,o.ET)((0,o.collection)(i.db,"shops"),a);l.shopId=t.id,await (0,o.pl)((0,o.doc)(i.db,"users",r.uid),l)}else await (0,o.pl)((0,o.doc)(i.db,"users",r.uid),l);return{user:await s(r),token:a}}catch(r){console.error("Error registering user:",r);let e="Error al registrar usuario";throw"auth/email-already-in-use"===r.code?e="Este email ya est\xe1 registrado":"auth/invalid-email"===r.code?e="Email inv\xe1lido":"auth/weak-password"===r.code?e="La contrase\xf1a debe tener al menos 6 caracteres":"auth/operation-not-allowed"===r.code?e="El m\xe9todo de autenticaci\xf3n por email/password no est\xe1 habilitado. Por favor, contacta al administrador.":"auth/network-request-failed"===r.code?e="Error de conexi\xf3n. Verifica tu conexi\xf3n a internet.":r.message&&(e=r.message),Error(e)}},async login(e){try{let r=(await (0,t.e5)(i.I8,e.email,e.password)).user,a=await r.getIdToken();return{user:await s(r),token:a}}catch(r){console.error("Error logging in:",r);let e="Error al iniciar sesi\xf3n";throw"auth/user-not-found"===r.code?e="Usuario no encontrado":"auth/wrong-password"===r.code?e="Contrase\xf1a incorrecta":"auth/invalid-email"===r.code?e="Email inv\xe1lido":"auth/user-disabled"===r.code?e="Usuario deshabilitado":"auth/too-many-requests"===r.code?e="Demasiados intentos. Intenta m\xe1s tarde":"auth/operation-not-allowed"===r.code?e="El m\xe9todo de autenticaci\xf3n por email/password no est\xe1 habilitado. Por favor, contacta al administrador.":"auth/network-request-failed"===r.code?e="Error de conexi\xf3n. Verifica tu conexi\xf3n a internet.":r.message&&(e=r.message),Error(e)}},async logout(){try{await (0,t.w7)(i.I8)}catch(e){throw console.error("Error logging out:",e),e}},async getCurrentUser(){try{let e=i.I8.currentUser;if(!e)return null;return await s(e)}catch(e){return console.error("Error getting current user:",e),null}},async getCurrentUserToken(){try{let e=i.I8.currentUser;if(!e)return null;return await e.getIdToken()}catch(e){return console.error("Error getting token:",e),null}},onAuthStateChanged:e=>(0,t.Aj)(i.I8,async r=>{r?e(await s(r)):e(null)})}},7197:function(e,r,a){"use strict";a.d(r,{t:function(){return n}});var t=a(3020),o=a(4302),i=a(5161);let n=(0,t.Ue)()((0,o.tJ)((e,r)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,setUser:r=>e({user:r,isAuthenticated:!!r}),setToken:r=>{r?localStorage.setItem("token",r):localStorage.removeItem("token"),e({token:r})},setIsLoading:r=>e({isLoading:r}),setError:r=>e({error:r}),logout:async()=>{try{await i.Y.logout()}catch(e){console.error("Error logging out:",e)}finally{localStorage.removeItem("token"),e({user:null,token:null,isAuthenticated:!1})}},refreshToken:async()=>{try{let e=await i.Y.getCurrentUserToken();e&&r().setToken(e)}catch(e){console.error("Error refreshing token:",e)}}}),{name:"auth-store",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))},6289:function(e,r,a){"use strict";var t,o;a.d(r,{i:function(){return t}}),(o=t||(t={})).ADMIN="admin",o.SHOP="shop",o.USER="user"},6552:function(e){e.exports={container:"LoginForm_container__AKO7c",logo:"LoginForm_logo__RVlkg",formCard:"LoginForm_formCard__hhe9G",title:"LoginForm_title__fcaaz",subtitle:"LoginForm_subtitle__hAWHa",form:"LoginForm_form__576t0",formGroup:"LoginForm_formGroup__ydMA6",label:"LoginForm_label__JxNP_",labelIcon:"LoginForm_labelIcon__AuVOK",input:"LoginForm_input__ZtjDD",submitButton:"LoginForm_submitButton__rUG7w",buttonIcon:"LoginForm_buttonIcon__QYcE8",errorMessage:"LoginForm_errorMessage__UL3qF",footer:"LoginForm_footer__aprEN",footerText:"LoginForm_footerText__IXxLw",footerLink:"LoginForm_footerLink__SqT2g"}},3616:function(e){e.exports={logo:"Logo_logo__hia7S",logoLink:"Logo_logoLink__gM3sV",logoImage:"Logo_logoImage__daWgp",logoText:"Logo_logoText___NRG4",small:"Logo_small__digRM",medium:"Logo_medium__HI_Ok",large:"Logo_large__OX_7R",dark:"Logo_dark__vov1N"}}},function(e){e.O(0,[9286,2907,4183,9134,1044,8641,4755,4542,6153,7115,2364,1744],function(){return e(e.s=3392)}),_N_E=e.O()}]);