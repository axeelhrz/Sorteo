(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4372],{8844:function(e,s,a){Promise.resolve().then(a.bind(a,395))},395:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return N}});var t=a(7821),r=a(8078),l=a(4542),o=a(8149),n=a(6030),i=a(4176),c=a.n(i);function d(e){var s,a,r;let{raffle:i}=e,d=i.soldTickets/i.totalTickets*100,u=i.totalTickets-i.soldTickets;return(0,t.jsx)(l.default,{href:"/sorteos/".concat(i.id),children:(0,t.jsxs)("div",{className:c().card,children:[(0,t.jsxs)("div",{className:c().imageContainer,children:[(null===(s=i.product)||void 0===s?void 0:s.mainImage)?(0,t.jsx)(o.default,{src:i.product.mainImage,alt:i.product.name,fill:!0,className:c().image,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}):(0,t.jsx)("div",{className:c().imagePlaceholder,children:(0,t.jsx)("span",{children:"Sin imagen"})}),(()=>{switch(i.status){case n.r.ACTIVE:return(0,t.jsx)("span",{className:"".concat(c().badge," ").concat(c().badgeActive),children:"Activo"});case n.r.SOLD_OUT:return(0,t.jsx)("span",{className:"".concat(c().badge," ").concat(c().badgeSoldOut),children:"Agotado"});case n.r.FINISHED:return(0,t.jsx)("span",{className:"".concat(c().badge," ").concat(c().badgeFinished),children:"Finalizado"});default:return null}})()]}),(0,t.jsxs)("div",{className:c().content,children:[(0,t.jsxs)("div",{className:c().productInfo,children:[(0,t.jsx)("h3",{className:c().productName,children:(null===(a=i.product)||void 0===a?void 0:a.name)||"Producto"}),(0,t.jsx)("p",{className:c().shopName,children:(null===(r=i.shop)||void 0===r?void 0:r.name)||"Tienda"})]}),(0,t.jsxs)("div",{className:c().value,children:[(0,t.jsx)("span",{className:c().valueLabel,children:"Valor del producto"}),(0,t.jsxs)("span",{className:c().valueAmount,children:["S/ ",Number(i.productValue).toFixed(2)]})]}),(0,t.jsxs)("div",{className:c().progressSection,children:[(0,t.jsxs)("div",{className:c().progressHeader,children:[(0,t.jsx)("span",{className:c().progressLabel,children:"Tickets vendidos"}),(0,t.jsxs)("span",{className:c().progressCount,children:[i.soldTickets," de ",i.totalTickets]})]}),(0,t.jsx)("div",{className:c().progressBar,children:(0,t.jsx)("div",{className:c().progressFill,style:{width:"".concat(Math.min(d,100),"%")}})}),(0,t.jsxs)("div",{className:c().progressFooter,children:[(0,t.jsx)("span",{className:c().remainingTickets,children:u>0?"".concat(u," tickets disponibles"):"Todos los tickets vendidos"}),(0,t.jsxs)("span",{className:c().progressPercent,children:[Math.round(d),"%"]})]})]}),(0,t.jsx)("button",{className:c().ctaButton,children:i.status===n.r.ACTIVE?"Ver sorteo":"Ver detalles"})]})]})})}var u=a(472),p=a.n(u);function _(e){let{onFiltersChange:s,categories:a=[],shops:l=[],isLoading:o=!1}=e,[n,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[u,_]=(0,r.useState)(""),[h,m]=(0,r.useState)(""),[f,g]=(0,r.useState)(""),[v,x]=(0,r.useState)(""),[j,N]=(0,r.useState)("newest"),[b,R]=(0,r.useState)(!1),C=(0,r.useCallback)(()=>{s({search:n||void 0,category:c||void 0,shopId:u||void 0,status:h||void 0,minValue:f?parseFloat(f):void 0,maxValue:v?parseFloat(v):void 0,sortBy:j,page:1})},[n,c,u,h,f,v,j,s]);return(0,t.jsxs)("div",{className:p().container,children:[(0,t.jsx)("form",{onSubmit:e=>{e.preventDefault(),C()},className:p().searchForm,children:(0,t.jsxs)("div",{className:p().searchInputWrapper,children:[(0,t.jsx)("input",{type:"text",placeholder:"Buscar por nombre de producto, sorteo o tienda...",value:n,onChange:e=>i(e.target.value),className:p().searchInput,disabled:o}),(0,t.jsx)("button",{type:"submit",className:p().searchButton,disabled:o,children:(0,t.jsx)("span",{children:"\uD83D\uDD0D"})})]})}),(0,t.jsxs)("div",{className:p().controlsRow,children:[(0,t.jsxs)("div",{className:p().sortControl,children:[(0,t.jsx)("label",{htmlFor:"sortBy",className:p().label,children:"Ordenar por:"}),(0,t.jsxs)("select",{id:"sortBy",value:j,onChange:e=>{N(e.target.value),s({sortBy:e.target.value,page:1})},className:p().select,disabled:o,children:[(0,t.jsx)("option",{value:"newest",children:"M\xe1s recientes"}),(0,t.jsx)("option",{value:"closest",children:"M\xe1s cerca de completarse"}),(0,t.jsx)("option",{value:"price-asc",children:"Menor precio"}),(0,t.jsx)("option",{value:"price-desc",children:"Mayor precio"})]})]}),(0,t.jsx)("button",{type:"button",className:"".concat(p().toggleButton," ").concat(b?p().active:""),onClick:()=>R(!b),disabled:o,children:b?"✕ Cerrar filtros":"⚙️ M\xe1s filtros"})]}),b&&(0,t.jsxs)("div",{className:p().advancedFilters,children:[a.length>0&&(0,t.jsxs)("div",{className:p().filterGroup,children:[(0,t.jsx)("label",{htmlFor:"category",className:p().label,children:"Categor\xeda"}),(0,t.jsxs)("select",{id:"category",value:c,onChange:e=>d(e.target.value),className:p().select,disabled:o,children:[(0,t.jsx)("option",{value:"",children:"Todas las categor\xedas"}),a.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),l.length>0&&(0,t.jsxs)("div",{className:p().filterGroup,children:[(0,t.jsx)("label",{htmlFor:"shop",className:p().label,children:"Tienda"}),(0,t.jsxs)("select",{id:"shop",value:u,onChange:e=>_(e.target.value),className:p().select,disabled:o,children:[(0,t.jsx)("option",{value:"",children:"Todas las tiendas"}),l.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:p().filterGroup,children:[(0,t.jsx)("label",{htmlFor:"status",className:p().label,children:"Estado"}),(0,t.jsxs)("select",{id:"status",value:h,onChange:e=>m(e.target.value),className:p().select,disabled:o,children:[(0,t.jsx)("option",{value:"",children:"Todos los estados"}),(0,t.jsx)("option",{value:"active",children:"Activo"}),(0,t.jsx)("option",{value:"paused",children:"Pausado"}),(0,t.jsx)("option",{value:"sold_out",children:"Agotado"}),(0,t.jsx)("option",{value:"finished",children:"Finalizado"})]})]}),(0,t.jsxs)("div",{className:p().priceRange,children:[(0,t.jsxs)("div",{className:p().filterGroup,children:[(0,t.jsx)("label",{htmlFor:"minValue",className:p().label,children:"Precio m\xednimo (S/)"}),(0,t.jsx)("input",{id:"minValue",type:"number",min:"0",step:"0.01",placeholder:"0",value:f,onChange:e=>g(e.target.value),className:p().input,disabled:o})]}),(0,t.jsxs)("div",{className:p().filterGroup,children:[(0,t.jsx)("label",{htmlFor:"maxValue",className:p().label,children:"Precio m\xe1ximo (S/)"}),(0,t.jsx)("input",{id:"maxValue",type:"number",min:"0",step:"0.01",placeholder:"Sin l\xedmite",value:v,onChange:e=>x(e.target.value),className:p().input,disabled:o})]})]}),(0,t.jsxs)("div",{className:p().filterActions,children:[(0,t.jsx)("button",{type:"button",onClick:C,className:p().applyButton,disabled:o,children:"Aplicar filtros"}),(0,t.jsx)("button",{type:"button",onClick:()=>{i(""),d(""),_(""),m(""),g(""),x(""),N("newest"),s({sortBy:"newest",page:1})},className:p().resetButton,disabled:o,children:"Limpiar"})]})]})]})}var h=a(1941),m=a.n(h);function f(e){let{type:s,onRetry:a}=e,r=(()=>{switch(s){case"no-raffles":return{icon:"\uD83C\uDFB2",title:"No hay sorteos activos",description:"No hay sorteos activos en este momento. Volv\xe9 pronto o segu\xed a nuestras tiendas para estar al tanto de los pr\xf3ximos lanzamientos.",showRetry:!1};case"no-results":return{icon:"\uD83D\uDD0D",title:"No encontramos sorteos",description:"No encontramos sorteos que coincidan con tu b\xfasqueda. Intenta con otros filtros o t\xe9rminos de b\xfasqueda.",showRetry:!1};case"error":return{icon:"⚠️",title:"Ocurri\xf3 un problema",description:"Ocurri\xf3 un problema al cargar los sorteos. Intenta nuevamente.",showRetry:!0};default:return{icon:"\uD83D\uDCE6",title:"Sin datos",description:"No hay datos disponibles.",showRetry:!1}}})();return(0,t.jsxs)("div",{className:m().container,children:[(0,t.jsx)("div",{className:m().icon,children:r.icon}),(0,t.jsx)("h2",{className:m().title,children:r.title}),(0,t.jsx)("p",{className:m().description,children:r.description}),r.showRetry&&a&&(0,t.jsx)("button",{onClick:a,className:m().retryButton,children:"Reintentar"})]})}var g=a(507),v=a(5805),x=a(4340),j=a.n(x);function N(){let[e,s]=(0,r.useState)([]),[a,o]=(0,r.useState)(!0),[n,i]=(0,r.useState)(null),[c,u]=(0,r.useState)([]),[p,h]=(0,r.useState)([]),[m,x]=(0,r.useState)(1),[N,b]=(0,r.useState)(1),[R,C]=(0,r.useState)(0),[F,y]=(0,r.useState)({sortBy:"newest",page:1,limit:12});(0,r.useEffect)(()=>{(async()=>{try{let[e,s]=await Promise.all([v.Z.getCategories(),v.Z.getShopsWithActiveRaffles()]);u(e),h(s)}catch(e){console.error("Error loading metadata:",e)}})()},[]);let S=(0,r.useCallback)(async e=>{o(!0),i(null);try{console.log("\uD83D\uDD0D Cargando sorteos activos con filtros:",e);let a=await v.Z.getActiveRaffles(e);console.log("✅ Sorteos activos cargados:",a.data.length,"de",a.total),s(a.data),b(a.totalPages),x(a.page),C(a.total)}catch(e){console.error("❌ Error loading raffles:",e),i("No pudimos cargar los sorteos. Intenta nuevamente."),s([])}finally{o(!1)}},[]);(0,r.useEffect)(()=>{S(F)},[]);let B=e=>{let s={...F,page:e};y(s),S(s),window.scrollTo({top:0,behavior:"smooth"})};return(0,t.jsxs)("main",{className:j().container,children:[(0,t.jsxs)("div",{className:j().header,children:[(0,t.jsx)("h1",{className:j().title,children:"Sorteos Disponibles"}),(0,t.jsx)("p",{className:j().subtitle,children:"Descubre incre\xedbles premios y particip\xe1 en nuestros sorteos"})]}),(0,t.jsx)(_,{onFiltersChange:e=>{let s={...F,...e,page:e.page||1};y(s),S(s)},categories:c,shops:p,isLoading:a}),!a&&e.length>0&&(0,t.jsx)("div",{className:j().resultsInfo,children:(0,t.jsxs)("p",{children:["Mostrando ",(0,t.jsx)("strong",{children:e.length})," de ",(0,t.jsx)("strong",{children:R})," sorteos"]})}),a&&(0,t.jsxs)("div",{className:j().loadingContainer,children:[(0,t.jsx)("div",{className:j().spinner}),(0,t.jsx)("p",{children:"Cargando sorteos..."})]}),n&&!a&&(0,t.jsx)(f,{type:"error",onRetry:()=>{S(F)}}),!a&&!n&&0===e.length&&(0,t.jsx)(f,{type:F.search?"no-results":"no-raffles"}),!a&&!n&&e.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:j().grid,children:e.map(e=>(0,t.jsx)(d,{raffle:e},e.id))}),N>1&&(0,t.jsxs)("div",{className:j().pagination,children:[(0,t.jsx)("button",{onClick:()=>B(m-1),disabled:1===m,className:j().paginationButton,children:"← Anterior"}),(0,t.jsxs)("div",{className:j().pageInfo,children:["P\xe1gina ",(0,t.jsx)("strong",{children:m})," de ",(0,t.jsx)("strong",{children:N})]}),(0,t.jsx)("button",{onClick:()=>B(m+1),disabled:m===N,className:j().paginationButton,children:"Siguiente →"})]})]}),(0,t.jsx)(g.Z,{}),(0,t.jsxs)("div",{className:j().ctaSection,children:[(0,t.jsx)("h2",{children:"\xbfEres una tienda?"}),(0,t.jsx)("p",{children:"Crea sorteos y llega a miles de clientes potenciales"}),(0,t.jsx)(l.default,{href:"/register",children:(0,t.jsx)("button",{className:j().ctaButton,children:"Registra tu tienda"})})]})]})}},4340:function(e){e.exports={container:"sorteos_container__Zk7Aa",header:"sorteos_header__PTomZ",title:"sorteos_title__MQ79T",subtitle:"sorteos_subtitle__QkmiF",resultsInfo:"sorteos_resultsInfo__Yrpxw",loadingContainer:"sorteos_loadingContainer__R1tkw",spinner:"sorteos_spinner__ZI0IQ",spin:"sorteos_spin__0JpLo",grid:"sorteos_grid__F5Wdi",pagination:"sorteos_pagination__3jkV_",paginationButton:"sorteos_paginationButton__JYbUW",pageInfo:"sorteos_pageInfo__hUa1X",ctaSection:"sorteos_ctaSection__h4E4v",ctaButton:"sorteos_ctaButton__4UQz6"}},1941:function(e){e.exports={container:"EmptyState_container__zMe2_",icon:"EmptyState_icon__EnNXL",bounce:"EmptyState_bounce__3_AL_",title:"EmptyState_title__iSbK4",description:"EmptyState_description__gMPX_",retryButton:"EmptyState_retryButton__R4sHp"}},4176:function(e){e.exports={card:"RaffleCard_card__mM1X5",imageContainer:"RaffleCard_imageContainer__RYD9p",image:"RaffleCard_image__nztJ2",imagePlaceholder:"RaffleCard_imagePlaceholder__3y5e2",badge:"RaffleCard_badge__PsSvU",badgeActive:"RaffleCard_badgeActive__AE7YM",badgeSoldOut:"RaffleCard_badgeSoldOut__v1sD0",badgeFinished:"RaffleCard_badgeFinished__cJ3RJ",content:"RaffleCard_content__OD30v",productInfo:"RaffleCard_productInfo__f2P1l",productName:"RaffleCard_productName__3N56M",shopName:"RaffleCard_shopName__xTn5w",value:"RaffleCard_value__89KKu",valueLabel:"RaffleCard_valueLabel__hkGuj",valueAmount:"RaffleCard_valueAmount__1maen",progressSection:"RaffleCard_progressSection__nvpkY",progressHeader:"RaffleCard_progressHeader__U37Az",progressLabel:"RaffleCard_progressLabel__rzSO4",progressCount:"RaffleCard_progressCount__LYv1p",progressBar:"RaffleCard_progressBar__QdWZ6",progressFill:"RaffleCard_progressFill__vMDok",progressFooter:"RaffleCard_progressFooter__L_ynv",remainingTickets:"RaffleCard_remainingTickets__ob2rW",progressPercent:"RaffleCard_progressPercent__NGvIs",ctaButton:"RaffleCard_ctaButton__gJ2FM"}},472:function(e){e.exports={container:"RaffleFilters_container__4lZma",searchForm:"RaffleFilters_searchForm__np5lG",searchInputWrapper:"RaffleFilters_searchInputWrapper__cxPZc",searchInput:"RaffleFilters_searchInput__wpNOR",searchButton:"RaffleFilters_searchButton__pCBjk",controlsRow:"RaffleFilters_controlsRow__YFkSb",sortControl:"RaffleFilters_sortControl__cC9Aw",label:"RaffleFilters_label__oQ32V",select:"RaffleFilters_select__msgdj",toggleButton:"RaffleFilters_toggleButton__5POTX",active:"RaffleFilters_active__Rfg8z",advancedFilters:"RaffleFilters_advancedFilters__fF6ZR",slideDown:"RaffleFilters_slideDown__nLnVp",filterGroup:"RaffleFilters_filterGroup__ioUj8",input:"RaffleFilters_input__XcgaU",priceRange:"RaffleFilters_priceRange__RiI4W",filterActions:"RaffleFilters_filterActions__4Mltr",applyButton:"RaffleFilters_applyButton__m2J1k",resetButton:"RaffleFilters_resetButton__fbwWs"}}},function(e){e.O(0,[501,8433,2907,4183,9134,1044,8641,4542,6153,6609,7115,2364,1744],function(){return e(e.s=8844)}),_N_E=e.O()}]);