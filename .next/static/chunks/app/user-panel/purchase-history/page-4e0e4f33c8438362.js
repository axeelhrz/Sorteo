(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2665],{5798:function(e,t,r){Promise.resolve().then(r.bind(r,820))},820:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(7821),s=r(8078),n=r(6201),i=r(4944),c=r(9969),o=r.n(c);function l(){let[e,t]=(0,s.useState)([]),[r,c]=(0,s.useState)(!0),[l,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{c(!0);let e=await i.m.getPurchaseHistory();t(e)}catch(e){console.error("Error fetching purchase history:",e),h("Error al cargar el historial de compras")}finally{c(!1)}})()},[]);let d=async()=>{try{let e=await i.m.exportPurchaseHistoryCSV(),t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="historial-compras-".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(t),document.body.removeChild(r)}catch(e){console.error("Error exporting CSV:",e),alert("Error al exportar el historial")}};return r?(0,a.jsx)(n.Z,{activeSection:"purchase-history",children:(0,a.jsx)("div",{className:o().loadingContainer,children:(0,a.jsx)("p",{children:"Cargando historial de compras..."})})}):(0,a.jsx)(n.Z,{activeSection:"purchase-history",children:(0,a.jsxs)("div",{className:o().container,children:[(0,a.jsxs)("div",{className:o().header,children:[(0,a.jsx)("h1",{className:o().title,children:"\uD83D\uDCCB Historial de Compras"}),(0,a.jsx)("p",{className:o().subtitle,children:"Aqu\xed puedes ver todas tus compras de tickets"})]}),l&&(0,a.jsx)("div",{className:o().errorBanner,children:l}),(0,a.jsx)("div",{className:o().toolbar,children:(0,a.jsx)("button",{onClick:d,className:o().exportButton,children:"\uD83D\uDCE5 Exportar como CSV"})}),0===e.length?(0,a.jsxs)("div",{className:o().emptyState,children:[(0,a.jsx)("p",{className:o().emptyIcon,children:"\uD83D\uDED2"}),(0,a.jsx)("h2",{children:"No tienes compras a\xfan"}),(0,a.jsx)("p",{children:"Comienza a comprar tickets en nuestros sorteos"})]}):(0,a.jsx)("div",{className:o().tableContainer,children:(0,a.jsxs)("table",{className:o().table,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Fecha"}),(0,a.jsx)("th",{children:"Sorteo"}),(0,a.jsx)("th",{children:"Tickets"}),(0,a.jsx)("th",{children:"Monto Total"}),(0,a.jsx)("th",{children:"Estado"}),(0,a.jsx)("th",{children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:new Date(e.purchaseDate).toLocaleDateString()}),(0,a.jsx)("td",{className:o().raffleCell,children:e.raffleTitle}),(0,a.jsx)("td",{className:o().centerCell,children:e.ticketQuantity}),(0,a.jsxs)("td",{className:o().amountCell,children:["$",e.totalAmount.toLocaleString()]}),(0,a.jsx)("td",{children:(0,a.jsxs)("span",{className:"".concat(o().statusBadge," ").concat(o()[e.paymentStatus]),children:["paid"===e.paymentStatus&&"✅ Pagado","failed"===e.paymentStatus&&"❌ Fallido","refunded"===e.paymentStatus&&"↩️ Reembolsado","pending"===e.paymentStatus&&"⏳ Pendiente"]})}),(0,a.jsx)("td",{children:(0,a.jsx)("button",{className:o().detailsButton,children:"Ver Detalles"})})]},e.id))})]})})]})})}},9969:function(e){e.exports={container:"purchase-history_container__WY1Hd",header:"purchase-history_header__4PFSH",title:"purchase-history_title__nvgKa",subtitle:"purchase-history_subtitle__KCqDE",loadingContainer:"purchase-history_loadingContainer__PuTyy",errorBanner:"purchase-history_errorBanner__OQ3wH",toolbar:"purchase-history_toolbar__oWgD9",exportButton:"purchase-history_exportButton__b9jfM",emptyState:"purchase-history_emptyState__aCfaN",emptyIcon:"purchase-history_emptyIcon__bv673",tableContainer:"purchase-history_tableContainer__Xx6tp",table:"purchase-history_table__QeaWs",raffleCell:"purchase-history_raffleCell__OGTBd",centerCell:"purchase-history_centerCell__wdjUH",amountCell:"purchase-history_amountCell__T1hZK",statusBadge:"purchase-history_statusBadge__CHFc4",paid:"purchase-history_paid__g7BzC",failed:"purchase-history_failed__RV7Lj",refunded:"purchase-history_refunded__qkqOX",pending:"purchase-history_pending__Kzm2H",detailsButton:"purchase-history_detailsButton__frjlw"}}},function(e){e.O(0,[8797,9134,2489,4755,4542,1105,7115,2364,1744],function(){return e(e.s=5798)}),_N_E=e.O()}]);