(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2524],{1617:function(e,t,a){Promise.resolve().then(a.bind(a,5012))},5012:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u},dynamic:function(){return l}});var n=a(7821),r=a(8078),s=a(8504),o=a(6943),c=a(3213),i=a.n(c);let l="force-dynamic";function d(){let e=(0,s.useSearchParams)(),t=(0,s.useRouter)(),a=e.get("paymentId"),[c,l]=(0,r.useState)(null),[d,u]=(0,r.useState)(!0),[m,h]=(0,r.useState)(null);return((0,r.useEffect)(()=>{if(!a){h("ID de pago no encontrado"),u(!1);return}(async()=>{try{let e=await o.Z.getPaymentById(a);l(e)}catch(e){h("Error al cargar los datos del pago"),console.error(e)}finally{u(!1)}})()},[a]),d)?(0,n.jsx)("div",{className:i().container,children:(0,n.jsx)("div",{className:i().loadingSpinner,children:"Cargando..."})}):m||!c?(0,n.jsx)("div",{className:i().container,children:(0,n.jsxs)("div",{className:i().errorBox,children:[(0,n.jsx)("h1",{children:"Error"}),(0,n.jsx)("p",{children:m||"No se pudo cargar el pago"}),(0,n.jsx)("button",{onClick:()=>t.push("/sorteos"),children:"Volver a TIKETEA ONLINE"})]})}):(0,n.jsx)("div",{className:i().container,children:(0,n.jsxs)("div",{className:i().failedCard,children:[(0,n.jsx)("div",{className:i().failedIcon,children:"âœ•"}),(0,n.jsx)("h1",{className:i().title,children:"Pago rechazado"}),(0,n.jsx)("p",{className:i().subtitle,children:"Tu pago no pudo ser procesado"}),c.failureReason&&(0,n.jsx)("div",{className:i().reasonBox,children:(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Raz\xf3n:"})," ",c.failureReason]})}),(0,n.jsxs)("div",{className:i().summarySection,children:[(0,n.jsx)("h2",{children:"Detalles de tu intento de compra"}),(0,n.jsxs)("div",{className:i().summaryItem,children:[(0,n.jsx)("span",{children:"Cantidad de tickets:"}),(0,n.jsx)("span",{className:i().value,children:c.ticketQuantity})]}),(0,n.jsxs)("div",{className:i().summaryItem,children:[(0,n.jsx)("span",{children:"Monto:"}),(0,n.jsxs)("span",{className:i().value,children:["S/. ",Number(c.amount).toFixed(2)]})]}),(0,n.jsxs)("div",{className:i().summaryItem,children:[(0,n.jsx)("span",{children:"Fecha del intento:"}),(0,n.jsx)("span",{className:i().value,children:new Date(c.createdAt).toLocaleDateString("es-PE")})]})]}),(0,n.jsx)("div",{className:i().infoBox,children:(0,n.jsx)("p",{children:"Tu cantidad de tickets seleccionados se ha mantenido. Puedes intentar de nuevo con otro m\xe9todo de pago."})}),(0,n.jsxs)("div",{className:i().actions,children:[(0,n.jsx)("button",{className:i().primaryButton,onClick:()=>{c&&t.push("/checkout?paymentId=".concat(c.id))},children:"Intentar de nuevo"}),(0,n.jsx)("button",{className:i().secondaryButton,onClick:()=>t.push("/sorteos"),children:"Volver a TIKETEA ONLINE"})]})]})})}function u(){return(0,n.jsx)(r.Suspense,{fallback:(0,n.jsx)("div",{className:i().container,children:(0,n.jsx)("div",{className:i().loadingSpinner,children:"Cargando..."})}),children:(0,n.jsx)(d,{})})}},3404:function(e,t,a){"use strict";a.d(t,{x:function(){return o}});var n=a(7147),r=a(9190);class s{async register(e){return this.client.post("/auth/register",e)}async login(e){return this.client.post("/auth/login",e)}async getProfile(){return this.client.get("/auth/profile")}async logout(){return this.client.post("/auth/logout")}async get(e,t){return this.client.get(e,t)}async post(e,t,a){return this.client.post(e,t,a)}async put(e,t){return this.client.put(e,t)}async delete(e){return this.client.delete(e)}constructor(){(0,n._)(this,"client",void 0),this.client=r.Z.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>{try{let t=localStorage.getItem("token");console.log("API Request - Token from localStorage:",t),t?(e.headers.Authorization="Bearer ".concat(t),console.log("API Request - Authorization header set:",e.headers.Authorization)):console.log("API Request - No token found"),e.data instanceof FormData&&delete e.headers["Content-Type"]}catch(e){console.error("Error reading token from localStorage:",e)}return e}),this.client.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&localStorage.removeItem("token"),Promise.reject(e)})}}let o=new s},6943:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var n=a(3404);let r={async createPayment(e){try{return(await n.x.post("/payments",e)).data}catch(e){throw console.error("Error creating payment:",e),e}},async confirmPayment(e){try{return(await n.x.post("/payments/confirm",e)).data}catch(e){throw console.error("Error confirming payment:",e),e}},async failPayment(e,t){try{return(await n.x.post("/payments/".concat(e,"/fail"),{failureReason:t})).data}catch(e){throw console.error("Error failing payment:",e),e}},async getPaymentById(e){try{return(await n.x.get("/payments/".concat(e))).data}catch(e){throw console.error("Error fetching payment:",e),e}},async getMyPayments(){try{return(await n.x.get("/payments/user/me")).data}catch(e){throw console.error("Error fetching user payments:",e),e}},async getCompletedPaymentsByRaffleId(e){try{return(await n.x.get("/payments/raffle/".concat(e))).data}catch(e){throw console.error("Error fetching raffle payments:",e),e}},async refundPayment(e){try{return(await n.x.post("/payments/".concat(e,"/refund"),{})).data}catch(e){throw console.error("Error refunding payment:",e),e}}}},8504:function(e,t,a){"use strict";var n=a(3226);a.o(n,"useParams")&&a.d(t,{useParams:function(){return n.useParams}}),a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})},3213:function(e){e.exports={container:"payment-failed_container__m_LWd",failedCard:"payment-failed_failedCard___fm_W",failedIcon:"payment-failed_failedIcon__2pde_",title:"payment-failed_title__S_E5Q",subtitle:"payment-failed_subtitle__qZbFD",reasonBox:"payment-failed_reasonBox__PXjtg",summarySection:"payment-failed_summarySection__RSxnn",summaryItem:"payment-failed_summaryItem__o_zHD",value:"payment-failed_value__9jONL",infoBox:"payment-failed_infoBox__P_IpM",actions:"payment-failed_actions__OVMXh",primaryButton:"payment-failed_primaryButton__lqKW7",secondaryButton:"payment-failed_secondaryButton__z50Od",loadingSpinner:"payment-failed_loadingSpinner__4ERQB",errorBox:"payment-failed_errorBox__Pg890"}}},function(e){e.O(0,[4025,2489,7115,2364,1744],function(){return e(e.s=1617)}),_N_E=e.O()}]);