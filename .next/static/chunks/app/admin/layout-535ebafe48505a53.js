(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9091],{5128:function(e,a,n){Promise.resolve().then(n.bind(n,2305))},2305:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return u}});var t=n(7821),r=n(8078),i=n(4542),o=n(8504),s=n(7851),d=n(7197),l=n(9730),c=n(865),m=n.n(c);function u(e){let{children:a}=e,n=(0,o.useRouter)(),{user:c,logout:u}=(0,d.t)(),[_,h]=(0,r.useState)(!0);if((null==c?void 0:c.role)!=="admin")return(0,t.jsx)("div",{className:m().unauthorized,children:(0,t.jsxs)("div",{className:m().unauthorizedContent,children:[(0,t.jsx)("h1",{children:"No autorizado"}),(0,t.jsx)("p",{children:"No tienes permiso para acceder a esta secci\xf3n."}),(0,t.jsx)("button",{onClick:()=>n.push("/"),children:"Volver al inicio"})]})});let g=async()=>{try{await u(),n.push("/login")}catch(e){console.error("Error al cerrar sesi\xf3n:",e),n.push("/login")}};return(0,t.jsxs)("div",{className:m().adminContainer,children:[(0,t.jsxs)("aside",{className:"".concat(m().sidebar," ").concat(_?m().open:m().closed),children:[(0,t.jsxs)("div",{className:m().sidebarHeader,children:[(0,t.jsx)(l.Z,{size:"small",showText:!1}),(0,t.jsx)("h2",{children:"Panel Admin"}),(0,t.jsx)("button",{className:m().toggleBtn,onClick:()=>h(!_),children:(0,t.jsx)(s.cur,{})})]}),(0,t.jsxs)("nav",{className:m().sidebarNav,children:[(0,t.jsxs)(i.default,{href:"/admin",className:m().navItem,children:[(0,t.jsx)(s.orK,{className:m().navIcon}),(0,t.jsx)("span",{children:"Dashboard"})]}),(0,t.jsxs)(i.default,{href:"/admin/raffles/pending",className:m().navItem,children:[(0,t.jsx)(s.TCC,{className:m().navIcon}),(0,t.jsx)("span",{children:"Sorteos Pendientes"})]}),(0,t.jsxs)(i.default,{href:"/admin/raffles/active",className:m().navItem,children:[(0,t.jsx)(s.KCr,{className:m().navIcon}),(0,t.jsx)("span",{children:"Sorteos Activos"})]}),(0,t.jsxs)(i.default,{href:"/admin/raffles/finished",className:m().navItem,children:[(0,t.jsx)(s._rq,{className:m().navIcon}),(0,t.jsx)("span",{children:"Sorteos Finalizados"})]}),(0,t.jsxs)(i.default,{href:"/admin/shops",className:m().navItem,children:[(0,t.jsx)(s.x8h,{className:m().navIcon}),(0,t.jsx)("span",{children:"Tiendas"})]}),(0,t.jsxs)(i.default,{href:"/admin/users",className:m().navItem,children:[(0,t.jsx)(s.WY8,{className:m().navIcon}),(0,t.jsx)("span",{children:"Usuarios"})]}),(0,t.jsxs)(i.default,{href:"/admin/audit",className:m().navItem,children:[(0,t.jsx)(s.NOg,{className:m().navIcon}),(0,t.jsx)("span",{children:"Auditor\xeda"})]}),(0,t.jsxs)(i.default,{href:"/admin/payments",className:m().navItem,children:[(0,t.jsx)(s.XiQ,{className:m().navIcon}),(0,t.jsx)("span",{children:"Transacciones"})]})]}),(0,t.jsxs)("div",{className:m().sidebarFooter,children:[(0,t.jsxs)("div",{className:m().userInfo,children:[(0,t.jsx)("p",{children:null==c?void 0:c.name}),(0,t.jsx)("small",{children:null==c?void 0:c.email})]}),(0,t.jsx)("button",{className:m().logoutBtn,onClick:g,children:"Cerrar sesi\xf3n"})]})]}),(0,t.jsxs)("main",{className:m().mainContent,children:[(0,t.jsx)("div",{className:m().topBar,children:(0,t.jsx)("h1",{children:"Panel de Administraci\xf3n"})}),(0,t.jsx)("div",{className:m().content,children:a})]})]})}},9730:function(e,a,n){"use strict";n.d(a,{Z:function(){return l}});var t=n(7821),r=n(8149),i=n(4542),o={src:"/_next/static/media/logo.4501bff6.png",height:1080,width:1080,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAz0lEQVR42mNgaFnGzAAFZnO3GZkDMYyPkDNtkpWbteVEyqr9/0FYdObmEwxc1bJwhXMOXTgx++D5/5P2nvk7Zd/Zv0uOXf4P5J+AyAb3Gi08eun/z99//i48cunf0uOX//3////vsuNX/jOE9QGti+g3Akr8BwlefPj839XHL8EKFhy5+J8hdiLEPTMOnDsBtOY/yHgg+++qk1f/zzt84QQDHGRMk7Wfv/2Ezuwt/5Vmbv6vNXvrCYbIfqgjp2+Ce7Nx23Gjms1HEd6csoEZAALjd67o7P0OAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},s=n(3616),d=n.n(s);function l(e){let{size:a="medium",showText:n=!0,className:s="",href:l="/"}=e,c=(0,t.jsxs)("div",{className:"".concat(d().logo," ").concat(d()[a]," ").concat(s),children:[(0,t.jsx)(r.default,{src:o,alt:"TIKETEA ONLINE",width:"small"===a?40:"medium"===a?60:80,height:"small"===a?40:"medium"===a?60:80,className:d().logoImage,priority:!0}),n&&(0,t.jsx)("span",{className:d().logoText,children:"TIKETEA ONLINE"})]});return l?(0,t.jsx)(i.default,{href:l,className:d().logoLink,children:c}):c}},6532:function(e,a,n){"use strict";let t;n.d(a,{I8:function(){return l},db:function(){return d}});var r=n(1830),i=n(6534),o=n(1069),s=n(4304);t=0===(0,r.C6)().length?(0,r.ZF)({apiKey:"AIzaSyCROuDbFChzWrRSXQ42lih56oLEA1hjne4",authDomain:"sorteo-b8fb0.firebaseapp.com",projectId:"sorteo-b8fb0",storageBucket:"sorteo-b8fb0.firebasestorage.app",messagingSenderId:"58395659334",appId:"1:58395659334:web:58c8f46dab380710eb4e47"}):(0,r.C6)()[0];let d=(0,i.ad)(t);(0,o.cF)(t);let l=(0,s.v0)(t)},5161:function(e,a,n){"use strict";n.d(a,{Y:function(){return d}});var t=n(4304),r=n(6534),i=n(6532),o=n(6289);let s=async e=>{var a,n,t;try{let t=await (0,r.getDoc)((0,r.doc)(i.db,"users",e.uid));if(!t.exists())return{id:e.uid,name:e.displayName||(null===(n=e.email)||void 0===n?void 0:n.split("@")[0])||"Usuario",email:e.email||"",role:o.i.USER};let s=t.data();return{id:e.uid,name:s.name||e.displayName||(null===(a=e.email)||void 0===a?void 0:a.split("@")[0])||"Usuario",email:e.email||"",role:s.role||o.i.USER}}catch(a){return console.error("Error converting Firebase user:",a),{id:e.uid,name:e.displayName||(null===(t=e.email)||void 0===t?void 0:t.split("@")[0])||"Usuario",email:e.email||"",role:o.i.USER}}},d={async register(e){try{let a=(await (0,t.Xb)(i.I8,e.email,e.password)).user;e.name&&await (0,t.ck)(a,{displayName:e.name});let n=await a.getIdToken(),d={name:e.name,email:e.email,role:e.role,createdAt:(0,r.serverTimestamp)(),updatedAt:(0,r.serverTimestamp)()};if(e.role===o.i.SHOP&&e.shopName){let n={userId:a.uid,name:e.shopName,description:"",status:"pending",createdAt:(0,r.serverTimestamp)(),updatedAt:(0,r.serverTimestamp)()},t=await (0,r.ET)((0,r.collection)(i.db,"shops"),n);d.shopId=t.id,await (0,r.pl)((0,r.doc)(i.db,"users",a.uid),d)}else await (0,r.pl)((0,r.doc)(i.db,"users",a.uid),d);return{user:await s(a),token:n}}catch(a){console.error("Error registering user:",a);let e="Error al registrar usuario";throw"auth/email-already-in-use"===a.code?e="Este email ya est\xe1 registrado":"auth/invalid-email"===a.code?e="Email inv\xe1lido":"auth/weak-password"===a.code?e="La contrase\xf1a debe tener al menos 6 caracteres":"auth/operation-not-allowed"===a.code?e="El m\xe9todo de autenticaci\xf3n por email/password no est\xe1 habilitado. Por favor, contacta al administrador.":"auth/network-request-failed"===a.code?e="Error de conexi\xf3n. Verifica tu conexi\xf3n a internet.":a.message&&(e=a.message),Error(e)}},async login(e){try{let a=(await (0,t.e5)(i.I8,e.email,e.password)).user,n=await a.getIdToken();return{user:await s(a),token:n}}catch(a){console.error("Error logging in:",a);let e="Error al iniciar sesi\xf3n";throw"auth/user-not-found"===a.code?e="Usuario no encontrado":"auth/wrong-password"===a.code?e="Contrase\xf1a incorrecta":"auth/invalid-email"===a.code?e="Email inv\xe1lido":"auth/user-disabled"===a.code?e="Usuario deshabilitado":"auth/too-many-requests"===a.code?e="Demasiados intentos. Intenta m\xe1s tarde":"auth/operation-not-allowed"===a.code?e="El m\xe9todo de autenticaci\xf3n por email/password no est\xe1 habilitado. Por favor, contacta al administrador.":"auth/network-request-failed"===a.code?e="Error de conexi\xf3n. Verifica tu conexi\xf3n a internet.":a.message&&(e=a.message),Error(e)}},async logout(){try{await (0,t.w7)(i.I8)}catch(e){throw console.error("Error logging out:",e),e}},async getCurrentUser(){try{let e=i.I8.currentUser;if(!e)return null;return await s(e)}catch(e){return console.error("Error getting current user:",e),null}},async getCurrentUserToken(){try{let e=i.I8.currentUser;if(!e)return null;return await e.getIdToken()}catch(e){return console.error("Error getting token:",e),null}},onAuthStateChanged:e=>(0,t.Aj)(i.I8,async a=>{a?e(await s(a)):e(null)})}},7197:function(e,a,n){"use strict";n.d(a,{t:function(){return o}});var t=n(3020),r=n(4302),i=n(5161);let o=(0,t.Ue)()((0,r.tJ)((e,a)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,setUser:a=>e({user:a,isAuthenticated:!!a}),setToken:a=>{a?localStorage.setItem("token",a):localStorage.removeItem("token"),e({token:a})},setIsLoading:a=>e({isLoading:a}),setError:a=>e({error:a}),logout:async()=>{try{await i.Y.logout()}catch(e){console.error("Error logging out:",e)}finally{localStorage.removeItem("token"),e({user:null,token:null,isAuthenticated:!1})}},refreshToken:async()=>{try{let e=await i.Y.getCurrentUserToken();e&&a().setToken(e)}catch(e){console.error("Error refreshing token:",e)}}}),{name:"auth-store",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))},6289:function(e,a,n){"use strict";var t,r;n.d(a,{i:function(){return t}}),(r=t||(t={})).ADMIN="admin",r.SHOP="shop",r.USER="user"},865:function(e){e.exports={adminContainer:"admin_adminContainer__Eh90a",sidebar:"admin_sidebar__mXGAh",closed:"admin_closed__0toWD",sidebarHeader:"admin_sidebarHeader__R_jJT",toggleBtn:"admin_toggleBtn__xfw93",sidebarNav:"admin_sidebarNav__WZtZQ",navItem:"admin_navItem__DShOG",navIcon:"admin_navIcon__3O_Ni",sidebarFooter:"admin_sidebarFooter__3hkih",userInfo:"admin_userInfo__LVYmW",logoutBtn:"admin_logoutBtn__XlQ6d",mainContent:"admin_mainContent__LKiLk",topBar:"admin_topBar__NC1F1",content:"admin_content__q9bCm",unauthorized:"admin_unauthorized__IQ2li",unauthorizedContent:"admin_unauthorizedContent__WVcyS",dashboardGrid:"admin_dashboardGrid__eoxej",statCard:"admin_statCard__x3Xg1",warning:"admin_warning__AVQfv",danger:"admin_danger__sptcS",success:"admin_success__1eje9",info:"admin_info__tS_KQ",statHeader:"admin_statHeader__eYJkD",statIcon:"admin_statIcon__S4aUI",value:"admin_value__TMFsT",tableContainer:"admin_tableContainer__GVxxO",tableHeader:"admin_tableHeader___8L4K",filterContainer:"admin_filterContainer__6WkIk",filterSelect:"admin_filterSelect__OG5aD",filterInput:"admin_filterInput__qeIwH",table:"admin_table__Wi_BD",tableHead:"admin_tableHead__HUGym",tableHeadCell:"admin_tableHeadCell__aGufP",tableCell:"admin_tableCell__sFHBM",tableBodyRow:"admin_tableBodyRow__arYS1",statusBadge:"admin_statusBadge__6Bfmv",pending:"admin_pending__ESWta",active:"admin_active__3D2D6",finished:"admin_finished__w5SWW",rejected:"admin_rejected__lb5oK",cancelled:"admin_cancelled__Qaxdn",verified:"admin_verified__eRcoj",blocked:"admin_blocked__bylJi",actionButtons:"admin_actionButtons__n1G3j",btn:"admin_btn__lDLne",btnPrimary:"admin_btnPrimary__uvegQ",btnSuccess:"admin_btnSuccess__IODau",btnDanger:"admin_btnDanger__76sY_",btnWarning:"admin_btnWarning__5Fqhx",btnSecondary:"admin_btnSecondary__assgO",modal:"admin_modal__DNvY3",open:"admin_open__bBxNv",modalContent:"admin_modalContent__tBgZX",modalHeader:"admin_modalHeader__frRax",modalBody:"admin_modalBody__6pNmP",modalFooter:"admin_modalFooter__jGFWx",formGroup:"admin_formGroup__W0nf_",pagination:"admin_pagination__0kMUt",paginationBtn:"admin_paginationBtn__oojru"}},3616:function(e){e.exports={logo:"Logo_logo__hia7S",logoLink:"Logo_logoLink__gM3sV",logoImage:"Logo_logoImage__daWgp",logoText:"Logo_logoText___NRG4",small:"Logo_small__digRM",medium:"Logo_medium__HI_Ok",large:"Logo_large__OX_7R",dark:"Logo_dark__vov1N"}}},function(e){e.O(0,[9286,2907,4183,9134,1044,8641,4755,4542,6153,7115,2364,1744],function(){return e(e.s=5128)}),_N_E=e.O()}]);