(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6609],{507:function(e,t,o){"use strict";o.d(t,{Z:function(){return c}});var r=o(7821),s=o(7851),a=o(4829),i=o.n(a);function c(){let e=[{number:1,title:"Eleg\xeds el sorteo",description:"Explora nuestro cat\xe1logo y elige el sorteo que te interesa.",icon:s.xUG},{number:2,title:"Compr\xe1s tickets",description:"Adquiere la cantidad de tickets que desees. Cada ticket es una participaci\xf3n.",icon:s.E25},{number:3,title:"Se realiza el sorteo",description:"Cuando se venden todos los tickets, se ejecuta el sorteo autom\xe1ticamente.",icon:s.KCr},{number:4,title:"Se publica el ganador",description:"El ticket ganador se elige de forma aleatoria y se publica en la plataforma.",icon:s.HR2}];return(0,r.jsxs)("section",{className:i().container,children:[(0,r.jsxs)("div",{className:i().header,children:[(0,r.jsx)("h2",{className:i().title,children:"\xbfC\xf3mo funciona este sorteo?"}),(0,r.jsx)("p",{className:i().subtitle,children:"Entend\xe9 el mecanismo en 4 pasos simples"})]}),(0,r.jsx)("div",{className:i().stepsContainer,children:e.map((t,o)=>{let s=t.icon;return(0,r.jsxs)("div",{className:i().step,children:[(0,r.jsx)("div",{className:i().stepIcon,children:(0,r.jsx)(s,{})}),(0,r.jsxs)("div",{className:i().stepContent,children:[(0,r.jsxs)("h3",{className:i().stepTitle,children:["Paso ",t.number,": ",t.title]}),(0,r.jsx)("p",{className:i().stepDescription,children:t.description})]}),o<e.length-1&&(0,r.jsx)("div",{className:i().connector})]},t.number)})}),(0,r.jsxs)("div",{className:i().infoBox,children:[(0,r.jsx)("h3",{className:i().infoTitle,children:"Informaci\xf3n importante"}),(0,r.jsxs)("ul",{className:i().infoList,children:[(0,r.jsx)("li",{children:"Cada ticket representa una participaci\xf3n en el sorteo."}),(0,r.jsx)("li",{children:"El ganador se elige de forma completamente aleatoria."}),(0,r.jsx)("li",{children:"El resultado es transparente y verificable."}),(0,r.jsx)("li",{children:"El ganador ser\xe1 notificado por email inmediatamente."}),(0,r.jsx)("li",{children:"Todos los sorteos cumplen con la normativa vigente."})]})]})]})}},6532:function(e,t,o){"use strict";let r;o.d(t,{I8:function(){return l},db:function(){return n}});var s=o(1830),a=o(6534),i=o(1069),c=o(4304);r=0===(0,s.C6)().length?(0,s.ZF)({apiKey:"AIzaSyCROuDbFChzWrRSXQ42lih56oLEA1hjne4",authDomain:"sorteo-b8fb0.firebaseapp.com",projectId:"sorteo-b8fb0",storageBucket:"sorteo-b8fb0.firebasestorage.app",messagingSenderId:"58395659334",appId:"1:58395659334:web:58c8f46dab380710eb4e47"}):(0,s.C6)()[0];let n=(0,a.ad)(r);(0,i.cF)(r);let l=(0,c.v0)(r)},9273:function(e,t,o){"use strict";o.d(t,{U:function(){return n}});var r=o(6534),s=o(6532),a=o(6030);let i=e=>(null==e?void 0:e.toDate)?e.toDate():e instanceof Date?e:"string"==typeof e?new Date(e):new Date,c=async e=>{let t=e.data(),o={id:e.id,shopId:t.shopId||"",productId:t.productId||"",productValue:t.productValue||0,totalTickets:t.totalTickets||0,soldTickets:t.soldTickets||0,status:t.status||a.r.DRAFT,requiresDeposit:t.requiresDeposit||!1,winnerTicketId:t.winnerTicketId,specialConditions:t.specialConditions,createdAt:i(t.createdAt),updatedAt:i(t.updatedAt),activatedAt:t.activatedAt?i(t.activatedAt):void 0,raffleExecutedAt:t.raffleExecutedAt?i(t.raffleExecutedAt):void 0};if(t.shopId)try{let e=await (0,r.getDoc)((0,r.doc)(s.db,"shops",t.shopId));if(e.exists()){let t=e.data();o.shop={id:e.id,userId:t.userId||"",name:t.name||"",description:t.description,logo:t.logo,publicEmail:t.publicEmail,phone:t.phone,socialMedia:t.socialMedia,status:t.status||"pending",createdAt:i(t.createdAt),updatedAt:i(t.updatedAt)}}}catch(e){console.error("Error loading shop:",e)}if(t.productId)try{let e=await (0,r.getDoc)((0,r.doc)(s.db,"products",t.productId));if(e.exists()){let t=e.data();o.product={id:e.id,shopId:t.shopId||"",name:t.name||"",description:t.description||"",value:t.value||0,height:t.height||0,width:t.width||0,depth:t.depth||0,requiresDeposit:t.requiresDeposit||!1,category:t.category,mainImage:t.mainImage,status:t.status||"inactive",createdAt:i(t.createdAt),updatedAt:i(t.updatedAt)}}}catch(e){console.error("Error loading product:",e)}return o},n={async getActiveRaffles(e){try{let t;let o=(0,r.collection)(s.db,"raffles");try{let s=(0,r.query)(o,(0,r.where)("status","==",a.r.ACTIVE));if((null==e?void 0:e.shopId)&&(s=(0,r.query)(s,(0,r.where)("shopId","==",e.shopId))),null==e?void 0:e.shopId)t=await (0,r.getDocs)(s);else try{s=(null==e?void 0:e.sortBy)==="newest"?(0,r.query)(s,(0,r.Xo)("createdAt","desc")):(null==e?void 0:e.sortBy)==="closest"?(0,r.query)(s,(0,r.Xo)("soldTickets","desc")):(null==e?void 0:e.sortBy)==="price-asc"?(0,r.query)(s,(0,r.Xo)("productValue","asc")):(null==e?void 0:e.sortBy)==="price-desc"?(0,r.query)(s,(0,r.Xo)("productValue","desc")):(0,r.query)(s,(0,r.Xo)("createdAt","desc")),t=await (0,r.getDocs)(s)}catch(i){console.warn("Error con orderBy, obteniendo sin ordenar:",i),s=(null==e?void 0:e.shopId)?(0,r.query)(o,(0,r.where)("status","==",a.r.ACTIVE),(0,r.where)("shopId","==",e.shopId)):(0,r.query)(o,(0,r.where)("status","==",a.r.ACTIVE)),t=await (0,r.getDocs)(s)}}catch(i){console.warn("Error en consulta con where, obteniendo todos los sorteos:",i);let e=(0,r.query)(o),s=await (0,r.getDocs)(e);t={docs:s.docs.filter(e=>{let t=e.data().status;return t===a.r.ACTIVE||"active"===t})},console.log("\uD83D\uDCCA Sorteos activos encontrados despu\xe9s de filtrar: ".concat(t.docs.length," de ").concat(s.docs.length," totales"))}let i=[];for(let e of t.docs)try{let t=await c(e);i.push(t)}catch(e){console.error("Error converting raffle doc:",e)}if(console.log("âœ… Sorteos activos cargados: ".concat(i.length)),(null==e?void 0:e.category)&&(i=i.filter(t=>{var o;return(null===(o=t.product)||void 0===o?void 0:o.category)===e.category})),(null==e?void 0:e.minValue)!==void 0&&(i=i.filter(t=>t.productValue>=e.minValue)),(null==e?void 0:e.maxValue)!==void 0&&(i=i.filter(t=>t.productValue<=e.maxValue)),null==e?void 0:e.search){let t=e.search.toLowerCase();i=i.filter(e=>{var o,r,s;return(null===(o=e.product)||void 0===o?void 0:o.name.toLowerCase().includes(t))||(null===(r=e.product)||void 0===r?void 0:r.description.toLowerCase().includes(t))||(null===(s=e.shop)||void 0===s?void 0:s.name.toLowerCase().includes(t))})}((null==e?void 0:e.shopId)||(null==e?void 0:e.sortBy))&&((null==e?void 0:e.sortBy)==="newest"?i.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()):(null==e?void 0:e.sortBy)==="closest"?i.sort((e,t)=>t.soldTickets-e.soldTickets):(null==e?void 0:e.sortBy)==="price-asc"?i.sort((e,t)=>e.productValue-t.productValue):(null==e?void 0:e.sortBy)==="price-desc"&&i.sort((e,t)=>t.productValue-e.productValue));let n=(null==e?void 0:e.limit)||12,l=(null==e?void 0:e.page)||1,d=(l-1)*n,u=i.length;return{data:i.slice(d,d+n),total:u,page:l,limit:n,totalPages:Math.ceil(u/n)}}catch(e){throw console.error("Error fetching active raffles:",e),e}},async getRaffleById(e){try{let t=await (0,r.getDoc)((0,r.doc)(s.db,"raffles",e));if(!t.exists())throw Error("Raffle not found");return await c(t)}catch(e){throw console.error("Error fetching raffle:",e),e}},async getRafflesByShop(e,t){try{let o=(0,r.collection)(s.db,"raffles"),i=(0,r.query)(o,(0,r.where)("shopId","==",e),(0,r.where)("status","==",a.r.ACTIVE)),n=await (0,r.getDocs)(i),l=[];for(let e of n.docs){let t=await c(e);l.push(t)}if(null==t?void 0:t.search){let e=t.search.toLowerCase();l=l.filter(t=>{var o,r;return(null===(o=t.product)||void 0===o?void 0:o.name.toLowerCase().includes(e))||(null===(r=t.product)||void 0===r?void 0:r.description.toLowerCase().includes(e))})}(null==t?void 0:t.sortBy)==="newest"?l.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()):(null==t?void 0:t.sortBy)==="closest"?l.sort((e,t)=>t.soldTickets-e.soldTickets):l.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime());let d=(null==t?void 0:t.limit)||12,u=(null==t?void 0:t.page)||1,p=(u-1)*d,h=l.length;return{data:l.slice(p,p+d),total:h,page:u,limit:d,totalPages:Math.ceil(h/d)}}catch(e){throw console.error("Error fetching shop raffles:",e),e}},async getCategories(){try{let e=(0,r.collection)(s.db,"products"),t=(0,r.query)(e,(0,r.where)("status","==","active")),o=await (0,r.getDocs)(t),a=new Set;return o.docs.forEach(e=>{let t=e.data();t.category&&a.add(t.category)}),Array.from(a).sort()}catch(e){return console.error("Error fetching categories:",e),[]}},async getShopsWithActiveRaffles(){try{let e=(0,r.collection)(s.db,"raffles"),t=(0,r.query)(e,(0,r.where)("status","==",a.r.ACTIVE)),o=await (0,r.getDocs)(t),i=new Set;o.docs.forEach(e=>{let t=e.data();t.shopId&&i.add(t.shopId)});let c=[];for(let e of i)try{let t=await (0,r.getDoc)((0,r.doc)(s.db,"shops",e));if(t.exists()){let e=t.data();c.push({id:t.id,name:e.name||"Tienda sin nombre"})}}catch(t){console.error("Error loading shop ".concat(e,":"),t)}return c.sort((e,t)=>e.name.localeCompare(t.name))}catch(e){return console.error("Error fetching shops:",e),[]}}}},5805:function(e,t,o){"use strict";o.d(t,{Z:function(){return r}});let r=o(9273).U},6030:function(e,t,o){"use strict";var r,s;o.d(t,{r:function(){return r}}),(s=r||(r={})).DRAFT="draft",s.PENDING_APPROVAL="pending_approval",s.ACTIVE="active",s.PAUSED="paused",s.SOLD_OUT="sold_out",s.FINISHED="finished",s.CANCELLED="cancelled",s.REJECTED="rejected"},4829:function(e){e.exports={container:"HowItWorks_container__mnq7x",header:"HowItWorks_header__TUNtf",title:"HowItWorks_title__R9mRH",subtitle:"HowItWorks_subtitle__p1VGO",stepsContainer:"HowItWorks_stepsContainer__z4SVF",step:"HowItWorks_step__xqJEj",stepIcon:"HowItWorks_stepIcon__daqZC",float:"HowItWorks_float__bIpD0",stepContent:"HowItWorks_stepContent__1KjE5",stepTitle:"HowItWorks_stepTitle__wWntG",stepDescription:"HowItWorks_stepDescription__Gjb4i",connector:"HowItWorks_connector__0xEXv",infoBox:"HowItWorks_infoBox__vaEP0",infoTitle:"HowItWorks_infoTitle__5IZQi",infoList:"HowItWorks_infoList__05_Ra"}}}]);