"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_src_services_product-service_ts"],{

/***/ "(app-pages-browser)/./src/services/firebase-product-service.ts":
/*!**************************************************!*\
  !*** ./src/services/firebase-product-service.ts ***!
  \**************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   firebaseProductService: function() { return /* binding */ firebaseProductService; }\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"(app-pages-browser)/../node_modules/firebase/firestore/dist/esm/index.esm.js\");\n/* harmony import */ var _lib_firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/firebase */ \"(app-pages-browser)/./src/lib/firebase.ts\");\n/* harmony import */ var _types_product__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/types/product */ \"(app-pages-browser)/./src/types/product.ts\");\n\n\n\n// Helper para convertir Firestore timestamp a Date\nconst convertTimestamp = (timestamp)=>{\n    if (timestamp === null || timestamp === void 0 ? void 0 : timestamp.toDate) {\n        return timestamp.toDate();\n    }\n    if (timestamp instanceof Date) {\n        return timestamp;\n    }\n    if (typeof timestamp === \"string\") {\n        return new Date(timestamp);\n    }\n    return new Date();\n};\n// Helper para convertir documento de Firestore a Product\nconst convertProductDoc = (docSnap)=>{\n    const data = docSnap.data();\n    return {\n        id: docSnap.id,\n        shopId: data.shopId || \"\",\n        name: data.name || \"\",\n        description: data.description || \"\",\n        value: data.value || 0,\n        height: data.height || 0,\n        width: data.width || 0,\n        depth: data.depth || 0,\n        requiresDeposit: data.requiresDeposit || false,\n        category: data.category,\n        mainImage: data.mainImage,\n        status: data.status || _types_product__WEBPACK_IMPORTED_MODULE_2__.ProductStatus.INACTIVE,\n        createdAt: convertTimestamp(data.createdAt),\n        updatedAt: convertTimestamp(data.updatedAt)\n    };\n};\nconst firebaseProductService = {\n    /**\n   * Obtiene productos por tienda (para marketplace)\n   */ async getProductsByShop (shopId) {\n        try {\n            const productsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"products\");\n            // Primero filtramos, luego ordenamos en memoria para evitar problemas de índices\n            const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(productsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"shopId\", \"==\", shopId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", _types_product__WEBPACK_IMPORTED_MODULE_2__.ProductStatus.ACTIVE));\n            const snapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n            const products = snapshot.docs.map((doc)=>convertProductDoc(doc));\n            // Ordenar por fecha de creación descendente\n            return products.sort((a, b)=>b.createdAt.getTime() - a.createdAt.getTime());\n        } catch (error) {\n            console.error(\"Error fetching products by shop:\", error);\n            throw error;\n        }\n    },\n    /**\n   * Obtiene productos activos por tienda\n   */ async getActiveProductsByShop (shopId) {\n        return this.getProductsByShop(shopId);\n    },\n    /**\n   * Obtiene un producto por ID\n   */ async getProductById (id) {\n        try {\n            const productDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"products\", id));\n            if (!productDoc.exists()) {\n                throw new Error(\"Product not found\");\n            }\n            return convertProductDoc(productDoc);\n        } catch (error) {\n            console.error(\"Error fetching product:\", error);\n            throw error;\n        }\n    },\n    /**\n   * Obtiene todos los productos activos (para marketplace)\n   */ async getAllProducts () {\n        try {\n            const productsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"products\");\n            const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(productsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", _types_product__WEBPACK_IMPORTED_MODULE_2__.ProductStatus.ACTIVE));\n            const snapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n            const products = snapshot.docs.map((doc)=>convertProductDoc(doc));\n            // Ordenar por fecha de creación descendente\n            return products.sort((a, b)=>b.createdAt.getTime() - a.createdAt.getTime());\n        } catch (error) {\n            console.error(\"Error fetching all products:\", error);\n            throw error;\n        }\n    },\n    /**\n   * Crea un nuevo producto\n   */ async createProduct (data) {\n        try {\n            const productsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"products\");\n            const productData = {\n                shopId: data.shopId,\n                name: data.name,\n                description: data.description,\n                value: data.value,\n                height: data.height,\n                width: data.width,\n                depth: data.depth,\n                requiresDeposit: data.height > 15 || data.width > 15 || data.depth > 15,\n                category: data.category || null,\n                mainImage: data.mainImage || null,\n                status: _types_product__WEBPACK_IMPORTED_MODULE_2__.ProductStatus.ACTIVE,\n                createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n                updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            };\n            const docRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)(productsRef, productData);\n            const productDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(docRef);\n            if (!productDoc.exists()) {\n                throw new Error(\"Error al crear el producto\");\n            }\n            return convertProductDoc(productDoc);\n        } catch (error) {\n            console.error(\"Error creating product:\", error);\n            throw error;\n        }\n    },\n    /**\n   * Actualiza un producto existente\n   */ async updateProduct (id, data) {\n        try {\n            const productRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"products\", id);\n            const updateData = {\n                updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            };\n            if (data.name !== undefined) updateData.name = data.name;\n            if (data.description !== undefined) updateData.description = data.description;\n            if (data.value !== undefined) updateData.value = data.value;\n            if (data.height !== undefined) updateData.height = data.height;\n            if (data.width !== undefined) updateData.width = data.width;\n            if (data.depth !== undefined) updateData.depth = data.depth;\n            if (data.category !== undefined) updateData.category = data.category;\n            if (data.mainImage !== undefined) updateData.mainImage = data.mainImage;\n            // Recalcular requiresDeposit si cambian las dimensiones\n            if (data.height !== undefined || data.width !== undefined || data.depth !== undefined) {\n                const productDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(productRef);\n                if (productDoc.exists()) {\n                    const currentData = productDoc.data();\n                    const height = data.height !== undefined ? data.height : currentData.height;\n                    const width = data.width !== undefined ? data.width : currentData.width;\n                    const depth = data.depth !== undefined ? data.depth : currentData.depth;\n                    updateData.requiresDeposit = height > 15 || width > 15 || depth > 15;\n                }\n            }\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(productRef, updateData);\n            const updatedDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(productRef);\n            if (!updatedDoc.exists()) {\n                throw new Error(\"Producto no encontrado\");\n            }\n            return convertProductDoc(updatedDoc);\n        } catch (error) {\n            console.error(\"Error updating product:\", error);\n            throw error;\n        }\n    },\n    /**\n   * Desactiva un producto\n   */ async deactivateProduct (id) {\n        try {\n            const productRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"products\", id);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(productRef, {\n                status: _types_product__WEBPACK_IMPORTED_MODULE_2__.ProductStatus.INACTIVE,\n                updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            });\n            const updatedDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(productRef);\n            if (!updatedDoc.exists()) {\n                throw new Error(\"Producto no encontrado\");\n            }\n            return convertProductDoc(updatedDoc);\n        } catch (error) {\n            console.error(\"Error deactivating product:\", error);\n            throw error;\n        }\n    }\n};\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9zZXJ2aWNlcy9maXJlYmFzZS1wcm9kdWN0LXNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQVk0QjtBQUNRO0FBQ3lEO0FBRTdGLG1EQUFtRDtBQUNuRCxNQUFNVyxtQkFBbUIsQ0FBQ0M7SUFDeEIsSUFBSUEsc0JBQUFBLGdDQUFBQSxVQUFXQyxNQUFNLEVBQUU7UUFDckIsT0FBT0QsVUFBVUMsTUFBTTtJQUN6QjtJQUNBLElBQUlELHFCQUFxQkUsTUFBTTtRQUM3QixPQUFPRjtJQUNUO0lBQ0EsSUFBSSxPQUFPQSxjQUFjLFVBQVU7UUFDakMsT0FBTyxJQUFJRSxLQUFLRjtJQUNsQjtJQUNBLE9BQU8sSUFBSUU7QUFDYjtBQUVBLHlEQUF5RDtBQUN6RCxNQUFNQyxvQkFBb0IsQ0FBQ0M7SUFDekIsTUFBTUMsT0FBT0QsUUFBUUMsSUFBSTtJQUN6QixPQUFPO1FBQ0xDLElBQUlGLFFBQVFFLEVBQUU7UUFDZEMsUUFBUUYsS0FBS0UsTUFBTSxJQUFJO1FBQ3ZCQyxNQUFNSCxLQUFLRyxJQUFJLElBQUk7UUFDbkJDLGFBQWFKLEtBQUtJLFdBQVcsSUFBSTtRQUNqQ0MsT0FBT0wsS0FBS0ssS0FBSyxJQUFJO1FBQ3JCQyxRQUFRTixLQUFLTSxNQUFNLElBQUk7UUFDdkJDLE9BQU9QLEtBQUtPLEtBQUssSUFBSTtRQUNyQkMsT0FBT1IsS0FBS1EsS0FBSyxJQUFJO1FBQ3JCQyxpQkFBaUJULEtBQUtTLGVBQWUsSUFBSTtRQUN6Q0MsVUFBVVYsS0FBS1UsUUFBUTtRQUN2QkMsV0FBV1gsS0FBS1csU0FBUztRQUN6QkMsUUFBUVosS0FBS1ksTUFBTSxJQUFJbkIseURBQWFBLENBQUNvQixRQUFRO1FBQzdDQyxXQUFXcEIsaUJBQWlCTSxLQUFLYyxTQUFTO1FBQzFDQyxXQUFXckIsaUJBQWlCTSxLQUFLZSxTQUFTO0lBQzVDO0FBQ0Y7QUFFTyxNQUFNQyx5QkFBeUI7SUFDcEM7O0dBRUMsR0FDRCxNQUFNQyxtQkFB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WUFFQSxNQUFNc0QsYUFBYSxNQUFNMUQsMERBQU1BLENBQUNzRDtZQUNoQyxJQUFJLENBQUNJLFdBQVdYLE1BQU0sSUFBSTtnQkFDeEIsTUFBTSxJQUFJQyxNQUFNO1lBQ2xCO1lBRUEsT0FBT3JDLGtCQUFrQitDO1FBQzNCLEVBQUUsT0FBT2hCLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLCtCQUErQkE7WUFDN0MsTUFBTUE7UUFDUjtJQUNGO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvc2VydmljZXMvZmlyZWJhc2UtcHJvZHVjdC1zZXJ2aWNlLnRzPzQwYzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgY29sbGVjdGlvbixcbiAgcXVlcnksXG4gIHdoZXJlLFxuICBnZXREb2NzLFxuICBnZXREb2MsXG4gIGRvYyxcbiAgYWRkRG9jLFxuICB1cGRhdGVEb2MsXG4gIHNlcnZlclRpbWVzdGFtcCxcbiAgUXVlcnlEb2N1bWVudFNuYXBzaG90LFxuICBEb2N1bWVudERhdGEsXG59IGZyb20gJ2ZpcmViYXNlL2ZpcmVzdG9yZSc7XG5pbXBvcnQgeyBkYiB9IGZyb20gJ0AvbGliL2ZpcmViYXNlJztcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RTdGF0dXMsIENyZWF0ZVByb2R1Y3REdG8sIFVwZGF0ZVByb2R1Y3REdG8gfSBmcm9tICdAL3R5cGVzL3Byb2R1Y3QnO1xuXG4vLyBIZWxwZXIgcGFyYSBjb252ZXJ0aXIgRmlyZXN0b3JlIHRpbWVzdGFtcCBhIERhdGVcbmNvbnN0IGNvbnZlcnRUaW1lc3RhbXAgPSAodGltZXN0YW1wOiBhbnkpOiBEYXRlID0+IHtcbiAgaWYgKHRpbWVzdGFtcD8udG9EYXRlKSB7XG4gICAgcmV0dXJuIHRpbWVzdGFtcC50b0RhdGUoKTtcbiAgfVxuICBpZiAodGltZXN0YW1wIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgIHJldHVybiB0aW1lc3RhbXA7XG4gIH1cbiAgaWYgKHR5cGVvZiB0aW1lc3RhbXAgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKHRpbWVzdGFtcCk7XG4gIH1cbiAgcmV0dXJuIG5ldyBEYXRlKCk7XG59O1xuXG4vLyBIZWxwZXIgcGFyYSBjb252ZXJ0aXIgZG9jdW1lbnRvIGRlIEZpcmVzdG9yZSBhIFByb2R1Y3RcbmNvbnN0IGNvbnZlcnRQcm9kdWN0RG9jID0gKGRvY1NuYXA6IFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdDxEb2N1bWVudERhdGE+KTogUHJvZHVjdCA9PiB7XG4gIGNvbnN0IGRhdGEgPSBkb2NTbmFwLmRhdGEoKTtcbiAgcmV0dXJuIHtcbiAgICBpZDogZG9jU25hcC5pZCxcbiAgICBzaG9wSWQ6IGRhdGEuc2hvcElkIHx8ICcnLFxuICAgIG5hbWU6IGRhdGEubmFtZSB8fCAnJyxcbiAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB8fCAnJyxcbiAgICB2YWx1ZTogZGF0YS52YWx1ZSB8fCAwLFxuICAgIGhlaWdodDogZGF0YS5oZWlnaHQgfHwgMCxcbiAgICB3aWR0aDogZGF0YS53aWR0aCB8fCAwLFxuICAgIGRlcHRoOiBkYXRhLmRlcHRoIHx8IDAsXG4gICAgcmVxdWlyZXNEZXBvc2l0OiBkYXRhLnJlcXVpcmVzRGVwb3NpdCB8fCBmYWxzZSxcbiAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcbiAgICBtYWluSW1hZ2U6IGRhdGEubWFpbkltYWdlLFxuICAgIHN0YXR1czogZGF0YS5zdGF0dXMgfHwgUHJvZHVjdFN0YXR1cy5JTkFDVElWRSxcbiAgICBjcmVhdGVkQXQ6IGNvbnZlcnRUaW1lc3RhbXAoZGF0YS5jcmVhdGVkQXQpLFxuICAgIHVwZGF0ZWRBdDogY29udmVydFRpbWVzdGFtcChkYXRhLnVwZGF0ZWRBdCksXG4gIH07XG59O1xuXG5leHBvcnQgY29uc3QgZmlyZWJhc2VQcm9kdWN0U2VydmljZSA9IHtcbiAgLyoqXG4gICAqIE9idGllbmUgcHJvZHVjdG9zIHBvciB0aWVuZGEgKHBhcmEgbWFya2V0cGxhY2UpXG4gICAqL1xuICBhc3luYyBnZXRQcm9kdWN0c0J5U2hvcChzaG9wSWQ6IHN0cmluZyk6IFByb21pc2U8UHJvZHVjdFtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2R1Y3RzUmVmID0gY29sbGVjdGlvbihkYiwgJ3Byb2R1Y3RzJyk7XG4gICAgICAvLyBQcmltZXJvIGZpbHRyYW1vcywgbHVlZ28gb3JkZW5hbW9zIGVuIG1lbW9yaWEgcGFyYSBldml0YXIgcHJvYmxlbWFzIGRlIMOtbmRpY2VzXG4gICAgICBjb25zdCBxID0gcXVlcnkoXG4gICAgICAgIHByb2R1Y3RzUmVmLFxuICAgICAgICB3aGVyZSgnc2hvcElkJywgJz09Jywgc2hvcElkKSxcbiAgICAgICAgd2hlcmUoJ3N0YXR1cycsICc9PScsIFByb2R1Y3RTdGF0dXMuQUNUSVZFKSxcbiAgICAgICk7XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG4gICAgICBjb25zdCBwcm9kdWN0cyA9IHNuYXBzaG90LmRvY3MubWFwKChkb2MpID0+IGNvbnZlcnRQcm9kdWN0RG9jKGRvYykpO1xuICAgICAgLy8gT3JkZW5hciBwb3IgZmVjaGEgZGUgY3JlYWNpw7NuIGRlc2NlbmRlbnRlXG4gICAgICByZXR1cm4gcHJvZHVjdHMuc29ydCgoYSwgYikgPT4gYi5jcmVhdGVkQXQuZ2V0VGltZSgpIC0gYS5jcmVhdGVkQXQuZ2V0VGltZSgpKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdHMgYnkgc2hvcDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIE9idGllbmUgcHJvZHVjdG9zIGFjdGl2b3MgcG9yIHRpZW5kYVxuICAgKi9cbiAgYXN5bmMgZ2V0QWN0aXZlUHJvZHVjdHNCeVNob3Aoc2hvcElkOiBzdHJpbmcpOiBQcm9taXNlPFByb2R1Y3RbXT4ge1xuICAgIHJldHVybiB0aGlzLmdldFByb2R1Y3RzQnlTaG9wKHNob3BJZCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIE9idGllbmUgdW4gcHJvZHVjdG8gcG9yIElEXG4gICAqL1xuICBhc3luYyBnZXRQcm9kdWN0QnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxQcm9kdWN0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2R1Y3REb2MgPSBhd2FpdCBnZXREb2MoZG9jKGRiLCAncHJvZHVjdHMnLCBpZCkpO1xuICAgICAgaWYgKCFwcm9kdWN0RG9jLmV4aXN0cygpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUHJvZHVjdCBub3QgZm91bmQnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjb252ZXJ0UHJvZHVjdERvYyhwcm9kdWN0RG9jIGFzIFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdDxEb2N1bWVudERhdGE+KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIE9idGllbmUgdG9kb3MgbG9zIHByb2R1Y3RvcyBhY3Rpdm9zIChwYXJhIG1hcmtldHBsYWNlKVxuICAgKi9cbiAgYXN5bmMgZ2V0QWxsUHJvZHVjdHMoKTogUHJvbWlzZTxQcm9kdWN0W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZHVjdHNSZWYgPSBjb2xsZWN0aW9uKGRiLCAncHJvZHVjdHMnKTtcbiAgICAgIGNvbnN0IHEgPSBxdWVyeShwcm9kdWN0c1JlZiwgd2hlcmUoJ3N0YXR1cycsICc9PScsIFByb2R1Y3RTdGF0dXMuQUNUSVZFKSk7XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XG4gICAgICBjb25zdCBwcm9kdWN0cyA9IHNuYXBzaG90LmRvY3MubWFwKChkb2MpID0+IGNvbnZlcnRQcm9kdWN0RG9jKGRvYykpO1xuICAgICAgLy8gT3JkZW5hciBwb3IgZmVjaGEgZGUgY3JlYWNpw7NuIGRlc2NlbmRlbnRlXG4gICAgICByZXR1cm4gcHJvZHVjdHMuc29ydCgoYSwgYikgPT4gYi5jcmVhdGVkQXQuZ2V0VGltZSgpIC0gYS5jcmVhdGVkQXQuZ2V0VGltZSgpKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogQ3JlYSB1biBudWV2byBwcm9kdWN0b1xuICAgKi9cbiAgYXN5bmMgY3JlYXRlUHJvZHVjdChkYXRhOiBDcmVhdGVQcm9kdWN0RHRvKTogUHJvbWlzZTxQcm9kdWN0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2R1Y3RzUmVmID0gY29sbGVjdGlvbihkYiwgJ3Byb2R1Y3RzJyk7XG4gICAgICBjb25zdCBwcm9kdWN0RGF0YSA9IHtcbiAgICAgICAgc2hvcElkOiBkYXRhLnNob3BJZCxcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcbiAgICAgICAgdmFsdWU6IGRhdGEudmFsdWUsXG4gICAgICAgIGhlaWdodDogZGF0YS5oZWlnaHQsXG4gICAgICAgIHdpZHRoOiBkYXRhLndpZHRoLFxuICAgICAgICBkZXB0aDogZGF0YS5kZXB0aCxcbiAgICAgICAgcmVxdWlyZXNEZXBvc2l0OiBkYXRhLmhlaWdodCA+IDE1IHx8IGRhdGEud2lkdGggPiAxNSB8fCBkYXRhLmRlcHRoID4gMTUsXG4gICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8IG51bGwsXG4gICAgICAgIG1haW5JbWFnZTogZGF0YS5tYWluSW1hZ2UgfHwgbnVsbCxcbiAgICAgICAgc3RhdHVzOiBQcm9kdWN0U3RhdHVzLkFDVElWRSxcbiAgICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRvY1JlZiA9IGF3YWl0IGFkZERvYyhwcm9kdWN0c1JlZiwgcHJvZHVjdERhdGEpO1xuICAgICAgY29uc3QgcHJvZHVjdERvYyA9IGF3YWl0IGdldERvYyhkb2NSZWYpO1xuICAgICAgXG4gICAgICBpZiAoIXByb2R1Y3REb2MuZXhpc3RzKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFcnJvciBhbCBjcmVhciBlbCBwcm9kdWN0bycpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY29udmVydFByb2R1Y3REb2MocHJvZHVjdERvYyBhcyBRdWVyeURvY3VtZW50U25hcHNob3Q8RG9jdW1lbnREYXRhPik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHByb2R1Y3Q6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBBY3R1YWxpemEgdW4gcHJvZHVjdG8gZXhpc3RlbnRlXG4gICAqL1xuICBhc3luYyB1cGRhdGVQcm9kdWN0KGlkOiBzdHJpbmcsIGRhdGE6IFVwZGF0ZVByb2R1Y3REdG8pOiBQcm9taXNlPFByb2R1Y3Q+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZHVjdFJlZiA9IGRvYyhkYiwgJ3Byb2R1Y3RzJywgaWQpO1xuICAgICAgY29uc3QgdXBkYXRlRGF0YTogYW55ID0ge1xuICAgICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxuICAgICAgfTtcblxuICAgICAgaWYgKGRhdGEubmFtZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm5hbWUgPSBkYXRhLm5hbWU7XG4gICAgICBpZiAoZGF0YS5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uID0gZGF0YS5kZXNjcmlwdGlvbjtcbiAgICAgIGlmIChkYXRhLnZhbHVlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEudmFsdWUgPSBkYXRhLnZhbHVlO1xuICAgICAgaWYgKGRhdGEuaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaGVpZ2h0ID0gZGF0YS5oZWlnaHQ7XG4gICAgICBpZiAoZGF0YS53aWR0aCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLndpZHRoID0gZGF0YS53aWR0aDtcbiAgICAgIGlmIChkYXRhLmRlcHRoICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZGVwdGggPSBkYXRhLmRlcHRoO1xuICAgICAgaWYgKGRhdGEuY2F0ZWdvcnkgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5jYXRlZ29yeSA9IGRhdGEuY2F0ZWdvcnk7XG4gICAgICBpZiAoZGF0YS5tYWluSW1hZ2UgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5tYWluSW1hZ2UgPSBkYXRhLm1haW5JbWFnZTtcblxuICAgICAgLy8gUmVjYWxjdWxhciByZXF1aXJlc0RlcG9zaXQgc2kgY2FtYmlhbiBsYXMgZGltZW5zaW9uZXNcbiAgICAgIGlmIChkYXRhLmhlaWdodCAhPT0gdW5kZWZpbmVkIHx8IGRhdGEud2lkdGggIT09IHVuZGVmaW5lZCB8fCBkYXRhLmRlcHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3QgcHJvZHVjdERvYyA9IGF3YWl0IGdldERvYyhwcm9kdWN0UmVmKTtcbiAgICAgICAgaWYgKHByb2R1Y3REb2MuZXhpc3RzKCkpIHtcbiAgICAgICAgICBjb25zdCBjdXJyZW50RGF0YSA9IHByb2R1Y3REb2MuZGF0YSgpO1xuICAgICAgICAgIGNvbnN0IGhlaWdodCA9IGRhdGEuaGVpZ2h0ICE9PSB1bmRlZmluZWQgPyBkYXRhLmhlaWdodCA6IGN1cnJlbnREYXRhLmhlaWdodDtcbiAgICAgICAgICBjb25zdCB3aWR0aCA9IGRhdGEud2lkdGggIT09IHVuZGVmaW5lZCA/IGRhdGEud2lkdGggOiBjdXJyZW50RGF0YS53aWR0aDtcbiAgICAgICAgICBjb25zdCBkZXB0aCA9IGRhdGEuZGVwdGggIT09IHVuZGVmaW5lZCA/IGRhdGEuZGVwdGggOiBjdXJyZW50RGF0YS5kZXB0aDtcbiAgICAgICAgICB1cGRhdGVEYXRhLnJlcXVpcmVzRGVwb3NpdCA9IGhlaWdodCA+IDE1IHx8IHdpZHRoID4gMTUgfHwgZGVwdGggPiAxNTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBhd2FpdCB1cGRhdGVEb2MocHJvZHVjdFJlZiwgdXBkYXRlRGF0YSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZWREb2MgPSBhd2FpdCBnZXREb2MocHJvZHVjdFJlZik7XG4gICAgICBpZiAoIXVwZGF0ZWREb2MuZXhpc3RzKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQcm9kdWN0byBubyBlbmNvbnRyYWRvJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb252ZXJ0UHJvZHVjdERvYyh1cGRhdGVkRG9jIGFzIFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdDxEb2N1bWVudERhdGE+KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIERlc2FjdGl2YSB1biBwcm9kdWN0b1xuICAgKi9cbiAgYXN5bmMgZGVhY3RpdmF0ZVByb2R1Y3QoaWQ6IHN0cmluZyk6IFByb21pc2U8UHJvZHVjdD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcm9kdWN0UmVmID0gZG9jKGRiLCAncHJvZHVjdHMnLCBpZCk7XG4gICAgICBhd2FpdCB1cGRhdGVEb2MocHJvZHVjdFJlZiwge1xuICAgICAgICBzdGF0dXM6IFByb2R1Y3RTdGF0dXMuSU5BQ1RJVkUsXG4gICAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKCksXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdXBkYXRlZERvYyA9IGF3YWl0IGdldERvYyhwcm9kdWN0UmVmKTtcbiAgICAgIGlmICghdXBkYXRlZERvYy5leGlzdHMoKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Byb2R1Y3RvIG5vIGVuY29udHJhZG8nKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNvbnZlcnRQcm9kdWN0RG9jKHVwZGF0ZWREb2MgYXMgUXVlcnlEb2N1bWVudFNuYXBzaG90PERvY3VtZW50RGF0YT4pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWFjdGl2YXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sXG59O1xuXG4iXSwibmFtZXMiOlsiY29sbGVjdGlvbiIsInF1ZXJ5Iiwid2hlcmUiLCJnZXREb2NzIiwiZ2V0RG9jIiwiZG9jIiwiYWRkRG9jIiwidXBkYXRlRG9jIiwic2VydmVyVGltZXN0YW1wIiwiZGIiLCJQcm9kdWN0U3RhdHVzIiwiY29udmVydFRpbWVzdGFtcCIsInRpbWVzdGFtcCIsInRvRGF0ZSIsIkRhdGUiLCJjb252ZXJ0UHJvZHVjdERvYyIsImRvY1NuYXAiLCJkYXRhIiwiaWQiLCJzaG9wSWQiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJ2YWx1ZSIsImhlaWdodCIsIndpZHRoIiwiZGVwdGgiLCJyZXF1aXJlc0RlcG9zaXQiLCJjYXRlZ29yeSIsIm1haW5JbWFnZSIsInN0YXR1cyIsIklOQUNUSVZFIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwiZmlyZWJhc2VQcm9kdWN0U2VydmljZSIsImdldFByb2R1Y3RzQnlTaG9wIiwicHJvZHVjdHNSZWYiLCJxIiwiQUNUSVZFIiwic25hcHNob3QiLCJwcm9kdWN0cyIsImRvY3MiLCJtYXAiLCJzb3J0IiwiYSIsImIiLCJnZXRUaW1lIiwiZXJyb3IiLCJjb25zb2xlIiwiZ2V0QWN0aXZlUHJvZHVjdHNCeVNob3AiLCJnZXRQcm9kdWN0QnlJZCIsInByb2R1Y3REb2MiLCJleGlzdHMiLCJFcnJvciIsImdldEFsbFByb2R1Y3RzIiwiY3JlYXRlUHJvZHVjdCIsInByb2R1Y3REYXRhIiwiZG9jUmVmIiwidXBkYXRlUHJvZHVjdCIsInByb2R1Y3RSZWYiLCJ1cGRhdGVEYXRhIiwidW5kZWZpbmVkIiwiY3VycmVudERhdGEiLCJ1cGRhdGVkRG9jIiwiZGVhY3RpdmF0ZVByb2R1Y3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/services/firebase-product-service.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/services/product-service.ts":
/*!*****************************************!*\
  !*** ./src/services/product-service.ts ***!
  \*****************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   productService: function() { return /* binding */ productService; }\n/* harmony export */ });\n/* harmony import */ var _firebase_product_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./firebase-product-service */ \"(app-pages-browser)/./src/services/firebase-product-service.ts\");\n\nconst productService = {\n    // Operaciones de lectura del marketplace usan Firebase\n    async getProductsByShop (shopId) {\n        return _firebase_product_service__WEBPACK_IMPORTED_MODULE_0__.firebaseProductService.getProductsByShop(shopId);\n    },\n    async getActiveProductsByShop (shopId) {\n        return _firebase_product_service__WEBPACK_IMPORTED_MODULE_0__.firebaseProductService.getActiveProductsByShop(shopId);\n    },\n    async getProductById (id) {\n        return _firebase_product_service__WEBPACK_IMPORTED_MODULE_0__.firebaseProductService.getProductById(id);\n    },\n    async getAllProducts () {\n        return _firebase_product_service__WEBPACK_IMPORTED_MODULE_0__.firebaseProductService.getAllProducts();\n    },\n    // Operaciones de escritura usan Firebase\n    async createProduct (data) {\n        return _firebase_product_service__WEBPACK_IMPORTED_MODULE_0__.firebaseProductService.createProduct(data);\n    },\n    async updateProduct (id, data) {\n        return _firebase_product_service__WEBPACK_IMPORTED_MODULE_0__.firebaseProductService.updateProduct(id, data);\n    },\n    async deactivateProduct (id) {\n        return _firebase_product_service__WEBPACK_IMPORTED_MODULE_0__.firebaseProductService.deactivateProduct(id);\n    }\n};\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9zZXJ2aWNlcy9wcm9kdWN0LXNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBb0U7QUFHN0QsTUFBTUMsaUJBQWlCO0lBQzVCLHVEQUF1RDtJQUN2RCxNQUFNQyxtQkFBa0JDLE1BQWM7UUFDcEMsT0FBT0gsNkVBQXNCQSxDQUFDRSxpQkFBaUIsQ0FBQ0M7SUFDbEQ7SUFFQSxNQUFNQyx5QkFBd0JELE1BQWM7UUFDMUMsT0FBT0gsNkVBQXNCQSxDQUFDSSx1QkFBdUIsQ0FBQ0Q7SUFDeEQ7SUFFQSxNQUFNRSxnQkFBZUMsRUFBVTtRQUM3QixPQUFPTiw2RUFBc0JBLENBQUNLLGNBQWMsQ0FBQ0M7SUFDL0M7SUFFQSxNQUFNQztRQUNKLE9BQU9QLDZFQUFzQkEsQ0FBQ08sY0FBYztJQUM5QztJQUVBLHlDQUF5QztJQUN6QyxNQUFNQyxlQUFjQyxJQUFzQjtRQUN4QyxPQUFPVCw2RUFBc0JBLENBQUNRLGFBQWEsQ0FBQ0M7SUFDOUM7SUFFQSxNQUFNQyxlQUFjSixFQUFVLEVBQUVHLElBQXNCO1FBQ3BELE9BQU9ULDZFQUFzQkEsQ0FBQ1UsYUFBYSxDQUFDSixJQUFJRztJQUNsRDtJQUVBLE1BQU1FLG1CQUFrQkwsRUFBVTtRQUNoQyxPQUFPTiw2RUFBc0JBLENBQUNXLGlCQUFpQixDQUFDTDtJQUNsRDtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL3NlcnZpY2VzL3Byb2R1Y3Qtc2VydmljZS50cz83Yzg1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGZpcmViYXNlUHJvZHVjdFNlcnZpY2UgfSBmcm9tICcuL2ZpcmViYXNlLXByb2R1Y3Qtc2VydmljZSc7XG5pbXBvcnQgeyBQcm9kdWN0LCBDcmVhdGVQcm9kdWN0RHRvLCBVcGRhdGVQcm9kdWN0RHRvIH0gZnJvbSAnQC90eXBlcy9wcm9kdWN0JztcblxuZXhwb3J0IGNvbnN0IHByb2R1Y3RTZXJ2aWNlID0ge1xuICAvLyBPcGVyYWNpb25lcyBkZSBsZWN0dXJhIGRlbCBtYXJrZXRwbGFjZSB1c2FuIEZpcmViYXNlXG4gIGFzeW5jIGdldFByb2R1Y3RzQnlTaG9wKHNob3BJZDogc3RyaW5nKTogUHJvbWlzZTxQcm9kdWN0W10+IHtcbiAgICByZXR1cm4gZmlyZWJhc2VQcm9kdWN0U2VydmljZS5nZXRQcm9kdWN0c0J5U2hvcChzaG9wSWQpO1xuICB9LFxuXG4gIGFzeW5jIGdldEFjdGl2ZVByb2R1Y3RzQnlTaG9wKHNob3BJZDogc3RyaW5nKTogUHJvbWlzZTxQcm9kdWN0W10+IHtcbiAgICByZXR1cm4gZmlyZWJhc2VQcm9kdWN0U2VydmljZS5nZXRBY3RpdmVQcm9kdWN0c0J5U2hvcChzaG9wSWQpO1xuICB9LFxuXG4gIGFzeW5jIGdldFByb2R1Y3RCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFByb2R1Y3Q+IHtcbiAgICByZXR1cm4gZmlyZWJhc2VQcm9kdWN0U2VydmljZS5nZXRQcm9kdWN0QnlJZChpZCk7XG4gIH0sXG5cbiAgYXN5bmMgZ2V0QWxsUHJvZHVjdHMoKTogUHJvbWlzZTxQcm9kdWN0W10+IHtcbiAgICByZXR1cm4gZmlyZWJhc2VQcm9kdWN0U2VydmljZS5nZXRBbGxQcm9kdWN0cygpO1xuICB9LFxuXG4gIC8vIE9wZXJhY2lvbmVzIGRlIGVzY3JpdHVyYSB1c2FuIEZpcmViYXNlXG4gIGFzeW5jIGNyZWF0ZVByb2R1Y3QoZGF0YTogQ3JlYXRlUHJvZHVjdER0byk6IFByb21pc2U8UHJvZHVjdD4ge1xuICAgIHJldHVybiBmaXJlYmFzZVByb2R1Y3RTZXJ2aWNlLmNyZWF0ZVByb2R1Y3QoZGF0YSk7XG4gIH0sXG5cbiAgYXN5bmMgdXBkYXRlUHJvZHVjdChpZDogc3RyaW5nLCBkYXRhOiBVcGRhdGVQcm9kdWN0RHRvKTogUHJvbWlzZTxQcm9kdWN0PiB7XG4gICAgcmV0dXJuIGZpcmViYXNlUHJvZHVjdFNlcnZpY2UudXBkYXRlUHJvZHVjdChpZCwgZGF0YSk7XG4gIH0sXG5cbiAgYXN5bmMgZGVhY3RpdmF0ZVByb2R1Y3QoaWQ6IHN0cmluZyk6IFByb21pc2U8UHJvZHVjdD4ge1xuICAgIHJldHVybiBmaXJlYmFzZVByb2R1Y3RTZXJ2aWNlLmRlYWN0aXZhdGVQcm9kdWN0KGlkKTtcbiAgfSxcbn07Il0sIm5hbWVzIjpbImZpcmViYXNlUHJvZHVjdFNlcnZpY2UiLCJwcm9kdWN0U2VydmljZSIsImdldFByb2R1Y3RzQnlTaG9wIiwic2hvcElkIiwiZ2V0QWN0aXZlUHJvZHVjdHNCeVNob3AiLCJnZXRQcm9kdWN0QnlJZCIsImlkIiwiZ2V0QWxsUHJvZHVjdHMiLCJjcmVhdGVQcm9kdWN0IiwiZGF0YSIsInVwZGF0ZVByb2R1Y3QiLCJkZWFjdGl2YXRlUHJvZHVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/services/product-service.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/types/product.ts":
/*!******************************!*\
  !*** ./src/types/product.ts ***!
  \******************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ProductStatus: function() { return /* binding */ ProductStatus; }\n/* harmony export */ });\nvar ProductStatus;\n(function(ProductStatus) {\n    ProductStatus[\"ACTIVE\"] = \"active\";\n    ProductStatus[\"INACTIVE\"] = \"inactive\";\n    ProductStatus[\"ARCHIVED\"] = \"archived\";\n})(ProductStatus || (ProductStatus = {}));\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy90eXBlcy9wcm9kdWN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7O1VBQVlBOzs7O0dBQUFBLGtCQUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvdHlwZXMvcHJvZHVjdC50cz9jOTFmIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBlbnVtIFByb2R1Y3RTdGF0dXMge1xuICBBQ1RJVkUgPSAnYWN0aXZlJyxcbiAgSU5BQ1RJVkUgPSAnaW5hY3RpdmUnLFxuICBBUkNISVZFRCA9ICdhcmNoaXZlZCcsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvZHVjdCB7XG4gIGlkOiBzdHJpbmc7XG4gIHNob3BJZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHZhbHVlOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xuICB3aWR0aDogbnVtYmVyO1xuICBkZXB0aDogbnVtYmVyO1xuICByZXF1aXJlc0RlcG9zaXQ6IGJvb2xlYW47XG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xuICBtYWluSW1hZ2U/OiBzdHJpbmc7XG4gIHN0YXR1czogUHJvZHVjdFN0YXR1cztcbiAgaGFzRGVsaXZlcnk/OiBib29sZWFuO1xuICBkZWxpdmVyeVpvbmVzPzogc3RyaW5nO1xuICBwaWNrdXBJblN0b3JlPzogYm9vbGVhbjtcbiAgY3JlYXRlZEF0OiBEYXRlO1xuICB1cGRhdGVkQXQ6IERhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlUHJvZHVjdER0byB7XG4gIHNob3BJZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHZhbHVlOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xuICB3aWR0aDogbnVtYmVyO1xuICBkZXB0aDogbnVtYmVyO1xuICBjYXRlZ29yeT86IHN0cmluZztcbiAgbWFpbkltYWdlPzogc3RyaW5nO1xuICBoYXNEZWxpdmVyeT86IGJvb2xlYW47XG4gIGRlbGl2ZXJ5Wm9uZXM/OiBzdHJpbmc7XG4gIHBpY2t1cEluU3RvcmU/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwZGF0ZVByb2R1Y3REdG8ge1xuICBuYW1lPzogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgdmFsdWU/OiBudW1iZXI7XG4gIGhlaWdodD86IG51bWJlcjtcbiAgd2lkdGg/OiBudW1iZXI7XG4gIGRlcHRoPzogbnVtYmVyO1xuICBjYXRlZ29yeT86IHN0cmluZztcbiAgbWFpbkltYWdlPzogc3RyaW5nO1xuICBoYXNEZWxpdmVyeT86IGJvb2xlYW47XG4gIGRlbGl2ZXJ5Wm9uZXM/OiBzdHJpbmc7XG4gIHBpY2t1cEluU3RvcmU/OiBib29sZWFuO1xufSJdLCJuYW1lcyI6WyJQcm9kdWN0U3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/types/product.ts\n"));

/***/ })

}]);